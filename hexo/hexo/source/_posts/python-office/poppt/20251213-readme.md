---
title: ğŸ“š poppt é¡¹ç›®å…¨é¢è§£æ
date: 2025-12-12 22:25:14
tags: python-office
---




<p align="center" id='æ‰«ç æŸ¥çœ‹AIç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/BXWg_LXreNCI-UlrckZrTw'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>





<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/BXWg_LXreNCI-UlrckZrTw">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AIç¼–ç¨‹-red" alt="AIç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AIäº¤æµç¾¤-brightgreen" alt="AIäº¤æµç¾¤">
</a>

</p>



<!-- more -->


å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæ­£åœ¨all in [AIç¼–ç¨‹å®æˆ˜](https://mp.weixin.qq.com/s/BXWg_LXreNCI-UlrckZrTw)ã€‚

å¥½çš„,æˆ‘æ¥å¸®ä½ æ·±å…¥å­¦ä¹ è¿™ä¸ª poppt é¡¹ç›®!è®©æˆ‘ç³»ç»Ÿåœ°åˆ†æé¡¹ç›®çš„ç»“æ„ã€åŠŸèƒ½å’Œå®ç°ç»†èŠ‚ã€‚
å®Œç¾!æˆ‘å·²ç»ç³»ç»Ÿåœ°å­¦ä¹ äº†è¿™ä¸ª poppt é¡¹ç›®ã€‚è®©æˆ‘ä¸ºä½ æ€»ç»“ä¸€ä¸‹é¡¹ç›®çš„æ ¸å¿ƒçŸ¥è¯†:



### ğŸ¯ é¡¹ç›®æ¦‚è¿°
**poppt** æ˜¯ä¸€ä¸ªåŸºäº Python çš„ PPT åŠå…¬è‡ªåŠ¨åŒ–å·¥å…·åº“ï¼Œæä¾› PPT è½¬ PDFã€PPT è½¬å›¾ç‰‡ã€åˆå¹¶ PPT ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

---

### ğŸ“ é¡¹ç›®ç»“æ„

```
poppt/
â”œâ”€â”€ poppt/                      # æ ¸å¿ƒåŒ…
â”‚   â”œâ”€â”€ __init__.py            # åŒ…å…¥å£ï¼Œå¯¼å‡ºæ‰€æœ‰API
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ ppt.py             # APIæ¥å£å±‚ï¼ˆç”¨æˆ·è°ƒç”¨çš„å‡½æ•°ï¼‰
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ PPTType.py         # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ç±» MainPPT
â”‚   â”‚   â””â”€â”€ need_dev/          # å¾…å¼€å‘åŠŸèƒ½
â”‚   â””â”€â”€ lib/ppt/
â”‚       â””â”€â”€ ppt2pdf_service.py # PPTè½¬PDFåº•å±‚æœåŠ¡
â”œâ”€â”€ demo/                       # ç¤ºä¾‹ä»£ç 
â”œâ”€â”€ tests/                      # å•å…ƒæµ‹è¯•
â”œâ”€â”€ setup.py                    # æ‰“åŒ…é…ç½®ï¼ˆè°ƒç”¨setup.cfgï¼‰
â”œâ”€â”€ setup.cfg                   # åŒ…å…ƒä¿¡æ¯é…ç½®
â””â”€â”€ requirements.txt            # ä¾èµ–åˆ—è¡¨
```

---

### ğŸ”§ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | è¯´æ˜ |
|------|------|------|
| **pywin32** | Windows COMæ“ä½œ | è°ƒç”¨PowerPointåº”ç”¨ç¨‹åº |
| **Pillow** | å›¾åƒå¤„ç† | ç”Ÿæˆé•¿å›¾ã€æ‹¼æ¥å›¾ç‰‡ |
| **poprogress** | è¿›åº¦æ¡æ˜¾ç¤º | æ‰¹é‡å¤„ç†æ—¶æ˜¾ç¤ºè¿›åº¦ |
| **pofile** | æ–‡ä»¶æ“ä½œ | æ–‡ä»¶è·¯å¾„å¤„ç†ã€ç›®å½•åˆ›å»º |

**è¿è¡Œç¯å¢ƒ**: 
- Python >= 3.7
- Windows ç³»ç»Ÿï¼ˆå¿…é¡»å®‰è£… Microsoft PowerPointï¼‰

---

### ğŸš€ ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½

#### 1ï¸âƒ£ **ppt2pdf** - PPTè½¬PDF
```python
from poppt.api.ppt import ppt2pdf

# æ‰¹é‡è½¬æ¢æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰PPT
ppt2pdf(path=r'./pptæ–‡ä»¶å¤¹', output_path=r'./pdfè¾“å‡º')
```

**å®ç°åŸç†**:
- ä½¿ç”¨ `win32com.client` è°ƒç”¨ PowerPoint COM ç»„ä»¶
- é€šè¿‡ `ppt.SaveAs(output_filename, 32)` å¯¼å‡ºPDFï¼ˆ32æ˜¯PDFæ ¼å¼ä»£ç ï¼‰
- æ”¯æŒå•æ–‡ä»¶å’Œæ‰¹é‡è½¬æ¢

#### 2ï¸âƒ£ **ppt2img** - PPTè½¬å›¾ç‰‡
```python
from poppt.api.ppt import ppt2img

# è½¬ä¸ºç‹¬ç«‹å›¾ç‰‡
ppt2img(input_path=r'./test.pptx', output_path=r'./imgs', merge=False)

# è½¬ä¸ºé•¿å›¾ï¼ˆåˆå¹¶æ‰€æœ‰å¹»ç¯ç‰‡ï¼‰
ppt2img(input_path=r'./test.pptx', output_path=r'./imgs', merge=True)
```

**å®ç°åŸç†**:
- ä½¿ç”¨ `ppt.SaveAs(output_dir, 17)` å¯¼å‡ºJPGï¼ˆ17æ˜¯JPGæ ¼å¼ä»£ç ï¼‰
- å¦‚æœ `merge=True`ï¼Œä½¿ç”¨ Pillow å°†æ‰€æœ‰å›¾ç‰‡çºµå‘æ‹¼æ¥æˆé•¿å›¾
- è‡ªåŠ¨æŒ‰æ–‡ä»¶ååˆ›å»ºå­ç›®å½•å­˜æ”¾å›¾ç‰‡

#### 3ï¸âƒ£ **merge4ppt** - åˆå¹¶PPT
```python
from poppt.api.ppt import merge4ppt

# åˆå¹¶æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰PPT
merge4ppt(input_path=r'./pptæ–‡ä»¶å¤¹', 
          output_path=r'./è¾“å‡º', 
          output_name='åˆå¹¶ç»“æœ.pptx')
```

**å®ç°åŸç†**:
- åˆ›å»ºæ–°çš„ç©ºç™½PPT: `new_ppt = Application.Presentations.Add()`
- éå†æ‰€æœ‰PPTï¼Œä½¿ç”¨ `InsertFromFile` æ–¹æ³•å°†å¹»ç¯ç‰‡æ’å…¥åˆ°æ–°PPTæœ«å°¾
- ä¿å­˜åˆå¹¶åçš„æ–‡ä»¶

---

### ğŸ—ï¸ æ ¸å¿ƒç±»è®¾è®¡

#### **MainPPT ç±»** (poppt/core/PPTType.py)

```python
class MainPPT():
    def __init__(self):
        self.app = 'PowerPoint.Application'  # PowerPoint COMç»„ä»¶å
        self.suffix_list = ["ppt", "pptx"]    # æ”¯æŒçš„æ–‡ä»¶ç±»å‹
        self.ppt2img_type = 17                # JPGæ ¼å¼ä»£ç 
    
    def ppt2pdf(self, path, output_path)       # PPTè½¬PDF
    def ppt2img(self, input_path, output_path, merge=False)  # PPTè½¬å›¾ç‰‡
    def merge4ppt(self, input_path, output_path, output_name) # åˆå¹¶PPT
    def generate_long_image(self, ...)         # ç”Ÿæˆé•¿å›¾ï¼ˆå†…éƒ¨æ–¹æ³•ï¼‰
```

---

### ğŸ“¦ æ¶æ„è®¾è®¡æ¨¡å¼

**ä¸‰å±‚æ¶æ„**:
1. **APIå±‚** (`poppt/api/ppt.py`): å¯¹å¤–æš´éœ²çš„ç®€æ´æ¥å£
2. **ä¸šåŠ¡å±‚** (`poppt/core/PPTType.py`): æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
3. **æœåŠ¡å±‚** (`poppt/lib/ppt/`): åº•å±‚æ“ä½œæœåŠ¡

**ä¼˜ç‚¹**:
- âœ… èŒè´£åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤
- âœ… ç”¨æˆ·åªéœ€å…³æ³¨APIå±‚
- âœ… åº•å±‚å®ç°å¯ç‹¬ç«‹ä¼˜åŒ–

---

### ğŸ”‘ å…³é”®æŠ€æœ¯ç‚¹

#### 1. **Windows COMè‡ªåŠ¨åŒ–**
```python
# åˆ›å»ºPowerPointåº”ç”¨ç¨‹åºå®ä¾‹
ppt_app = win32com.client.Dispatch('PowerPoint.Application')
ppt_app.Visible = True  # æ˜¯å¦æ˜¾ç¤ºç•Œé¢

# æ‰“å¼€PPT
ppt = ppt_app.Presentations.Open(filename, WithWindow=False)

# å¦å­˜ä¸ºä¸åŒæ ¼å¼
ppt.SaveAs(output_path, format_code)  
# 17=JPG, 18=PNG, 32=PDF
```

#### 2. **å›¾ç‰‡æ‹¼æ¥ç®—æ³•**
```python
# åˆ›å»ºç©ºç™½ç”»å¸ƒï¼ˆnå€é«˜åº¦ï¼‰
long_canvas = Image.new(img_mode, (width, height * len(img_list)))

# é€ä¸ªç²˜è´´å›¾ç‰‡
for i, image in enumerate(img_list):
    long_canvas.paste(Image.open(image), box=(0, i * height))
```

#### 3. **è·¯å¾„å¤„ç†** (ä½¿ç”¨ pathlib)
```python
from pathlib import Path

# ç›¸å¯¹è·¯å¾„è½¬ç»å¯¹è·¯å¾„
abs_path = Path(input_path).absolute()

# è·å–ä¸å¸¦åç¼€çš„æ–‡ä»¶å
stem = Path(filename).stem

# è·¯å¾„æ‹¼æ¥
output = Path(output_path) / new_name
```

---

### ğŸ“ ä»£ç è§„èŒƒè¦ç‚¹

1. **æ³¨é‡Šè§„èŒƒ**: æ¯ä¸ªå‡½æ•°éƒ½æœ‰è¯¦ç»†çš„ Google é£æ ¼æ–‡æ¡£æ³¨é‡Š
2. **å·¥å…·å‡½æ•°**: ä½¿ç”¨ `pofile` åº“çš„å·¥å…·å‡½æ•°ç®€åŒ–ä»£ç 
   - `get_files()`: è·å–æ–‡ä»¶åˆ—è¡¨
   - `mkdir()`: åˆ›å»ºç›®å½•
   - `check_suffix()`: æ£€æŸ¥æ–‡ä»¶åç¼€
3. **è¿›åº¦æ˜¾ç¤º**: æ‰¹é‡æ“ä½œä½¿ç”¨ `simple_progress()` æ˜¾ç¤ºè¿›åº¦æ¡

---

### ğŸ§ª æµ‹è¯•ç”¨ä¾‹è®¾è®¡

```python
class TestPPT(unittest.TestCase):
    def test_ppt2pdf(self):         # æµ‹è¯•PDFè½¬æ¢
    def test_single_ppt2img(self):  # æµ‹è¯•å•æ–‡ä»¶è½¬å›¾ç‰‡
    def test_mergeppt_list(self):   # æµ‹è¯•åˆå¹¶(åˆ—è¡¨è¾“å…¥)
    def test_mergeppt_str(self):    # æµ‹è¯•åˆå¹¶(å­—ç¬¦ä¸²è¾“å…¥)
```

---

### ğŸ’¡ å­¦ä¹ è¦ç‚¹æ€»ç»“

1. **COMè‡ªåŠ¨åŒ–**: å­¦ä¹ å¦‚ä½•é€šè¿‡Pythonæ“ä½œWindowsåº”ç”¨ç¨‹åº
2. **å›¾åƒå¤„ç†**: æŒæ¡Pillowåº“è¿›è¡Œå›¾ç‰‡æ‹¼æ¥
3. **æ–‡ä»¶æ“ä½œ**: ä½¿ç”¨pathlibè¿›è¡Œç°ä»£åŒ–è·¯å¾„å¤„ç†
4. **æ‰“åŒ…å‘å¸ƒ**: ç†è§£setup.py/setup.cfgé…ç½®å’ŒPyPIå‘å¸ƒæµç¨‹
5. **ä»£ç ç»„ç»‡**: å­¦ä¹ ä¸‰å±‚æ¶æ„åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨

---

### ğŸ“Œ æ³¨æ„äº‹é¡¹

âš ï¸ **ä¾èµ–PowerPoint**: å¿…é¡»åœ¨Windowsç³»ç»Ÿä¸Šå®‰è£…Microsoft PowerPoint
âš ï¸ **COMç»„ä»¶**: ä½¿ç”¨ `pywin32` è°ƒç”¨COMç»„ä»¶ï¼Œä»…æ”¯æŒWindows
âš ï¸ **è·¯å¾„é—®é¢˜**: æŸäº›æ“ä½œéœ€è¦ç»å¯¹è·¯å¾„ï¼Œä½¿ç”¨ `Path().absolute()` è½¬æ¢

---

è¿™ä¸ªé¡¹ç›®è™½ç„¶ä»£ç é‡ä¸å¤§ï¼Œä½†éº»é›€è™½å°äº”è„ä¿±å…¨ï¼Œéå¸¸é€‚åˆå­¦ä¹ PythonåŠå…¬è‡ªåŠ¨åŒ–å’Œé¡¹ç›®å·¥ç¨‹åŒ–å®è·µï¼ğŸ‰


ç¨‹åºå‘˜æ™šæ«ä¸“æ³¨AIç¼–ç¨‹åŸ¹è®­ï¼Œå°ç™½çœ‹å®Œä»–çš„æ•™ç¨‹[ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](https://mp.weixin.qq.com/s/BXWg_LXreNCI-UlrckZrTw)å°±èƒ½ä¸Šæ‰‹åšAIé¡¹ç›®ã€‚