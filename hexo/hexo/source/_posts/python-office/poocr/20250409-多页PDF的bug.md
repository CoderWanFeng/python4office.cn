---
title: ç†¬å¤œä¸Šçº¿ï¼poocråº“ç«é€Ÿä¿®å¤PDFå‘ç¥¨è¯†åˆ«è‡´å‘½BUG
date: 2025-04-09 21:00:05
tags: [poocr,è‡ªåŠ¨åŒ–åŠå…¬,è¯¾ç¨‹,å¼€æºé¡¹ç›®]
---


<p align="center" id='è¿›ç¾¤-banner-AI'>
    <a target="_blank" href='http://www.python4office.cn/wechat-group/'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/87fc1ca4-1a6c-47b8-b234-3e323a1aa827/aiq.jpg" width="100%"/>
    </a>   
</p>

## ä¸€ã€poocråº“ï¼šä½ çš„å‘ç¥¨è¯†åˆ«ç‘å£«å†›åˆ€

ä¸Šå‘¨åˆšç»™poocråº“è£…ä¸Š"å¤šé¡µPDFè¯†åˆ«åŠŸèƒ½"ï¼Œä»¥ä¸ºè‡ªå·±åœ¨å‘ç¥¨è¯†åˆ«é¢†åŸŸå°ç¥äº†ã€‚

poocrè¿™è´§æœ¬è´¨ä¸Šæ˜¯ä¸ªOCRç‘å£«å†›åˆ€ï¼Œèƒ½å¯¹æ¥è…¾è®¯äº‘ã€ç™¾åº¦ã€é˜¿é‡Œç­‰å¤§å‚çš„OCRæ¥å£ï¼ŒæŠŠå„ç§å‘ç¥¨ã€æ–‡æ¡£è¯†åˆ«å¾—æ˜æ˜ç™½ç™½ã€‚å®‰è£…å‘½ä»¤ç®€å•ç²—æš´ï¼š

```bash
pip install poocr
```

ç”¨æ³•æ›´æ˜¯å‚»ç“œå¼ï¼š
```python
# ä¸€è¡Œä»£ç ï¼Œå®ç°å‘ç¥¨çš„æ‰¹é‡è¯†åˆ«
poocr.ocr2excel.VatInvoiceOCR2Excel(
    intput_path=r'C:\Users\Lenovo\Desktop\temp\å¢å€¼ç¨å‘ç¥¨-test.pdf',
    output_excel='./æ™šæ«.xlsx',
    configPath='./poocr-config.toml'
)
```

é¡¹ç›®å¼€æºåœ°å€åœ¨è¿™ï¼Œæ¬¢è¿æ¥è–…ç¾Šæ¯›ï¼š[https://github.com/CoderWanFeng/poocr](https://github.com/CoderWanFeng/poocr)

ç»“æœï¼Œæ˜¨æ™š11ç‚¹47åˆ†ï¼Œç”¨æˆ·@agoneçš„æŠ¥é”™æ¶ˆæ¯åƒä¸€æ¡¶å†°æ°´æµ‡ç­äº†æ‰€æœ‰ç¾æ¢¦ã€‚

é‚£æ„Ÿè§‰å°±åƒåˆšç»™æœåŠ¡å™¨å–‚äº†ä»½"ç¨³å®šè¿è¡Œ"çš„ä¿è¯ä¹¦ï¼Œè½¬å¤´å®ƒå°±ç»™ä½ è¡¨æ¼”ç«å±±å–·å‘ã€‚

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/50cb656ee1424e9c8a912e1d06a6d810~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5pma5p6r:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMjMyNzAwMjc3OTc1ODc2MCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1744302854&x-orig-sign=DXs%2Bilem0oFUYmcE5tZOM7Zdz%2FU%3D)

## äºŒã€ç¬¬ä¸€é¢—é›·ï¼šBase64ç¼–ç çš„"ç±»å‹å¹»è§‰"

æ–°ä¸Šçš„PDFè¯†åˆ«åŠŸèƒ½æœ¬è¯¥æ˜¯é™ç»´æ‰“å‡»â€”â€”pymupdfåˆ‡é¡µï¼Œopencvæ ¡æ­£ï¼Œpandasç»“æ„åŒ–è¾“å‡ºï¼Œä¸‰å±‚é˜²æŠ¤åƒç»™æ•°æ®ç©¿äº†é˜²å¼¹è¡£ã€‚ç›´åˆ°@agoneå‘æ¥çš„æ—¥å¿—æ˜¾ç¤ºï¼š`pdf.convert_to_pdf()`è¿™è¡Œä»£ç æ­£åœ¨ç–¯ç‹‚æŠ›å‡º`TypeError`ã€‚

**çŠ¯ç½ªç°åœº**ï¼š
```python
# åŸç½ªä»£ç 
pdf_bytes = pdf.convert_to_pdf(page_num, page_num + 1)
base64_encoded_pdf = base64.b64encode(pdf_bytes).decode('utf-8')
```

pymupdfçš„å¯¹è±¡å±…ç„¶ä¸èƒ½ç›´æ¥å–‚ç»™base64ç¼–ç å™¨ï¼å°±åƒè¯•å›¾æŠŠ3Dæ¨¡å‹å¡è¿›äºŒç»´æ‰“å°æœºï¼Œé”™è¯¯ä»£ç åœ¨æ·±å¤œçš„æœåŠ¡å™¨æ—¥å¿—é‡Œè·³èµ·äº†è¿ªæ–¯ç§‘ã€‚ä¿®å¤æ–¹æ¡ˆæ˜¯ç”¨fitzçš„`select()`æ–¹æ³•é‡æ–°åŒ…è£…PDFï¼Œç›¸å½“äºç»™æ•°æ®åŠ äº†ä¸ª"æ¬¡å…ƒè½¬æ¢å™¨"ï¼š

```python
import fitz  # pymupdfçš„åˆ«å
temp_pdf = fitz.open()
temp_pdf.select([page_num])  # åªé€‰ä¸­éœ€è¦çš„é¡µé¢
base64_encoded_pdf = base64.b64encode(temp_pdf.write()).decode('utf-8')
```

ä¿®å¤åï¼ŒPDFç»ˆäºåƒé©¯æœçš„å°é¾™ï¼Œè€è€å®å®å˜æˆäº†Base64å­—ç¬¦ä¸²ã€‚

## ä¸‰ã€ç¬¬äºŒé¢—é›·ï¼šæµ…æ‹·è´çš„"æ•°æ®å…‹éš†æœ¯"

æ›´ç¦»è°±çš„æ˜¯ç¬¬äºŒé¢—é›·â€”â€”åˆ—è¡¨è¿½åŠ æ“ä½œç‚¸å‡ºäº†æ•°æ®é‡å¤çš„æ ¸å¼¹å‘ã€‚ç”¨æˆ·å‘æ¥çš„æˆªå›¾æ˜¾ç¤ºï¼šåŒä¸€é¡µå‘ç¥¨æ•°æ®åœ¨ç»“æœé‡Œå‡ºç°äº†ä¸‰æ¬¡ï¼Œåƒè¢«å¡å¸¦å¤è¯»çš„é¬¼é­‚ã€‚

**çŠ¯ç½ªç°åœº**ï¼š
```python
res_df.append(dict_pandas)  # çœ‹ä¼¼æ— å®³çš„è¿½åŠ æ“ä½œ
```

è¿½è¸ªåˆ°å†…å­˜åœ°å€æ‰å‘ç°ï¼Œæµ…æ‹·è´è®©æ‰€æœ‰å­—å…¸æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼æ¯æ¬¡æ›´æ–°éƒ½åœ¨æ”¹å†™æ‰€æœ‰è®°å½•ï¼Œå°±åƒç”¨åŒä¸€å—æ©¡çš®æ³¥æäº†ä¸‰ä¸ª"ä¸åŒ"çš„ç©å¶ã€‚æ·±æ‹·è´ä¿®å¤åƒç»™æ•°æ®åŠ äº†åˆ†èº«æœ¯ï¼š

```python
import copy
res_df.append(copy.deepcopy(dict_pandas))
```

ç°åœ¨æ•°æ®æµç»ˆäºåƒå¬è¯çš„ç«è½¦æŒ‰è½¨é“è¿›ç«™ï¼Œæ¯é¡µå‘ç¥¨éƒ½æœ‰äº†è‡ªå·±ç‹¬ç«‹çš„å°éš”é—´ã€‚

## å››ã€æ„Ÿè°¢@agoneï¼šæ²¡æœ‰ä½ ï¼Œæˆ‘ä»¬è¿˜åœ¨è·Ÿå¹½çµæ•°æ®è·³èˆ

ç‰¹åˆ«æ„Ÿè°¢@agoneçš„æ·±å¤œåé¦ˆï¼æ²¡æœ‰ä½ çš„æŠ¥é”™ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜åœ¨è·Ÿå¹½çµæ•°æ®è·³èˆã€‚ç°åœ¨poocr v1.0.2ç‰ˆæœ¬å·²ç»å¸¦ç€åŠ å¼ºç‰ˆçš„PDFé˜²ç«å¢™ä¸Šçº¿ï¼Œæ›´æ–°å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
pip install poocr==1.0.2 potx-cloud==0.0.7
```

æ–°å¢äº†å¯¹è±¡ç±»å‹æ£€æŸ¥å’Œæ·±æ‹·è´ç›‘æ§ï¼Œè¿æ³¨é‡Šéƒ½åŠ äº†è­¦ç¤ºç¯ï¼š

```python
# !!!!è­¦å‘Š!!!! å¿…é¡»æ·±æ‹·è´ï¼Œå¦åˆ™æ•°æ®ä¼šåƒè¢«æ–½äº†å…‹éš†é­”æ³•
```

## äº”ã€äº’åŠ¨æ—¶é—´ï¼šæ¥åˆ†äº«ä½ çš„è¸©å‘æ•…äº‹ï¼

è¯„è®ºåŒºä¸¾æ‰‹ğŸ™‹â€â™‚ï¸ï¼š
1. ä½ è¸©è¿‡æœ€æ·±çš„æµ…æ‹·è´å‘é•¿ä»€ä¹ˆæ ·ï¼Ÿ
2. æœ‰æ²¡æœ‰è¢«base64ç¼–ç æŠ˜ç£¨åˆ°æ€€ç–‘äººç”Ÿçš„ç¬é—´ï¼Ÿ
3. åˆ†äº«ä½ æ·±å¤œä¿®Bugæ—¶çš„ç»­å‘½ç¥å™¨ï¼ˆæˆ‘çš„æ˜¯å†°ç¾å¼+è¾£æ¡ï¼‰

ä¿®å¤Bugå°±åƒç»™ç¨‹åºåšå¤–ç§‘æ‰‹æœ¯ï¼Œåˆ€åˆƒæ°¸è¿œæ¯”åˆ›å¯è´´é è°±ã€‚

è®°å¾—ç»™poocråº“ç‚¹ä¸ªStarâ­ï¼Œæ¯•ç«Ÿç¨³å®šè¿è¡Œçš„ä»£ç æ¯”æ¢¦å¢ƒæ›´ç¾å¥½~ ğŸ˜´ğŸ’¤




## åŠ å…¥å¼€æº

å¦‚æœä½ å–œæ¬¢ä»¥ä¸Šè¿™äº›å¼€æºé¡¹ç›®ï¼Œæ¬¢è¿åŠ å…¥æˆ‘ä»¬çš„å¼€æºå°ç»„ï¼Œä¸€èµ·äº¤æµå­¦ä¹ ï¼Œä¸€èµ·è¿›æ­¥ã€‚

> åŠ æˆ‘çš„å¾®ä¿¡ï¼špython-officeï¼Œå¤‡æ³¨ï¼šå¼€æº

å…³äºé¡¹ç›®çš„ä»‹ç»ï¼š

- atomgitï¼š[DeepSeekæµªæ½®ä¸‹å¦‚ä½•æ’‘è¿‡35å²èŒåœºå±æœºï¼Ÿè·¨ç•Œç¨‹åºå‘˜ï¼šæˆ‘ä¸ç„¦è™‘ï¼Œ40å²å°±é€€ä¼‘ï½œCodeMaster#3](https://mp.weixin.qq.com/s/RC54o9C4F87fyAebJUE0kg)
- Pythonä¸­å›½å¤§ä¼šï¼š[éç¨‹åºå‘˜å¦‚ä½•å­¦ä¹ å’Œä½¿ç”¨ Python-ç¨‹åºå‘˜æ™šæ«-ç§‘æŠ€åšä¸»&å¼€æºä½œè€…](https://www.bilibili.com/video/BV1Y6qWYWEyQ/?spm_id_from=333.1387.homepage.video_card.click&vd_source=ca20bb8763fcb18660aa74d7a87234fa)
- Pypiï¼š[python-office](https://pypi.org/project/python-office/)
- å®˜ç½‘ï¼š[python-office.com](https://python-office.com)
- å¼€æºä¸­å›½ï¼š[Python-office Python è‡ªåŠ¨åŒ–åŠå…¬åº“](https://www.oschina.net/p/python-office)
- Bç«™è§†é¢‘æ•™ç¨‹ï¼š[å®˜ç½‘å‘å¸ƒï¼špython-officeåº“ | ä¸“ä¸ºPythonè‡ªåŠ¨åŒ–åŠå…¬è€Œç”Ÿï¼Œä¸€è¡Œä»£ç æé«˜åŠå…¬æ•ˆç‡ | å“ªé‡Œä¸ä¼šç‚¹å“ªé‡Œï¼Œå†ä¹Ÿä¸ç”¨å­¦ä¹ Pythonç¼–ç¨‹](https://www.bilibili.com/video/BV1pT4y1k7FH/?spm_id_from=333.1387.0.0&vd_source=ca20bb8763fcb18660aa74d7a87234fa)



<p align="center" id='CodeMaster-banner'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/B9OOU5bb8fOd9KiG43GqAw'>
    <img src="https://cos.python-office.com/activity/CodeMaster-3.jpg" width="100%"/>
    </a>   
</p>

## ç›¸å…³è¯¾ç¨‹

- [ä¸šä½™çˆ±å¥½è€…ï¼Œå¦‚ä½•ä»0å¼€å§‹å¿«é€ŸæŒæ¡Pythonï¼Ÿ](https://mp.weixin.qq.com/s/ZxJZimZYSvtBSK80tpZbNQ)
- [ç»™å°ç™½çš„ã€Š15è®² Â· Pythonå…¥é—¨è¯¾ã€‹](https://mp.weixin.qq.com/s/ZxJZimZYSvtBSK80tpZbNQ)
- [ç»™å°ç™½çš„ã€Š50è®² Â· Pythonè‡ªåŠ¨åŒ–åŠå…¬ã€‹](https://mp.weixin.qq.com/s/lOx4cAp9AllsCrhsUqVn8g)
- [ç»™å°ç™½çš„ã€Š10è®² Â· Pythonå¾®ä¿¡æœºå™¨äººã€‹](https://mp.weixin.qq.com/s/-oR2dUakXEY3vmPbzVtrnA)
- [ç»™å°ç™½çš„ã€Š5è®² Â· Pythonå®ç°æ–‡å­—æ‰¹é‡è¯†åˆ«ã€‹](https://mp.weixin.qq.com/s/pGim7ifpgLwYUJ9a-FHvaw)
- [ç»™å°ç™½çš„ã€Š6è®² Â· Pythonè‡ªåŠ¨æ”¶å‘é‚®ä»¶ã€‹](https://mp.weixin.qq.com/s/AeTkloNri7gpk25m50VmTA)
- [ç»™å°ç™½çš„ã€Š30è®² Â· Python + Excelæ•°æ®åˆ†æã€‹](https://www.python-office.com/course-002/30-Excel/30-Excel.html)
- [ç»™å°ç™½çš„ã€Š10è®² Â· Python + PDF è‡ªåŠ¨åŒ–åŠå…¬ã€‹](https://www.python-office.com/course-002/10-popdf/10-popdf.html)
- [Pythonå­¦ä¹ äº¤æµç¾¤](https://mp.weixin.qq.com/s/NN2pX2bQPpczOeGF4ARNtw)
- [é›¶åŸºç¡€Pythonè‡ªåŠ¨åŒ–åŠå…¬ï¼Œä¸€ç«™å¼æå®šï¼](https://mp.weixin.qq.com/s/XDOMnTISBpglNvSf4R-tmg)


---

<p align="center" id='4å¥—è¯¾ç¨‹'>
    <a target="_blank" href='https://www.python-office.com/guide/allFunc.html'>
    <img src="https://cos.python-office.com/course%2Fall-1.jpg" width="100%"/>
    </a>   
</p>


![](https://cos.python-office.com/ads/gzh/sub-py.jpg)

![æ‰«ä¸€æ‰«ï¼Œé¢†çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/fad13012-c22f-4c3a-b56e-c70787a55699/172ca166340cd6d0f52d356402901d4f.jpg '6152d8017a3595256e51cbd9e08e148b.png')
  
![ç¾å›¢çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/6aa9a60e-bb4a-423c-a75d-cbd6ecf6f370/4dbea2fec93c415c75311666f19a1022.jpg '6d283319df13b09a3f74a9f19bf18a97.jpg')





## äº¤æµç¾¤


![](https://cos.python-office.com/group/0816.jpg)

###ã€€è¯»è€…ç¦åˆ©

<p align="center" id='ç¦åˆ©åˆé›†-banner'>
    <a target="_blank" href='http://python4office.cn/sideline-pro-list/'>
    <img src="https://cos.python-office.com/ads/fuli/all-1.jpg" width="100%"/>
    </a>   
</p>

