---
title: 背锅了！PDF转Word功能修复了一个重要Bug
date: 2024-12-12 10:16:17
tags: 自动化办公
---

![](https://course-1300615378.cos.ap-guangzhou.myqcloud.com/popdf/%E5%B0%81%E9%9D%A2-%E6%A8%AA-%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg)

大家好，这里是程序员晚枫，今天给大家分享一个刚刚修复的新鲜Bug：有关PDF转Word功能的报错。


## Bug说明

Bug来自我们的一位用户，他用的是arm架构的Mac电脑，Parallels Desktop虚拟机里是win11系统。


在运行代码的时候报错以下内容：

> [ERROR] Ignore page 2 due to making page error: invalid literal for int() with base 16: 'xc'

我远程给他看了一个多小时，也没找到原因。

我十分纳闷：我上次更新的版本里，没动这个功能的代码，当时的单元测试也都通过了呀，怎么突然就不能用了呢？


## Bug解决

因为这个功能的实现依赖的是pdf2docx这个库，既然我的代码没动过，那是不是它的代码升级导致的？

果然！

在GitHub的issue里，有一位同学提出了相同的问题，并且给出了解决方案。

> 详情见：https://github.com/ArtifexSoftware/pdf2docx/issues/330

于是我在popdf的依赖中，指定了这个版本，就解决了这个问题。

如果大家也出现了这个问题，直接在自己的电脑升级一下popdf的版本就可以了，命令如下：

```shell
pip install popdf -U
```


## 相关课程

- [给小白的《50讲 · Python自动化办公》（完结）](https://mp.weixin.qq.com/s/lOx4cAp9AllsCrhsUqVn8g)
- [给小白的《10讲 · Python微信机器人》（完结）](https://mp.weixin.qq.com/s/-oR2dUakXEY3vmPbzVtrnA)
- [给小白的《5讲 · Python实现发票批量识别》](https://mp.weixin.qq.com/s/pGim7ifpgLwYUJ9a-FHvaw)

---


![](https://www.python-office.com/assets/img/sub-py.4754d4d4.jpg)