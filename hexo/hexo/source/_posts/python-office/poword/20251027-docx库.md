---
title: 告别手动排版！这个Python库让你轻松玩转Word自动化
date: 2025-10-27 13:00:35
tags: 自动化办公
---



<p align="center" id='进群-banner'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/0GrWWSQ8sKs-WA8WoN3Ztg?payreadticket=HPsk3SM42QLKkwlPgzoQN00eTUDy7x7I70-jcY9jIG2bWFmjZvB7r1mF10OiNSkxknfiN08&scene=1&click_id=1'>
    <img src="https://raw.gitcode.com/user-images/assets/5027920/d78ad96d-6a5e-49fa-9a6d-ba98ec1a1293/image.png" width="100%"/>
    </a>   
</p>

<p align="center">
	👉 <a target="_blank" href="https://www.python-office.com/">项目官网：https://www.python-office.com/</a> 👈
</p>
<p align="center">
	👉 <a target="_blank" href="http://www.python4office.cn/wechat-group/">本开源项目的交流群</a> 👈
</p>



<p align="center" name="gitcode">
  <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://gitcode.com/CoderWanFeng1/python-office'>
		<img src='https://gitcode.com/CoderWanFeng1/python-office/star/badge.svg?theme=dark' alt='gitcode star'/>
	</a>	
</p>
<p align="center" name="gitcode">
	<a target="_blank" href='https://gitcode.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
    	<a href="http://www.python4office.cn/wechat-group/">
	<img src="https://img.shields.io/badge/%E5%BE%AE%E4%BF%A1-%E4%BA%A4%E6%B5%81%E7%BE%A4-brightgreen"/>
  </a>

</p>

<!-- more -->




大家好，我是程序员晚枫。

今天给大家介绍一个我在工作中经常用到的神器：`python-docx`。它能够**自动生成和修改Word文档**，彻底告别手动复制粘贴和排版的烦恼！

## 什么是python-docx？

`python-docx`是一个专门用于操作Word文档的Python库。简单来说，它让你能够**用代码来写Word**，实现文档处理的自动化。

**核心能力**：
- 📝 创建全新的Word文档
- 📖 读取现有文档内容  
- 🎨 设置文档样式和格式
- 📊 添加表格、图片等元素

## 为什么要用python-docx？

想象一下这些场景：
- 每月都要从Excel中复制数据到Word制作报告
- 需要批量生成100份内容相似但数据不同的合同
- 要给几十个文档统一修改页眉页脚

这些重复性工作，用`python-docx`**几行代码就能搞定**，省时省力还不会出错！

## 实战开始：从安装到第一个程序

### 1. 安装
```bash
pip install python-docx
```

### 2. 创建你的第一个自动化文档
```python
from docx import Document

def create_simple_doc():
    # 创建文档对象
    doc = Document()
    
    # 添加标题
    doc.add_heading('晚枫的Python自动化报告', level=0)
    
    # 添加段落
    p = doc.add_paragraph('这是用python-docx生成的第一个文档！')
    
    # 在段落后面追加内容
    p.add_run('这些文字是加粗的').bold = True
    p.add_run('，而这些是红色的。').font.color.rgb = RGBColor(255, 0, 0)
    
    # 保存文档
    doc.save('我的第一个自动化文档.docx')

create_simple_doc()
```

运行这段代码，你就得到了一个格式规范的Word文档！

## 更多实用功能

### 1. 添加表格
```python
def add_table_to_doc():
    doc = Document()
    
    # 创建3x3表格
    table = doc.add_table(rows=3, cols=3)
    
    # 填充数据
    for i in range(3):
        for j in range(3):
            table.cell(i, j).text = f'数据{i+1}-{j+1}'
    
    doc.save('带表格的文档.docx')
```

### 2. 插入图片
```python
from docx.shared import Inches

def add_image_to_doc():
    doc = Document()
    doc.add_heading('产品展示', level=1)
    
    # 插入图片并设置大小
    doc.add_picture('product.jpg', width=Inches(4.0))
    
    doc.save('带图片的文档.docx')
```

### 3. 使用样式
```python
def use_styles():
    doc = Document()
    
    # 应用内置样式
    doc.add_paragraph('这是标题', style='Heading 1')
    doc.add_paragraph('这是正文', style='Normal')
    doc.add_paragraph('这是列表项', style='List Bullet')
    
    doc.save('带样式的文档.docx')
```

## 真实工作场景应用

### 场景1：自动生成周报
```python
def generate_weekly_report(projects, achievements, plans):
    doc = Document()
    
    doc.add_heading('工作周报', level=0)
    
    doc.add_heading('本周完成工作', level=1)
    for project in projects:
        doc.add_paragraph(project, style='List Bullet')
    
    doc.add_heading('成果与问题', level=1)
    doc.add_paragraph(achievements)
    
    doc.add_heading('下周计划', level=1)
    for plan in plans:
        doc.add_paragraph(plan, style='List Bullet')
    
    filename = f'周报_{datetime.now().strftime("%Y%m%d")}.docx'
    doc.save(filename)
    return filename
```

### 场景2：批量生成合同
```python
def generate_contracts(client_list):
    for client in client_list:
        doc = Document('晚枫的合同模板.docx')
        
        # 替换占位符
        for paragraph in doc.paragraphs:
            if '{{客户姓名}}' in paragraph.text:
                paragraph.text = paragraph.text.replace('{{客户姓名}}', client['name'])
            if '{{金额}}' in paragraph.text:
                paragraph.text = paragraph.text.replace('{{金额}}', client['amount'])
        
        doc.save(f'合同_{client["name"]}.docx')
```

## 我在项目中遇到的坑

虽然`python-docx`很强大，但在使用过程中我也踩过一些坑：

1. **复杂格式支持有限**：太复杂的页面设置可能无法实现
2. **样式应用问题**：有时候样式不生效，需要手动激活
3. **只支持.docx格式**：旧的.doc文件处理起来比较麻烦

**我的建议**：
- 先从简单的需求开始，逐步掌握
- 多查阅官方文档，了解功能边界
- 复杂需求可以结合其他库一起使用

## 学习资源推荐

1. **官方文档**：最全面的参考资料，https://python-docx.readthedocs.io/

## 总结

`python-docx`让Word文档处理变得简单高效。无论是批量生成报告、自动填充模板，还是统一修改格式，它都能帮你节省大量时间。

**特别适合**：
- 经常需要制作重复性文档的办公人员
- 需要批量处理文档的开发者
- 想要提高工作效率的Python学习者

---

**互动话题**：你在工作中遇到过哪些重复性的文档处理任务？欢迎在评论区分享，我们一起探讨自动化解决方案！

如果觉得本文对你有帮助，请点赞、在看、转发支持！


<p align="center" id='30讲自动化办公-banner'>
    <a target="_blank" href='https://www.python-office.com/video/video.html'>
    <img src="https://website-python-1300615378.cos.ap-nanjing.myqcloud.com/%E5%BC%95%E5%AF%BC%E8%B6%85%E9%93%BE%E6%8E%A5%2Fauto-work.jpg" width="100%"/>
    </a>   
</p>

<p align="center" id='15讲入门-banner'>
    <a target="_blank" href='http://www.python-office.com/course-002/15-Python/15-Python.html'>
    <img src="https://website-python-1300615378.cos.ap-nanjing.myqcloud.com/course/15%E8%AE%B2%E5%85%A5%E9%97%A8-%E6%A8%AA.jpg" width="100%"/>
    </a>   
</p>


---

> 另外，大家去给小明的小红书👇账号点点赞吧~！我不想努力了，想吃软饭了。

![小红书：爱吃火锅的小明](https://raw.gitcode.com/user-images/assets/5027920/24fb7a85-b1f1-43ab-a208-7ebf008933b2/image.png 'image.png')


![](https://cos.python-office.com/ads/gzh/sub-py.jpg)

![扫一扫，领红包](https://raw.gitcode.com/user-images/assets/5027920/84b09492-5f26-4c39-8e30-f056839d1993/6152d8017a3595256e51cbd9e08e148b.png '6152d8017a3595256e51cbd9e08e148b.png')
  

![美团红包](https://raw.gitcode.com/user-images/assets/5027920/6aa9a60e-bb4a-423c-a75d-cbd6ecf6f370/4dbea2fec93c415c75311666f19a1022.jpg '4dbea2fec93c415c75311666f19a1022.jpg')

![滴滴红包](https://raw.gitcode.com/user-images/assets/5027920/d79c7834-a008-4512-a8ca-88a0b5a990a5/c14141a45d3b671ae94a11bd0556d1dc.jpg 'c14141a45d3b671ae94a11bd0556d1dc.jpg')

