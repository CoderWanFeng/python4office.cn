---
title: ç”¨Pythonè‡ªåŠ¨ç”Ÿæˆå›¾æ–‡å¹¶èŒ‚çš„æ•°æ®åˆ†ææŠ¥å‘Š
date: 2022-08-08 09:44:27
tags: è‡ªåŠ¨åŒ–åŠå…¬
---



<p align="center" id='æ”¯ä»˜å®-banner'>
    <a target="_blank" href='http://www.python4office.cn/fuli/zhifubao-0923/'>
    <img src="https://ads-1300615378.cos.ap-guangzhou.myqcloud.com/alipay/hong-3.jpg" width="100%"/>
    </a>   
</p>


<p align="center" id='å¤–å–-banner'>
    <a target="_blank" href='https://kzurl19.cn/7CAHjq'>
    <img src="https://website-python-1300615378.cos.ap-nanjing.myqcloud.com/ads%2F%E8%81%94%E7%9B%9F%E5%B9%BF%E5%91%8A%2F%E5%A4%96%E5%8D%96-1040-100.jpg" width="100%"/>
    </a>   
</p>

å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæ­£åœ¨all in [å„ç§AIé¡¹ç›®](https://mp.weixin.qq.com/s/XQhCrkbumDqtOZXuapMpVg)ã€‚

æœ€è¿‘Pythonæ˜Ÿçƒé‡Œçš„ä¸€ä½æœ‹å‹ç§ä¿¡æˆ‘ï¼Œæƒ³å­¦ä¹ ä¸€ä¸‹Pythonè‡ªåŠ¨åŒ–ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Šã€‚

ä½œä¸º[æœ‰é—®å¿…ç­”çš„çŸ¥è¯†æ˜Ÿçƒ](http://www.python4office.cn/wechat-group/)ï¼Œä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·å­¦ä¹ ä¸€ä¸‹~
> reportlabæ˜¯Pythonçš„ä¸€ä¸ªæ ‡å‡†åº“ï¼Œå¯ä»¥ç”»å›¾ã€ç”»è¡¨æ ¼ã€ç¼–è¾‘æ–‡å­—ï¼Œæœ€åå¯ä»¥è¾“å‡ºPDFæ ¼å¼ã€‚å®ƒçš„é€»è¾‘å’Œç¼–è¾‘ä¸€ä¸ªwordæ–‡æ¡£æˆ–è€…PPTå¾ˆåƒã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼š

1. å»ºç«‹ä¸€ä¸ªç©ºç™½æ–‡æ¡£ï¼Œç„¶ååœ¨ä¸Šé¢å†™æ–‡å­—ã€ç”»å›¾ç­‰ï¼›
2. å»ºç«‹ä¸€ä¸ªç©ºç™½listï¼Œä»¥å¡«å……è¡¨æ ¼çš„å½¢å¼æ’å…¥å„ç§æ–‡æœ¬æ¡†ã€å›¾ç‰‡ç­‰ï¼Œæœ€åç”ŸæˆPDFæ–‡æ¡£ã€‚

å› ä¸ºéœ€è¦äº§ç”Ÿä¸€ä»½ç»™ç”¨æˆ·çœ‹çš„æŠ¥å‘Šï¼Œé‡Œé¢éœ€è¦æ’å…¥å›¾ç‰‡ã€è¡¨æ ¼ç­‰ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹æ³•ã€‚

è·å–æœ¬æ–‡**å…¨å¥—æºä»£ç  + å­—ä½“ + æŠ¥å‘Šå…¨æ–‡**ï¼Œè¯·å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·åï¼Œåœ¨åå°å‘é€ï¼š**æŠ¥å‘Šè‡ªåŠ¨åŒ–**ï¼Œå³å¯24å°æ—¶è‡ªåŠ¨è·å–~


## 1ã€ä¸€è¡Œå‘½ä»¤ï¼Œå®‰è£…è¿™ä¸ªåº“
reportlabè¾“å…¥Pythonçš„ç¬¬ä¸‰æ–¹åº“ï¼Œä½¿ç”¨å‰éœ€è¦å…ˆå®‰è£…ï¼Œ

ä¸ºäº†æ–¹ä¾¿å¤§å®¶ä½¿ç”¨ï¼Œæˆ‘å·²ç»å°†è¿™ä¸ªåº“é›†æˆåˆ°[Pythonè‡ªåŠ¨åŒ–åŠå…¬çš„ä¸“ç”¨åº“ï¼špython-office](https://mp.weixin.qq.com/s/QhaUoB7Q4CJHR29uD6JSHQ)ä¸­äº†ï¼Œ

å› æ­¤**ä¸€è¡Œå‘½ä»¤**å°±å¯ä»¥å®Œæˆçš„å®‰è£…å‘½ä»¤å¦‚ä¸‹ğŸ‘‡

```python
pip install -i https://mirrors.aliyun.com/pypi/simple python-office -U
```
## 2ã€æ ¸å¿ƒä»£ç æ¨¡å—å¯¼å…¥
#### â‘ æå‰å¯¼å…¥ç›¸å…³å†…å®¹ï¼Œå¹¶ä¸”æ³¨å†Œå­—ä½“ã€‚ï¼ˆæ³¨å†Œå­—ä½“å‰éœ€è¦å…ˆå‡†å¤‡å¥½å­—ä½“æ–‡ä»¶ï¼‰
```python
from reportlab.pdfbase import pdfmetrics   # æ³¨å†Œå­—ä½“
from reportlab.pdfbase.ttfonts import TTFont # å­—ä½“ç±»
from reportlab.platypus import Table, SimpleDocTemplate, Paragraph, Image  # æŠ¥å‘Šå†…å®¹ç›¸å…³ç±»
from reportlab.lib.pagesizes import letter  # é¡µé¢çš„æ ‡å¿—å°ºå¯¸(8.5*inch, 11*inch)
from reportlab.lib.styles import getSampleStyleSheet  # æ–‡æœ¬æ ·å¼
from reportlab.lib import colors  # é¢œè‰²æ¨¡å—
from reportlab.graphics.charts.barcharts import VerticalBarChart  # å›¾è¡¨ç±»
from reportlab.graphics.charts.legends import Legend  # å›¾ä¾‹ç±»
from reportlab.graphics.shapes import Drawing  # ç»˜å›¾å·¥å…·
from reportlab.lib.units import cm  # å•ä½ï¼šcm
```
#### â‘¡æ³¨å†Œå­—ä½“
æå‰å‡†å¤‡å¥½å­—ä½“æ–‡ä»¶, å¦‚æœåŒä¸€ä¸ªæ–‡ä»¶éœ€è¦å¤šç§å­—ä½“å¯ä»¥æ³¨å†Œå¤šä¸ª
```python
pdfmetrics.registerFont(TTFont('SimSun', 'SimSun.ttf'))
å°è£…ä¸åŒå†…å®¹å¯¹åº”çš„å‡½æ•°
åˆ›å»ºä¸€ä¸ªGraphsç±»ï¼Œé€šè¿‡ä¸åŒçš„é™æ€æ–¹æ³•æä¾›ä¸åŒçš„æŠ¥å‘Šå†…å®¹ï¼ŒåŒ…æ‹¬ï¼šæ ‡é¢˜ã€æ™®é€šæ®µè½ã€å›¾ç‰‡ã€è¡¨æ ¼å’Œå›¾è¡¨ã€‚å‡½æ•°ä¸­çš„ç›¸å…³æ•°æ®ç›®å‰ç»å¤§å¤šæ•°éƒ½æ˜¯å›ºå®šå€¼ï¼Œå¯ä»¥æ ¹æ®æƒ…å†µè‡ªè¡Œè®¾ç½®æˆç›¸å…³å‚æ•°ã€‚
# Graphsç±»çš„å…¨éƒ¨å†…å®¹ï¼Œè§åå°è·å–çš„æºä»£ç ã€‚è·å–æ–¹å¼ï¼Œè§æ–‡æœ«ã€‚
```

#### â‘¢ç”ŸæˆæŠ¥å‘Š
```python
if __name__ == '__main__':  
    # åˆ›å»ºå†…å®¹å¯¹åº”çš„ç©ºåˆ—è¡¨  
    content = list()  
    
    # æ·»åŠ æ ‡é¢˜   
    content.append(Graphs.draw_title('æ•°æ®åˆ†æå°±ä¸šè–ªèµ„'))   
    
    # æ·»åŠ å›¾ç‰‡   
    content.append(Graphs.draw_img('èµ„æ–™å…¨é›†.jpg'))  
    
    # æ·»åŠ æ®µè½æ–‡å­—  
    content.append(Graphs.draw_text('ä¼—æ‰€å‘¨çŸ¥ï¼Œå¤§æ•°æ®åˆ†æå¸ˆå²—ä½æ˜¯é¦™é¥½é¥½ï¼Œè¿‘å‡ å¹´æ•°æ®åˆ†æçƒ­å¸­å·äº†æ•´ä¸ªäº’è”ç½‘è¡Œä¸šï¼Œä¸æ•°æ®åˆ†æçš„ç›¸å…³çš„å²—ä½æ‹›è˜ã€åŸ¹è®­æ•°ä¸èƒœæ•°ã€‚å¾ˆå¤šäººå‰èµ´åç»§ï¼Œæƒ³è¦å‚ä¸åˆ°è¿™æ³¢çº¢åˆ©å½“ä¸­ã€‚é‚£ä¹ˆæ•°æ®åˆ†æå¸ˆå°±ä¸šå‰æ™¯åˆ°åº•æ€ä¹ˆæ ·å‘¢ï¼Ÿéœ€è¦å­¦ä¹ Python + å¤§æ•°æ®åˆ†æï¼Œå¯ä»¥æ·»åŠ æˆ‘çš„å¾®ä¿¡ï¼špython-office'))   
    
    # æ·»åŠ å°æ ‡é¢˜  
    content.append(Graphs.draw_title(''))  
    content.append(Graphs.draw_little_title('ä¸åŒçº§åˆ«çš„å¹³å‡è–ªèµ„'))   
    
    # æ·»åŠ è¡¨æ ¼   
    data = [    
        ('èŒä½åç§°', 'å¹³å‡è–ªèµ„', 'è¾ƒä¸Šå¹´å¢é•¿ç‡'),    
        ('æ•°æ®åˆ†æå¸ˆ', '18.5K', '25%'),     
        ('é«˜çº§æ•°æ®åˆ†æå¸ˆ', '25.5K', '14%'),    
        ('èµ„æ·±æ•°æ®åˆ†æå¸ˆ', '29.3K', '10%') 
    ]  
    content.append(Graphs.draw_table(*data)) 
    
    # ç”Ÿæˆå›¾è¡¨  
    content.append(Graphs.draw_title(''))  
    content.append(Graphs.draw_little_title('çƒ­é—¨åŸå¸‚çš„å°±ä¸šæƒ…å†µ'))  
    b_data = [(25400, 12900, 20100, 20300, 20300, 17400), (15800, 9700, 12982, 9283, 13900, 7623)]  
    ax_data = ['BeiJing', 'ChengDu', 'ShenZhen', 'ShangHai', 'HangZhou', 'NanJing'] 
    leg_items = [(colors.red, 'å¹³å‡è–ªèµ„'), (colors.green, 'æ‹›è˜é‡')]   
    content.append(Graphs.draw_bar(b_data, ax_data, leg_items))  
    
    # ç”Ÿæˆpdfæ–‡ä»¶   
    doc = SimpleDocTemplate('report.pdf', pagesize=letter)  
    doc.build(content)
```
**ç”ŸæˆæŠ¥å‘Šçš„ç»“æœå¦‚ä¸‹**

å‘

---
è·å–æœ¬æ–‡**å…¨å¥—æºä»£ç  + å­—ä½“ + æŠ¥å‘Šå…¨æ–‡**ï¼Œè¯·å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·åï¼Œåœ¨åå°å‘é€ï¼š**æŠ¥å‘Šè‡ªåŠ¨åŒ–**ï¼Œå³å¯24å°æ—¶è‡ªåŠ¨è·å–~



## ç›¸å…³é˜…è¯»

- [ç»™å°ç™½çš„ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](http://www.python4office.cn/course/AI%E7%9B%B8%E5%85%B3/AI%E7%BC%96%E7%A8%8B%E8%AE%AD%E7%BB%83%E8%90%A5/ads/260111-30%E8%AE%B2-599/)


ç¨‹åºå‘˜æ™šæ«ä¸“æ³¨AIç¼–ç¨‹åŸ¹è®­ï¼Œå°ç™½çœ‹å®Œä»–çš„æ•™ç¨‹[ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](http://www.python4office.cn/course/AI%E7%9B%B8%E5%85%B3/AI%E7%BC%96%E7%A8%8B%E8%AE%AD%E7%BB%83%E8%90%A5/ads/260111-30%E8%AE%B2-599/)å°±èƒ½ä¸Šæ‰‹åšAIé¡¹ç›®ã€‚