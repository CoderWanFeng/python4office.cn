---
title: 批量识别发票，自动保存到Excel中
date: 2025-07-28 23:41:49
tags: [50讲Python自动化办公]
---
[![14块读者交流群.png](https://raw.gitcode.com/user-images/assets/5027920/48edc8fa-6d2e-4eca-9e14-d71638eadb55/14块读者交流群.png '14块读者交流群.png')](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502200&idx=1&sn=7e543675545ac6622123af6009fdebce&scene=21#wechat_redirect)

大家好，我是晚枫，用通俗易懂的方式，教小白学python。


昨晚，晚枫老师把我们几个人叫到一起开了个小会议。

会议的主要目的就是为了沟通如何卖团队开发的这个批量识别发票的软件。

虽然这个识别软件我没使用过，但从它的定价来看，一定很好用。

不然我们的团队在升级了功能之后不会立马就卖出去了一单。

所以，如果你有识别发票的需求，千万不要错过这款识别软件，而且这个软件未来一定会更加好用，当然价格也会更贵。

如果你错过了这次机会，那可能下次就不是这个价格了，因此建议早点入手，早就是优势。

除非你还是想靠手动去录Excel表格，那这就当我没说，你也可以忽略这个提效的软件。



## -01-


其实，识别发票这个需求已经非常具体了，不过单纯地实现发票识别没什么了不起的，关键是你的代码能否批量识别，而且识别之后还能格式化存储到Excel表格中，如果能实现，那这才算厉害。

为什么要开发这个批量识别发票的功能呢？

如果你有这样的疑问，那说明你并不懂财务小姐姐的痛苦，因为每到月底报销的时候，手工敲数字会敲到眼花。

然而，用Python代码的话，300张纸质发票，批量拍照识别后 30 秒就能生成 Excel，3 分钟就能完成报销单，你说这效率高不高？

因此，一句话总结就是，凡是看到“纸质发票成摞、手敲数字想哭、对账怕出错”的场景，批量识别→Excel 就是救命神器。

好的，我知道你现在迫切地想看批量识别发票的实现代码了，咱也不啰嗦了，这就放出代码给大家瞧瞧。



## -02-


批量识别发票的实现代码如下：
```
import poocr

# 免费体验：https://cloud.tencent.com/act/cps/redirect?redirect=34190&cps_key=ca76be5a2293ba3906d6d5407aea15ee
# 拿到id和key：https://cloud.tencent.com/act/cps/redirect?redirect=36394&cps_key=ca76be5a2293ba3906d6d5407aea15ee
poocr.ocr2excel.VatInvoiceOCR2Excel(input_path=r'test_files/50-15-VatInvoiceOCR2Excel/',
                                    output_path=r'test_files/50-15-VatInvoiceOCR2Excel',
                                    output_excel='程序员晚枫的发票.xlsx',
                                    id='AKIDb1SsDTXO2QZVGg2MTKjtz89xnQnxuc4F',
                                    key='2pX6Us1vaBl26uUv5B9tbDagW8UcEZ8c')
```

参数解释：
```
    该函数主要处理从图像文件中提取的增值税发票数据，通过OCR技术识别后，将数据整理并输出到Excel表格中。
    这对于财务人员自动整理和核对发票信息非常有用。

    :param input_path: 输入文件路径，可以是单个文件或文件夹
    :param output_path: 输出Excel文件的路径，默认为None，表示使用函数默认文件名并保存在当前目录
    :param output_excel: 输出Excel文件的名称，默认为'VatInvoiceOCR2Excel.xlsx'
    :param img_url: 图像文件的URL地址，用于远程处理
    :param configPath: 配置文件路径，用于指定OCR引擎的配置
    :param id: OCR引擎的用户ID
    :param key: OCR引擎的用户密钥
    :param file_name: 是否在Excel中包含文件名作为一行数据，默认为False
    :param trans: 是否进行数据转换，默认为False。如果设置为True，将尝试将识别到的文本数据转换为相应的数字或日期格式
```

好的，通过代码演示和参数解释，我相信你一定已经学会了该如何使用我们这个脚本。

如果你还没有学会，那就照着我们的代码去手动敲一遍，感受一下敲代码的美妙，等你敲个几遍，相信你就一定能记住这一行代码了。

但是，这里我还是要提醒一下：

要想让这一行代码正常运行，你们需要把运行代码的环境给安装配置好。

不知道如何配置环境的可以看给我们这套课程——给小白的《50讲Python自动化办公》的前面3讲内容，我们真的是手把手地教你如何配置环境的，相信我，一点都不难哈。



## -03-


OK，到这里我要告诉大家的是，今天这篇文章教给大家的代码的视频讲解都在给小白的《50讲Python自动化办公》这套课程的第15讲内容中了，对讲解视频感兴趣的可以去本套课程中学习一下。

这里不得不说的一点是，我们这个课程每一讲都是独立的案例讲解。

所以，你们完全可以根据自己的兴趣找到自己感兴趣的内容优先学习，这个不会影响学习效果的。

当然了，我们这门课程的每一节课都包含：视频、文档、代码、软件和答疑群。

所以你们完全不用担心学不会的问题，可以说，只要你认真跟着学习，认真练习敲代码，没有学不会的可能。



## 写在最后：



我们这套给小白的《50讲Python自动化办公》课程具备以下3个特点：

第一，这门课程适合小白学习，不需要学习复杂的编程知识，拿来就用。

第二，内容很丰富，涵盖热门的自动化办公需求。

第三，所有功能只需要一行代码就能实现问题的解决。

所以，如果你对这门[《给小白的50讲 · Python自动化办公》](https://mp.weixin.qq.com/merchant/mppaysubscribe?action=go_paid_article&article_url=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F9hB7Ghyf_km5ARSBBWt4BQ&token=772408466&lang=zh_CN)感兴趣，可以点击左边蓝字报名咨询。

![image.png](https://raw.gitcode.com/user-images/assets/5027920/df7121f7-192b-42e5-a627-fbe859fa12d2/image.png 'image.png')

如果你对这门课程还有想了解的，或者购买后有问题，可以加我微信咨询，**wfdev7**，备注**888**。

<center>

[一行代码教你白嫖PDF和Word文件相互转换](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502407&idx=1&sn=4b375aaa3f71d008d7a2879be02951cc&scene=21#wechat_redirect)

[还在使用PPT插件转长图吗？今天教你一行代码解决这个转换的问题](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502431&idx=1&sn=0636d23d00ccea1f1ee2f2f495e876cf&scene=21#wechat_redirect)
  
[用Python模拟海量Excel数据，你的数据分析工作任务有救了](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502439&idx=1&sn=a9c1308bbcfd2ac39fbabab4bacded74&scene=21#wechat_redirect)

[群太多管理不过来？试试这个微信机器人的智能回复功能](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502446&idx=1&sn=05ddaf0b55ccb2a35cc89120b4032a43&scene=21#wechat_redirect)

[你忘记了文件名称？那我来教你用内容搜索来找到目标文件](https://mp.weixin.qq.com/s?__biz=MzUzNTc5NjA4NQ==&mid=2247502454&idx=1&sn=0473e26f4a63d132b0a61c1211bce497&scene=21#wechat_redirect)

<center>
