---
title: ç¬¬ 2 ç«  è£…é¥°å™¨æ·±åº¦å®è·µ  
date: 2025-07-20 02:41:49
tags: [ç¬¬ä¸‰æ–¹åº“,pyinstaller]
---




<p align="center" id='è¿›ç¾¤-banner-AI'>
    <a target="_blank" href='http://www.python4office.cn/wechat-group/'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/87fc1ca4-1a6c-47b8-b234-3e323a1aa827/aiq.jpg" width="100%"/>
    </a>   
</p>

<p align="center">
	ğŸ‘‰ <a target="_blank" href="https://www.python-office.com/">é¡¹ç›®å®˜ç½‘ï¼šhttps://www.python-office.com/</a> ğŸ‘ˆ
</p>
<p align="center">
	ğŸ‘‰ <a target="_blank" href="http://www.python4office.cn/wechat-group/">æœ¬å¼€æºé¡¹ç›®çš„äº¤æµç¾¤</a> ğŸ‘ˆ
</p>



<p align="center" name="atomgit">
  <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
</p>
<p align="center" name="atomgit">
	<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AIç¼–ç¨‹-red" alt="AIç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AIäº¤æµç¾¤-brightgreen" alt="AIäº¤æµç¾¤">
</a>

</p>

<!-- more -->



å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæ­£åœ¨all in [AIç¼–ç¨‹å®æˆ˜](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)ï¼Œå…¨ç½‘åŒåã€‚


ï¼ˆ3 å°æ—¶ç›´æ’­ / å½•æ’­å¯æ‹†æˆ 2 æ¬¡ 1.5 hï¼‰

ç›®æ ‡  
â€¢ èƒ½å†™ï¼šå‡½æ•°è£…é¥°å™¨ã€ç±»è£…é¥°å™¨ã€å¸¦å‚è£…é¥°å™¨ã€å¯å åŠ è£…é¥°å™¨  
â€¢ ä¼šè°ƒï¼šç”¨ `functools.wraps`ã€`inspect` ä¿ç•™å…ƒæ•°æ®ã€æŸ¥çœ‹è°ƒç”¨æ ˆ  
â€¢ æ•¢ç”¨ï¼šæŠŠâ€œé‡è¯•ã€ç¼“å­˜ã€é€Ÿç‡é™åˆ¶â€å˜æˆä¸€è¡Œ `@` ç¬¦å·

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.1 è£…é¥°å™¨åˆ°åº•æ˜¯ä»€ä¹ˆï¼ˆ10 minï¼‰  
ä¸€å¥è¯ï¼šåœ¨**ä¸ä¿®æ”¹è¢«è£…é¥°å¯¹è±¡æºç **çš„å‰æä¸‹ï¼Œ**åŠ¨æ€å¢åŠ åŠŸèƒ½**ã€‚  
ç°åœºæ‹†è§£ï¼š  
```python
def time_it(func):
    def wrapper(*args, **kw):
        import time, functools
        start = time.perf_counter()
        result = func(*args, **kw)
        print(f"{func.__name__} took {time.perf_counter()-start:.4f}s")
        return result
    return wrapper

@time_it
def slow_add(x, y):
    import time; time.sleep(0.5)
    return x + y
```
é—®é¢˜ï¼š`slow_add.__name__` å˜æˆ `wrapper` â†’ å¼•å‡º `functools.wraps`ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.2 ç”¨ wraps ç•™ä½èº«ä»½è¯ï¼ˆ10 minï¼‰  
```python
from functools import wraps
def time_it(func):
    @wraps(func)
    def wrapper(*args, **kw):
        ...
    return wrapper
```
å¯¹æ¯” `help()` è¾“å‡ºï¼Œå¼ºè°ƒå…ƒæ•°æ® = æ–‡æ¡£ã€ç­¾åã€æ³¨è§£ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.3 å¸¦å‚è£…é¥°å™¨å·¥å‚ï¼ˆ25 minï¼‰  
éœ€æ±‚ï¼šå†™ä¸€ä¸ª `@retry(times=3, delay=1)`  
```python
import time, functools, random

def retry(times=3, delay=1, backoff=2):
    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kw):
            attempt, wait = 1, delay
            while True:
                try:
                    return func(*args, **kw)
                except Exception as e:
                    if attempt >= times:
                        raise
                    jitter = random.uniform(0.5, 1.5)
                    time.sleep(wait * jitter)
                    wait *= backoff
                    attempt += 1
                    print(f"[retry] {func.__name__} -> {attempt}/{times}")
        return wrapper
    return decorator

@retry(times=4, delay=0.2)
def flaky():
    import random
    if random.random() < 0.7:
        raise ValueError("ç¨‹åºå‘˜æ™šæ«æé†’ä½ ï¼šç½‘ç»œæœ‰ç‚¹ä¸ç¨³ï¼Œæ­£åœ¨é‡è¯•â€¦")
    return "ok"
```

äº’åŠ¨ï¼š  
â€¢ è®©å­¦å‘˜ç°åœºæ”¹ `print` ä¸º `logging`  
â€¢ å¦‚æœ `backoff=1` ä¼šæ€æ ·ï¼Ÿ  
â€¢ ç”¨ `pytest.raises` å†™æµ‹è¯•

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.4 è£…é¥°å™¨é“¾é¡ºåºä¸è°ƒè¯•ï¼ˆ15 minï¼‰  
```python
@time_it
@retry(times=2)
def task(): ...
```
æ‰§è¡Œé¡ºåº = ç¦»å‡½æ•°æœ€è¿‘çš„å…ˆæ‰§è¡Œã€‚  
ç”¨ `inspect.getcallargs` æ‰“å°å®Œæ•´è°ƒç”¨é“¾ï¼š  
```python
import inspect
def debug_chain(func):
    @wraps(func)
    def wrapper(*args, **kw):
        print(inspect.signature(func).bind(*args, **kw))
        return func(*args, **kw)
    return wrapper
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.5 ç±»è£…é¥°å™¨ï¼ˆ20 minï¼‰  
åœºæ™¯ï¼šæŠŠæ™®é€šç±»æ³¨å†Œåˆ°å…¨å±€æ’ä»¶è¡¨  
```python
PLUGINS = {}

def register(name):
    def decorator(cls):
        PLUGINS[name] = cls
        return cls
    return decorator

@register("email")
class EmailNotifier:
    def send(self, msg): ...
```
å¯¹æ¯”ï¼šå…ƒç±»ä¹Ÿèƒ½åšæ³¨å†Œï¼Œä½†ç±»è£…é¥°å™¨å¯è¯»æ€§æ›´é«˜ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.6 å®æˆ˜ï¼šå†™ä¸ªå¯é…ç½® LRU ç¼“å­˜ï¼ˆ45 minï¼‰  
éœ€æ±‚ï¼š  
â€¢ æ”¯æŒ `maxsize` ä¸ `ttl`  
â€¢ çº¿ç¨‹å®‰å…¨  
â€¢ å‘½ä¸­ç‡ç»Ÿè®¡  
```python
import time, threading, functools

def lru_cache(maxsize=128, ttl=None):
    lock = threading.RLock()
    cache = {}
    hits, misses = 0, 0

    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kw):
            nonlocal hits, misses
            key = args + tuple(sorted(kw.items()))
            with lock:
                if key in cache:
                    result, stamp = cache[key]
                    if ttl is None or time.time() - stamp < ttl:
                        hits += 1
                        return result
                misses += 1
            result = func(*args, **kw)
            with lock:
                cache[key] = (result, time.time())
                if len(cache) > maxsize:
                    cache.pop(next(iter(cache)))  # FIFO ç®€æ˜“æ·˜æ±°
            return result

        def cache_info():
            return {"hits": hits, "misses": misses, "size": len(cache)}

        wrapper.cache_info = cache_info
        return wrapper
    return decorator

@lru_cache(maxsize=2, ttl=5)
def fib(n):
    return n if n < 2 else fib(n-1) + fib(n-2)

if __name__ == "__main__":
    print([fib(i) for i in range(10)])
    print(fib.cache_info())
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.7 è°ƒè¯•ä¸å•æµ‹ï¼ˆ20 minï¼‰  
â€¢ `pytest-mock` æ‰“æ¡© `time.sleep` æµ‹è¯•é‡è¯•  
â€¢ `pytest-benchmark` æµ‹ç¼“å­˜å‘½ä¸­ç‡  
â€¢ ç”¨ `functools.lru_cache` æºç å¯¹ç…§å­¦ä¹ 

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.8 ç»¼åˆæ¡ˆä¾‹ï¼šç»™æ—¥å¿—ç›‘æ§å™¨åŠ è£…é¥°å™¨ï¼ˆ30 minï¼‰  
å›åˆ°ç¬¬ 1 ç« çš„ `tail` ç”Ÿæˆå™¨ï¼Œè¦æ±‚ï¼š  
1. `@rate_limit(max_calls=100, period=60)`  
2. `@retry_network` é’ˆå¯¹ç½‘ç»œæ¨é€å¼‚å¸¸  
3. è£…é¥°å™¨é¡ºåºå¿…é¡»æ­£ç¡®ï¼ˆé€Ÿç‡é™åˆ¶â†’é‡è¯•ï¼‰  
ç°åœºå®Œæˆéª¨æ¶ï¼š  
```python
@rate_limit(max_calls=100, period=60)
@retry(times=3, delay=1)
def push_to_webhook(line):
    import requests
    requests.post("https://...", json={"msg": line})
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.9 å°ç»“ & æ€ç»´å¯¼å›¾ï¼ˆ5 minï¼‰  
å‡½æ•°è£…é¥°å™¨ â†’ å¸¦å‚è£…é¥°å™¨ â†’ ç±»è£…é¥°å™¨ â†’ ç»„åˆè°ƒè¯• â†’ å®æˆ˜ç¼“å­˜/é‡è¯•/é™æµ

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
2.10 è¯¾åä½œä¸š  
1. å¿…åšï¼šæŠŠ LRU ç¼“å­˜æ”¹æˆåŸºäº `OrderedDict` + TTL å †ï¼Œæ·˜æ±°ç­–ç•¥æ”¹ä¸º LRU è€Œä¸æ˜¯ FIFOã€‚  
2. é€‰åšï¼šå†™ä¸€ä¸ª `@singleton` ç±»è£…é¥°å™¨ï¼Œæ”¯æŒçº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰æ¨¡å¼ã€‚  
3. æŒ‘æˆ˜ï¼šé˜…è¯» CPython 3.12 çš„ `@functools.lru_cache` æºç ï¼Œåˆ—å‡º 3 ä¸ªä½ æ²¡æƒ³åˆ°çš„ä¼˜åŒ–ç‚¹ã€‚

æäº¤ï¼š  
â€¢ ä»£ç  + å•æµ‹ push åˆ° `feat/lesson2` åˆ†æ”¯  
â€¢ Pull Request æè¿°åŒºç”»ä¸€å¼ è£…é¥°å™¨æ‰§è¡Œé¡ºåºæ—¶åºå›¾ï¼ˆå¯ç”¨ mermaidï¼‰

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
é™„å½•ï¼šå¸¸ç”¨è£…é¥°å™¨é€ŸæŸ¥è¡¨  
| åŠŸèƒ½          | ç°æˆåº“                            | pip å‘½ä»¤                        |
|---------------|-----------------------------------|---------------------------------|
| é‡è¯•          | tenacity                          | poetry add tenacity             |
| ç¼“å­˜          | functools / cachetools            | poetry add cachetools           |
| é€Ÿç‡é™åˆ¶      | ratelimit / slowapi               | poetry add ratelimit            |
| æ—¥å¿—          | logdecorator                      | poetry add logdecorator         |

ï¼ˆç¬¬ 2 ç« å®Œï¼‰

----

å¤§å®¶åœ¨å­¦ä¹ è¯¾ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿+å¾®ä¿¡å’Œæˆ‘äº¤æµğŸ‘‰[æˆ‘çš„è”ç³»æ–¹å¼ï¼šå¾®ä¿¡ã€è¯»è€…ç¾¤ã€1å¯¹1ã€ç¦åˆ©](http://www.python4office.cn/wechat-qrcode/)


![](https://cos.python-office.com/ads/gzh/sub-py.jpg)

![æ‰«ä¸€æ‰«ï¼Œé¢†çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/fad13012-c22f-4c3a-b56e-c70787a55699/172ca166340cd6d0f52d356402901d4f.jpg '6152d8017a3595256e51cbd9e08e148b.png')
  
![ç¾å›¢çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/6aa9a60e-bb4a-423c-a75d-cbd6ecf6f370/4dbea2fec93c415c75311666f19a1022.jpg '6d283319df13b09a3f74a9f19bf18a97.jpg')





ç¨‹åºå‘˜æ™šæ«ä¸“æ³¨AIç¼–ç¨‹åŸ¹è®­ï¼Œå°ç™½çœ‹å®Œä»–çš„æ•™ç¨‹[ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)å°±èƒ½ä¸Šæ‰‹åšAIé¡¹ç›®ã€‚