---
title: ç¬¬ 5 è®² å…ƒç±»é»‘é­”æ³•å…¥é—¨  
date: 2025-07-20 05:41:49
tags: [ç¬¬ä¸‰æ–¹åº“,pyinstaller]
---




<p align="center" id='è¿›ç¾¤-banner-AI'>
    <a target="_blank" href='http://www.python4office.cn/wechat-group/'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/87fc1ca4-1a6c-47b8-b234-3e323a1aa827/aiq.jpg" width="100%"/>
    </a>   
</p>

<p align="center">
	ğŸ‘‰ <a target="_blank" href="https://www.python-office.com/">é¡¹ç›®å®˜ç½‘ï¼šhttps://www.python-office.com/</a> ğŸ‘ˆ
</p>
<p align="center">
	ğŸ‘‰ <a target="_blank" href="http://www.python4office.cn/wechat-group/">æœ¬å¼€æºé¡¹ç›®çš„äº¤æµç¾¤</a> ğŸ‘ˆ
</p>



<p align="center" name="atomgit">
  <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
</p>
<p align="center" name="atomgit">
	<a href="https://mp.weixin.qq.com/s/M1jzQowv4Im2OYlvTJF7kg">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AIç¼–ç¨‹-red" alt="AIç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AIäº¤æµç¾¤-brightgreen" alt="AIäº¤æµç¾¤">
</a>

</p>

<!-- more -->



å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæ­£åœ¨all in [å„ç§AIé¡¹ç›®](https://mp.weixin.qq.com/s/XQhCrkbumDqtOZXuapMpVg)ï¼Œå…¨ç½‘åŒåã€‚


ï¼ˆ3 h ç›´æ’­ / å½•æ’­å¯æ‹† 2 æ¬¡ï¼‰

ç›®æ ‡  
â€¢ æŠŠâ€œç±»ä¹Ÿæ˜¯å¯¹è±¡â€è¿™å¥è¯ä»å£å·å˜æˆä»£ç   
â€¢ ä¼šç”¨å…ƒç±»åšã€Œè‡ªåŠ¨æ³¨å†Œã€å­—æ®µæ ¡éªŒã€API è‡ªåŠ¨ç”Ÿæˆã€ä¸‰ä»¶å®äº‹  
â€¢ å†™ä¸€ä¸ªå¯æ’æ‹”çš„æ’ä»¶æ¡†æ¶ï¼Œå¹¶æ‚„æ‚„æ¤å…¥ã€Œç¨‹åºå‘˜æ™šæ«ã€å½©è›‹

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.0 å¼€åœº 3 min  
â€œå†™å…ƒç±»ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œè€Œæ˜¯ä¸ºäº†å°‘å†™ 300 è¡Œæ ·æ¿ä»£ç ã€‚â€

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.1 æ¸©æ•…ï¼š`type` çš„ä¸‰å‚æ•°å½¢å¼ï¼ˆ10 minï¼‰  
ç°åœºæ¼”ç¤ºâ€œä¸€å¥è¯é€ è½¦â€ï¼š

```python
Dog = type('Dog', (object,), {'bark': lambda self: 'woof!'})
d = Dog()
print(d.bark())   # woof!
```

ç»“è®ºï¼šç±» = `type(name, bases, dict)` çš„è¿”å›å€¼ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.2 å…ƒç±» vs ç±»è£…é¥°å™¨ï¼šä½•æ—¶é€‰è°ï¼Ÿï¼ˆ10 minï¼‰  
| éœ€æ±‚                     | å…ƒç±» | ç±»è£…é¥°å™¨ |
|--------------------------|------|----------|
| æ§åˆ¶ç±»åˆ›å»ºè¿‡ç¨‹           | âœ…   | âŒ       |
| ä¿®æ”¹ç±»å±æ€§/æ–¹æ³•å        | âœ…   | âœ…       |
| å…¼å®¹å¤šé‡ç»§æ‰¿             | âœ…   | âš ï¸       |
| ä»£ç ç›´è§‚æ˜“è¯»             | âŒ   | âœ…       |

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.3 å®æˆ˜ 1ï¼šè‡ªåŠ¨æ³¨å†Œæ’ä»¶ç³»ç»Ÿï¼ˆ45 minï¼‰  
éœ€æ±‚ï¼šæ‰€æœ‰ç»§æ‰¿ `Plugin` çš„å­ç±»è‡ªåŠ¨åŠ å…¥å…¨å±€æ³¨å†Œè¡¨ï¼Œå¹¶æ‰“å°ã€Œç¨‹åºå‘˜æ™šæ«ã€æç¤ºã€‚

5.3.1 å…ƒç±»éª¨æ¶

```python
class PluginMeta(type):
    registry = {}

    def __new__(mcls, name, bases, ns, **kw):
        cls = super().__new__(mcls, name, bases, ns)
        if bases:  # æ’é™¤åŸºç±» Plugin è‡ªèº«
            key = ns.get('__plugin_name__') or name.lower()
            mcls.registry[key] = cls
            print(f"[ç¨‹åºå‘˜æ™šæ«] æ’ä»¶ {key!r} å·²è‡ªåŠ¨æ³¨å†Œ âœ”")
        return cls

class Plugin(metaclass=PluginMeta):
    def execute(self, data):
        raise NotImplementedError
```

5.3.2 ä½¿ç”¨ç¤ºä¾‹

```python
class EmailNotifier(Plugin):
    __plugin_name__ = 'email'

    def execute(self, data):
        print(f"[email] å‘é€ï¼š{data}")

class SmsNotifier(Plugin):
    def execute(self, data):
        print(f"[sms] å‘é€ï¼š{data}")

>>> Plugin.registry
{'email': <class '__main__.EmailNotifier'>,
 'sms'  : <class '__main__.SmsNotifier'>}
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.4 å®æˆ˜ 2ï¼šå­—æ®µæ ¡éªŒ 2.0ï¼ˆ30 minï¼‰  
æŠŠç¬¬ 4 è®²çš„æè¿°ç¬¦ ORM å‡çº§ä¸ºã€Œå…ƒç±»è‡ªåŠ¨æ³¨å…¥å­—æ®µåã€ã€‚

```python
class ModelMeta(type):
    def __new__(mcls, name, bases, ns):
        fields = {}
        for k, v in list(ns.items()):
            if isinstance(v, Field):
                v.name = k
                fields[k] = v
        ns['_fields'] = fields
        return super().__new__(mcls, name, bases, ns)

class Model(metaclass=ModelMeta):
    pass

class User(Model):
    name = StringField(max_length=16)
    age  = IntField()

>>> User._fields   # å…ƒç±»è‡ªåŠ¨æ”¶é›†
{'name': <StringField ...>, 'age': <IntField ...>}
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.5 å®æˆ˜ 3ï¼šè‡ªåŠ¨ç”Ÿæˆ REST è·¯ç”±ï¼ˆ25 minï¼‰  
éœ€æ±‚ï¼šåœ¨ç±»é‡Œå†™æ–¹æ³•ï¼Œå…ƒç±»è‡ªåŠ¨æŠŠ `/ç±»å/æ–¹æ³•å` æ³¨å†Œåˆ° Flaskã€‚

```python
from flask import Flask
app = Flask(__name__)

class RouterMeta(type):
    def __new__(mcls, name, bases, ns):
        cls = super().__new__(mcls, name, bases, ns)
        prefix = '/' + name.lower()
        for attr, value in ns.items():
            if callable(value) and not attr.startswith('_'):
                route = f"{prefix}/{attr}"
                app.route(route)(value)
                print(f"[ç¨‹åºå‘˜æ™šæ«] è‡ªåŠ¨ç”Ÿæˆè·¯ç”± {route!r}")
        return cls

class User(metaclass=RouterMeta):
    def list(self):
        return "ç”¨æˆ·åˆ—è¡¨"

    def detail(self, uid):
        return f"ç”¨æˆ· {uid}"

if __name__ == '__main__':
    app.run(debug=True)
```

æµè§ˆå™¨è®¿é—® `http://localhost:5000/user/list` å³å¯çœ‹åˆ°å“åº”ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.6 è°ƒè¯•æŠ€å·§ï¼šæŸ¥çœ‹ç±»åˆ›å»ºè¿‡ç¨‹ï¼ˆ10 minï¼‰  
â€¢ åœ¨ `__new__` / `__init__` æ‰“æ–­ç‚¹  
â€¢ `inspect.getmro()` è§‚å¯Ÿ MRO å˜åŒ–  
â€¢ `type.__subclasses__(Plugin)` æŸ¥çœ‹å·²æ³¨å†Œæ’ä»¶

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.7 å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µï¼ˆ10 minï¼‰  
1. é¿å…å¤šé‡å…ƒç±»å†²çª â†’ ä½¿ç”¨ `class MyMeta(type(Plugin))`  
2. å…ƒç±»è¿‡äºéšæ™¦ â†’ æä¾› `__repr__` æ–¹ä¾¿è°ƒè¯•  
3. ä¼˜å…ˆç±»è£…é¥°å™¨ â†’ é™¤éå¿…é¡»å¹²é¢„ç±»åˆ›å»º

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.8 ç»¼åˆæ¡ˆä¾‹ï¼šé…ç½®ä¸­å¿ƒè‡ªåŠ¨å¡«å……ï¼ˆ20 minï¼‰  
éœ€æ±‚ï¼šæ ¹æ® YAML æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ dataclassï¼Œå¹¶æ ¡éªŒç±»å‹ã€‚

```python
import yaml, typing

class ConfigMeta(type):
    def __new__(mcls, name, bases, ns):
        if 'yaml_file' in ns:
            with open(ns['yaml_file']) as f:
                data = yaml.safe_load(f)
            for k, v in data.items():
                hint = ns.get('__annotations__', {}).get(k)
                if hint and not isinstance(v, hint):
                    raise TypeError(f"ç¨‹åºå‘˜æ™šæ«æç¤ºï¼š{k} ç±»å‹é”™è¯¯")
                ns[k] = v
        return super().__new__(mcls, name, bases, ns)

class Settings(metaclass=ConfigMeta):
    yaml_file = 'settings.yaml'

print(Settings.db_host, Settings.db_port)
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.9 å°ç»“ & æ€ç»´å¯¼å›¾ï¼ˆ5 minï¼‰  
å…ƒç±»ä¸‰è¦ç´ ï¼š`__new__` â†’ ç±»å¯¹è±¡ â†’ åŠ¨æ€æ³¨å†Œ/æ ¡éªŒ/è·¯ç”±

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
5.10 è¯¾åä½œä¸š  
1. å¿…åšï¼šåœ¨æ’ä»¶æ³¨å†Œç³»ç»Ÿé‡ŒåŠ ã€Œç¨‹åºå‘˜æ™šæ«ã€ä¸“å± ASCII Logo æ‰“å°ã€‚  
2. é€‰åšï¼šå†™ä¸€ä¸ªå…ƒç±»ï¼Œè®©ç±»å±æ€§æ”¯æŒä¸­æ–‡æ–¹æ³•åè‡ªåŠ¨è½¬æ‹¼éŸ³è·¯ç”±ã€‚  
3. æŒ‘æˆ˜ï¼šé˜…è¯» Django ModelBase æºç ï¼Œåˆ—å‡º 2 ä¸ªå…ƒç±»é»‘ç§‘æŠ€ã€‚

æäº¤ï¼š  
â€¢ ä»£ç  push åˆ° `feat/lesson5`  
â€¢ GitHub Action è‡ªåŠ¨è¿è¡Œ `pytest && python -m flask routes`

ï¼ˆç¬¬ 5 è®²å®Œï¼‰

----

å¤§å®¶åœ¨å­¦ä¹ è¯¾ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿+å¾®ä¿¡å’Œæˆ‘äº¤æµğŸ‘‰[æˆ‘çš„è”ç³»æ–¹å¼ï¼šå¾®ä¿¡ã€è¯»è€…ç¾¤ã€1å¯¹1ã€ç¦åˆ©](http://www.python4office.cn/wechat-qrcode/)


![](https://cos.python-office.com/ads/gzh/sub-py.jpg)

![æ‰«ä¸€æ‰«ï¼Œé¢†çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/fad13012-c22f-4c3a-b56e-c70787a55699/172ca166340cd6d0f52d356402901d4f.jpg '6152d8017a3595256e51cbd9e08e148b.png')
  
![ç¾å›¢çº¢åŒ…](https://raw.atomgit.com/user-images/assets/5027920/6aa9a60e-bb4a-423c-a75d-cbd6ecf6f370/4dbea2fec93c415c75311666f19a1022.jpg '6d283319df13b09a3f74a9f19bf18a97.jpg')





ç¨‹åºå‘˜æ™šæ«ä¸“æ³¨AIç¼–ç¨‹åŸ¹è®­ï¼Œå°ç™½çœ‹å®Œä»–çš„æ•™ç¨‹[ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](https://mp.weixin.qq.com/s/M1jzQowv4Im2OYlvTJF7kg)å°±èƒ½ä¸Šæ‰‹åšAIé¡¹ç›®ã€‚