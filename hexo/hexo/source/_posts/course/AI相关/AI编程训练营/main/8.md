---
title: ç»™å°ç™½çš„ã€Š30è®²Â Â·Â AIç¼–ç¨‹è®­ç»ƒè¥ã€‹ç¬¬8è®²-
date: 2025-11-10 08:41:49
tags: [AIç¼–ç¨‹]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹AIç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>



<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AIç¼–ç¨‹-red" alt="AIç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AIäº¤æµç¾¤-brightgreen" alt="AIäº¤æµç¾¤">
</a>

</p>




<!-- more -->


å¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæ­£åœ¨all in [AIç¼–ç¨‹å®æˆ˜](https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg)ã€‚

# ç¬¬8è®²ï¼šä»£ç ç²¾è¿›ï¼šè°ƒè¯•ã€ä¼˜åŒ–ä¸ä¿æŠ¤ä½ çš„AIåº”ç”¨

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç¨‹åºå‘˜æ™šæ«ã€‚åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåˆ›å»ºå¹¶éƒ¨ç½²äº†åŠŸèƒ½å®Œæ•´çš„AIåº”ç”¨ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬è¦æ·±å…¥ä»£ç å±‚é¢ï¼Œå­¦ä¹ å¦‚ä½•è®©ä½ çš„åº”ç”¨è¿è¡Œå¾—æ›´**ç¨³å®š**ã€æ›´**é«˜æ•ˆ**ã€æ›´**å®‰å…¨**ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ä»£ç ä¼˜åŒ–ï¼Ÿ

åœ¨ç»´æŠ¤`python-office`é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†æ–°æ‰‹å¼€å‘è€…æœ€å¸¸è§çš„å‡ ä¸ªé—®é¢˜ï¼š

> "æ™šæ«ï¼Œæˆ‘çš„ç¨‹åºåœ¨æœ¬åœ°è¿è¡Œå¾ˆå¥½ï¼Œä½†éƒ¨ç½²åç»å¸¸å´©æºƒ..."
> "è½¬æ¢å¤§æ–‡ä»¶æ—¶ç¨‹åºå°±å¡æ­»ï¼Œæ€ä¹ˆåŠï¼Ÿ"
> "ç”¨æˆ·åé¦ˆè¯´æœ‰æ—¶å€™è½¬æ¢ç»“æœä¸å¯¹ï¼Œä½†æˆ‘ä¸ç¡®å®šå“ªé‡Œå‡ºäº†é—®é¢˜"

è¿™äº›é—®é¢˜çš„æ ¹æºå¾€å¾€åœ¨äºï¼š**ä»£ç ç¼ºä¹å¿…è¦çš„é”™è¯¯å¤„ç†ã€æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨ä¿æŠ¤**ã€‚

## æŠ€æœ¯è¦ç‚¹æ¦‚è§ˆ

ä»Šå¤©æˆ‘ä»¬å°†é‡ç‚¹å­¦ä¹ ï¼š
- ğŸ”§ **è°ƒè¯•æŠ€å·§**ï¼šå¿«é€Ÿå®šä½å’Œä¿®å¤é—®é¢˜
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šæå‡ç¨‹åºè¿è¡Œæ•ˆç‡  
- ğŸ›¡ï¸ **ä»£ç ä¿æŠ¤**ï¼šé˜²æ­¢åç¼–è¯‘å’Œæ¶æ„ä½¿ç”¨
- ğŸ“Š **ç›‘æ§å‘Šè­¦**ï¼šå®æ—¶æŒæ¡åº”ç”¨çŠ¶æ€

## å®æˆ˜ï¼šæ„å»ºå¥å£®çš„ç”Ÿäº§çº§ä»£ç 

### 1. æ™ºèƒ½é”™è¯¯å¤„ç†ç³»ç»Ÿ

è®©æˆ‘ä»¬ä¸ºä¹‹å‰çš„PDFè½¬æ¢å·¥å…·æ·»åŠ å®Œæ•´çš„é”™è¯¯å¤„ç†ï¼š

```python
import streamlit as st
import popdf
import office
import traceback
import logging
from datetime import datetime
from pathlib import Path

# é…ç½®æ—¥å¿—ç³»ç»Ÿ
def setup_logging():
    """é…ç½®å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ"""
    logger = logging.getLogger('office_tools')
    logger.setLevel(logging.INFO)
    
    # åˆ›å»ºæ—¥å¿—æ ¼å¼
    formatter = logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    )
    
    # æ–‡ä»¶å¤„ç†å™¨
    file_handler = logging.FileHandler('office_tools.log', encoding='utf-8')
    file_handler.setFormatter(formatter)
    
    # æ§åˆ¶å°å¤„ç†å™¨
    console_handler = logging.StreamHandler()
    console_handler.setFormatter(formatter)
    
    logger.addHandler(file_handler)
    logger.addHandler(console_handler)
    
    return logger

logger = setup_logging()

class OfficeToolsError(Exception):
    """è‡ªå®šä¹‰å¼‚å¸¸ç±»"""
    pass

class FileValidationError(OfficeToolsError):
    """æ–‡ä»¶éªŒè¯å¼‚å¸¸"""
    pass

class ConversionError(OfficeToolsError):
    """è½¬æ¢è¿‡ç¨‹å¼‚å¸¸"""
    pass

def validate_pdf_file(file_path):
    """éªŒè¯PDFæ–‡ä»¶æ˜¯å¦åˆæ³•"""
    try:
        if not Path(file_path).exists():
            raise FileValidationError("æ–‡ä»¶ä¸å­˜åœ¨")
        
        file_size = Path(file_path).stat().st_size
        if file_size == 0:
            raise FileValidationError("æ–‡ä»¶ä¸ºç©º")
        
        if file_size > 100 * 1024 * 1024:  # 100MBé™åˆ¶
            raise FileValidationError("æ–‡ä»¶å¤§å°è¶…è¿‡100MBé™åˆ¶")
        
        # ç®€å•çš„PDFæ–‡ä»¶å¤´éªŒè¯
        with open(file_path, 'rb') as f:
            header = f.read(4)
            if header != b'%PDF':
                raise FileValidationError("ä¸æ˜¯æœ‰æ•ˆçš„PDFæ–‡ä»¶")
                
        return True
        
    except Exception as e:
        logger.error(f"æ–‡ä»¶éªŒè¯å¤±è´¥: {str(e)}")
        raise FileValidationError(f"æ–‡ä»¶éªŒè¯å¤±è´¥: {str(e)}")

def safe_pdf_to_word_conversion(input_path, output_path):
    """
    å®‰å…¨çš„PDFè½¬Wordè½¬æ¢
    åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
    """
    start_time = datetime.now()
    logger.info(f"å¼€å§‹PDFè½¬æ¢: {input_path} -> {output_path}")
    
    try:
        # æ­¥éª¤1: è¾“å…¥éªŒè¯
        logger.info("æ­¥éª¤1: éªŒè¯è¾“å…¥æ–‡ä»¶")
        validate_pdf_file(input_path)
        
        # æ­¥éª¤2: æ£€æŸ¥è¾“å‡ºç›®å½•
        output_dir = Path(output_path).parent
        if not output_dir.exists():
            output_dir.mkdir(parents=True, exist_ok=True)
            logger.info(f"åˆ›å»ºè¾“å‡ºç›®å½•: {output_dir}")
        
        # æ­¥éª¤3: æ‰§è¡Œè½¬æ¢
        logger.info("æ­¥éª¤3: æ‰§è¡ŒPDFè½¬Wordè½¬æ¢")
        with st.spinner("PDFè½¬æ¢ä¸­ï¼Œè¯·ç¨å€™..."):
            popdf.pdf2docx(input_file=input_path, output_file=output_path)
        
        # æ­¥éª¤4: éªŒè¯è¾“å‡º
        if not Path(output_path).exists():
            raise ConversionError("è½¬æ¢å¤±è´¥ï¼šè¾“å‡ºæ–‡ä»¶æœªç”Ÿæˆ")
        
        file_size = Path(output_path).stat().st_size
        if file_size == 0:
            raise ConversionError("è½¬æ¢å¤±è´¥ï¼šè¾“å‡ºæ–‡ä»¶ä¸ºç©º")
        
        # è®°å½•æˆåŠŸä¿¡æ¯
        execution_time = (datetime.now() - start_time).total_seconds()
        logger.info(f"PDFè½¬æ¢æˆåŠŸ: è€—æ—¶{execution_time:.2f}ç§’, è¾“å‡ºå¤§å°: {file_size}å­—èŠ‚")
        
        return {
            "success": True,
            "output_path": output_path,
            "execution_time": execution_time,
            "output_size": file_size
        }
        
    except FileValidationError as e:
        error_msg = f"æ–‡ä»¶éªŒè¯é”™è¯¯: {str(e)}"
        logger.error(error_msg)
        return {
            "success": False,
            "error_type": "VALIDATION_ERROR",
            "error_message": error_msg
        }
        
    except ConversionError as e:
        error_msg = f"è½¬æ¢è¿‡ç¨‹é”™è¯¯: {str(e)}"
        logger.error(error_msg)
        return {
            "success": False,
            "error_type": "CONVERSION_ERROR", 
            "error_message": error_msg
        }
        
    except Exception as e:
        error_msg = f"æœªçŸ¥é”™è¯¯: {str(e)}"
        logger.error(f"æœªçŸ¥é”™è¯¯: {error_msg}\n{traceback.format_exc()}")
        return {
            "success": False,
            "error_type": "UNKNOWN_ERROR",
            "error_message": error_msg,
            "traceback": traceback.format_exc()
        }

def display_conversion_result(result):
    """æ˜¾ç¤ºè½¬æ¢ç»“æœ"""
    if result["success"]:
        st.success("ğŸ‰ è½¬æ¢æˆåŠŸï¼")
        
        col1, col2, col3 = st.columns(3)
        with col1:
            st.metric("è½¬æ¢çŠ¶æ€", "æˆåŠŸ")
        with col2:
            st.metric("å¤„ç†æ—¶é—´", f"{result['execution_time']:.2f}ç§’")
        with col3:
            st.metric("æ–‡ä»¶å¤§å°", f"{result['output_size'] / 1024:.2f} KB")
            
    else:
        st.error("âŒ è½¬æ¢å¤±è´¥")
        
        # æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒçš„å»ºè®®
        error_type = result["error_type"]
        error_message = result["error_message"]
        
        st.warning(f"é”™è¯¯ç±»å‹: {error_type}")
        st.info(f"é”™è¯¯ä¿¡æ¯: {error_message}")
        
        # æä¾›è§£å†³æ–¹æ¡ˆå»ºè®®
        if error_type == "VALIDATION_ERROR":
            st.markdown("""
            **å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š**
            - æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸå
            - ç¡®è®¤æ–‡ä»¶å¤§å°ä¸è¶…è¿‡100MB
            - é‡æ–°ä¸Šä¼ æ–‡ä»¶
            """)
        elif error_type == "CONVERSION_ERROR":
            st.markdown("""
            **å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š**
            - å°è¯•ä½¿ç”¨å…¶ä»–PDFæ–‡ä»¶
            - æ£€æŸ¥PDFæ–‡ä»¶æ˜¯å¦å—å¯†ç ä¿æŠ¤
            - è”ç³»æŠ€æœ¯æ”¯æŒ
            """)
        else:
            st.markdown("""
            **é‡åˆ°æœªçŸ¥é”™è¯¯ï¼Œè¯·ï¼š**
            - åˆ·æ–°é¡µé¢é‡è¯•
            - è”ç³»å¼€å‘äººå‘˜
            - æä¾›é”™è¯¯æˆªå›¾ä»¥ä¾¿æ’æŸ¥
            """)
```

### 2. æ€§èƒ½ä¼˜åŒ–å®æˆ˜

```python
import time
import psutil
import threading
from concurrent.futures import ThreadPoolExecutor
from functools import lru_cache

class PerformanceMonitor:
    """æ€§èƒ½ç›‘æ§å™¨"""
    
    def __init__(self):
        self.start_time = None
        self.memory_usage = []
        self.cpu_usage = []
    
    def start_monitoring(self):
        """å¼€å§‹ç›‘æ§"""
        self.start_time = time.time()
        self.memory_usage = []
        self.cpu_usage = []
        
        # å¯åŠ¨åå°ç›‘æ§çº¿ç¨‹
        monitor_thread = threading.Thread(target=self._monitor_resources)
        monitor_thread.daemon = True
        monitor_thread.start()
    
    def _monitor_resources(self):
        """ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ"""
        while self.start_time:
            self.memory_usage.append(psutil.virtual_memory().percent)
            self.cpu_usage.append(psutil.cpu_percent(interval=1))
            time.sleep(2)
    
    def stop_monitoring(self):
        """åœæ­¢ç›‘æ§å¹¶è¿”å›ç»“æœ"""
        if self.start_time:
            execution_time = time.time() - self.start_time
            self.start_time = None
            
            avg_memory = sum(self.memory_usage) / len(self.memory_usage) if self.memory_usage else 0
            avg_cpu = sum(self.cpu_usage) / len(self.cpu_usage) if self.cpu_usage else 0
            
            return {
                "execution_time": execution_time,
                "avg_memory_usage": avg_memory,
                "avg_cpu_usage": avg_cpu,
                "max_memory_usage": max(self.memory_usage) if self.memory_usage else 0,
                "max_cpu_usage": max(self.cpu_usage) if self.cpu_usage else 0
            }
        return {}

@lru_cache(maxsize=128)
def cached_pdf_conversion(file_hash, input_path, output_path):
    """
    å¸¦ç¼“å­˜çš„PDFè½¬æ¢
    ç›¸åŒæ–‡ä»¶å“ˆå¸Œçš„è½¬æ¢è¯·æ±‚ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ
    """
    # è¿™é‡Œå¯ä»¥é›†æˆåˆ°Redisç­‰åˆ†å¸ƒå¼ç¼“å­˜
    return safe_pdf_to_word_conversion(input_path, output_path)

def batch_file_processing(file_list, process_function, max_workers=3):
    """
    æ‰¹é‡æ–‡ä»¶å¤„ç†
    ä½¿ç”¨çº¿ç¨‹æ± æé«˜å¤„ç†æ•ˆç‡
    """
    results = []
    
    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        # æäº¤æ‰€æœ‰ä»»åŠ¡
        future_to_file = {
            executor.submit(process_function, file_data): file_data 
            for file_data in file_list
        }
        
        # æ”¶é›†ç»“æœ
        for future in future_to_file:
            try:
                result = future.result(timeout=300)  # 5åˆ†é’Ÿè¶…æ—¶
                results.append(result)
            except Exception as e:
                logger.error(f"æ‰¹é‡å¤„ç†å¤±è´¥: {str(e)}")
                results.append({
                    "success": False,
                    "error": str(e)
                })
    
    return results

def optimize_memory_usage():
    """å†…å­˜ä½¿ç”¨ä¼˜åŒ–"""
    import gc
    
    def memory_cleanup():
        """æ¸…ç†å†…å­˜"""
        gc.collect()
        
        # æ¸…ç†streamlitç¼“å­˜
        try:
            st.cache_data.clear()
            st.cache_resource.clear()
        except:
            pass
            
        current_memory = psutil.virtual_memory().percent
        logger.info(f"å†…å­˜æ¸…ç†å®Œæˆï¼Œå½“å‰ä½¿ç”¨ç‡: {current_memory}%")
    
    return memory_cleanup

# åœ¨Streamlitåº”ç”¨ä¸­ä½¿ç”¨æ€§èƒ½ä¼˜åŒ–
def optimized_pdf_tool():
    """ä¼˜åŒ–åçš„PDFå·¥å…·ç•Œé¢"""
    
    st.header("ğŸ“Š ä¼˜åŒ–ç‰ˆPDFè½¬æ¢å·¥å…·")
    
    # æ€§èƒ½ç›‘æ§
    monitor = PerformanceMonitor()
    
    uploaded_file = st.file_uploader("ä¸Šä¼ PDFæ–‡ä»¶", type=["pdf"])
    
    if uploaded_file is not None:
        # æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        file_size_mb = uploaded_file.size / (1024 * 1024)
        st.info(f"æ–‡ä»¶å¤§å°: {file_size_mb:.2f} MB")
        
        # æ ¹æ®æ–‡ä»¶å¤§å°é€‰æ‹©å¤„ç†ç­–ç•¥
        if file_size_mb > 50:
            st.warning("âš ï¸ æ–‡ä»¶è¾ƒå¤§ï¼Œè½¬æ¢å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´")
            max_workers = 1  # å¤§æ–‡ä»¶å•çº¿ç¨‹å¤„ç†
        else:
            max_workers = 3  # å°æ–‡ä»¶å¤šçº¿ç¨‹å¤„ç†
        
        if st.button("å¼€å§‹ä¼˜åŒ–è½¬æ¢"):
            # å¼€å§‹æ€§èƒ½ç›‘æ§
            monitor.start_monitoring()
            
            with st.spinner("ä¼˜åŒ–è½¬æ¢ä¸­..."):
                try:
                    # ä¿å­˜ä¸Šä¼ æ–‡ä»¶
                    with tempfile.NamedTemporaryFile(delete=False, suffix=".pdf") as tmp_file:
                        tmp_file.write(uploaded_file.getvalue())
                        input_path = tmp_file.name
                    
                    # ç”Ÿæˆè¾“å‡ºè·¯å¾„
                    output_filename = uploaded_file.name.replace(".pdf", "_converted.docx")
                    output_path = os.path.join(tempfile.gettempdir(), output_filename)
                    
                    # æ‰§è¡Œè½¬æ¢
                    result = safe_pdf_to_word_conversion(input_path, output_path)
                    
                    # åœæ­¢ç›‘æ§å¹¶æ˜¾ç¤ºæ€§èƒ½æ•°æ®
                    perf_data = monitor.stop_monitoring()
                    
                    # æ˜¾ç¤ºæ€§èƒ½æŒ‡æ ‡
                    if perf_data:
                        st.subheader("ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡")
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.metric("æ‰§è¡Œæ—¶é—´", f"{perf_data['execution_time']:.2f}ç§’")
                        with col2:
                            st.metric("å¹³å‡å†…å­˜", f"{perf_data['avg_memory_usage']:.1f}%")
                        with col3:
                            st.metric("å¹³å‡CPU", f"{perf_data['avg_cpu_usage']:.1f}%")
                    
                    # æ˜¾ç¤ºè½¬æ¢ç»“æœ
                    display_conversion_result(result)
                    
                    # æä¾›ä¸‹è½½
                    if result["success"]:
                        with open(output_path, "rb") as file:
                            st.download_button(
                                label="ä¸‹è½½è½¬æ¢åçš„Wordæ–‡æ¡£",
                                data=file,
                                file_name=output_filename,
                                mime="application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                            )
                    
                    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
                    cleanup = optimize_memory_usage()
                    cleanup()
                    
                except Exception as e:
                    logger.error(f"ä¼˜åŒ–è½¬æ¢å¤±è´¥: {str(e)}")
                    st.error(f"è½¬æ¢è¿‡ç¨‹å‡ºé”™: {str(e)}")
```

### 3. ä»£ç ä¿æŠ¤å’Œå®‰å…¨æ€§

```python
import hashlib
import hmac
import secrets
from datetime import datetime, timedelta

class SecurityManager:
    """å®‰å…¨ç®¡ç†å™¨"""
    
    def __init__(self, secret_key=None):
        self.secret_key = secret_key or secrets.token_hex(32)
        self.rate_limits = {}
    
    def generate_file_hash(self, file_data):
        """ç”Ÿæˆæ–‡ä»¶å“ˆå¸Œï¼Œç”¨äºç¼“å­˜å’ŒéªŒè¯"""
        return hashlib.sha256(file_data).hexdigest()
    
    def validate_api_key(self, api_key):
        """éªŒè¯APIå¯†é’¥"""
        # è¿™é‡Œå¯ä»¥é›†æˆåˆ°æ•°æ®åº“éªŒè¯
        valid_keys = ["office_tools_pro_2024", "python_office_vip"]
        return api_key in valid_keys
    
    def check_rate_limit(self, user_id, operation, limit=10, window_minutes=60):
        """æ£€æŸ¥APIé€Ÿç‡é™åˆ¶"""
        current_time = datetime.now()
        key = f"{user_id}_{operation}"
        
        if key not in self.rate_limits:
            self.rate_limits[key] = []
        
        # æ¸…ç†è¿‡æœŸçš„è¯·æ±‚è®°å½•
        self.rate_limits[key] = [
            req_time for req_time in self.rate_limits[key]
            if current_time - req_time < timedelta(minutes=window_minutes)
        ]
        
        # æ£€æŸ¥æ˜¯å¦è¶…è¿‡é™åˆ¶
        if len(self.rate_limits[key]) >= limit:
            return False
        
        # è®°å½•æœ¬æ¬¡è¯·æ±‚
        self.rate_limits[key].append(current_time)
        return True
    
    def sanitize_filename(self, filename):
        """æ–‡ä»¶åæ¶ˆæ¯’ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»"""
        # ç§»é™¤å±é™©å­—ç¬¦
        dangerous_chars = ['/', '\\', '..', '~']
        sanitized = filename
        for char in dangerous_chars:
            sanitized = sanitized.replace(char, '')
        
        # é™åˆ¶æ–‡ä»¶æ‰©å±•å
        allowed_extensions = ['.pdf', '.docx', '.xlsx', '.pptx', '.jpg', '.png']
        file_ext = Path(sanitized).suffix.lower()
        
        if file_ext not in allowed_extensions:
            raise SecurityError("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹")
        
        return sanitized

class SecurityError(Exception):
    """å®‰å…¨ç›¸å…³å¼‚å¸¸"""
    pass

def add_security_features():
    """ä¸ºStreamlitåº”ç”¨æ·»åŠ å®‰å…¨ç‰¹æ€§"""
    
    st.sidebar.markdown("---")
    st.sidebar.subheader("ğŸ”’ å®‰å…¨è®¾ç½®")
    
    # APIå¯†é’¥éªŒè¯ï¼ˆä¸“ä¸šç‰ˆåŠŸèƒ½ï¼‰
    api_key = st.sidebar.text_input("APIå¯†é’¥", type="password")
    security_mgr = SecurityManager()
    
    if api_key:
        if security_mgr.validate_api_key(api_key):
            st.sidebar.success("âœ… ä¸“ä¸šç‰ˆå·²æ¿€æ´»")
            # å¯ç”¨ä¸“ä¸šç‰ˆåŠŸèƒ½
            st.sidebar.info("""
            **ä¸“ä¸šç‰ˆç‰¹æƒï¼š**
            - æ— é™åˆ¶ä½¿ç”¨æ¬¡æ•°
            - ä¼˜å…ˆå¤„ç†é˜Ÿåˆ—
            - å¤§æ–‡ä»¶æ”¯æŒ
            - æ‰¹é‡å¤„ç†åŠŸèƒ½
            """)
        else:
            st.sidebar.error("âŒ æ— æ•ˆçš„APIå¯†é’¥")
    
    # ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼ˆå…è´¹ç‰ˆï¼‰
    user_id = "anonymous"  # å®é™…åº”ç”¨ä¸­å¯ä»¥ä»sessionæˆ–ç™»å½•ä¿¡æ¯è·å–
    if not security_mgr.check_rate_limit(user_id, "pdf_conversion", limit=5):
        st.error("""
        âš ï¸ **ä½¿ç”¨æ¬¡æ•°å·²è¾¾é™åˆ¶**
        
        å…è´¹ç‰ˆæ¯å°æ—¶æœ€å¤šä½¿ç”¨5æ¬¡PDFè½¬æ¢åŠŸèƒ½ã€‚
        
        **å‡çº§æ–¹æ¡ˆï¼š**
        - è·å–ä¸“ä¸šç‰ˆAPIå¯†é’¥è§£é™¤é™åˆ¶
        - ä¸€å°æ—¶åè‡ªåŠ¨æ¢å¤å…è´¹é¢åº¦
        - è”ç³»å®¢æœç”³è¯·æ›´å¤šé¢åº¦
        """)
        return False
    
    return True
```

### 4. å®Œæ•´çš„ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

```python
import smtplib
from email.mime.text import MimeText
from threading import Thread

class MonitoringSystem:
    """ç›‘æ§å‘Šè­¦ç³»ç»Ÿ"""
    
    def __init__(self):
        self.error_count = 0
        self.success_count = 0
        self.performance_data = []
    
    def record_success(self, operation, execution_time):
        """è®°å½•æˆåŠŸæ“ä½œ"""
        self.success_count += 1
        self.performance_data.append({
            "timestamp": datetime.now(),
            "operation": operation,
            "execution_time": execution_time,
            "status": "success"
        })
        logger.info(f"æ“ä½œæˆåŠŸ: {operation}, è€—æ—¶: {execution_time:.2f}ç§’")
    
    def record_error(self, operation, error_message):
        """è®°å½•é”™è¯¯å¹¶è§¦å‘å‘Šè­¦"""
        self.error_count += 1
        self.performance_data.append({
            "timestamp": datetime.now(),
            "operation": operation, 
            "error": error_message,
            "status": "error"
        })
        
        logger.error(f"æ“ä½œå¤±è´¥: {operation}, é”™è¯¯: {error_message}")
        
        # é”™è¯¯ç‡è¶…è¿‡é˜ˆå€¼æ—¶å‘é€å‘Šè­¦
        total_operations = self.success_count + self.error_count
        error_rate = self.error_count / total_operations if total_operations > 0 else 0
        
        if error_rate > 0.1:  # é”™è¯¯ç‡è¶…è¿‡10%
            self.send_alert(f"é«˜é”™è¯¯ç‡å‘Šè­¦: {error_rate:.1%}")
    
    def send_alert(self, message):
        """å‘é€å‘Šè­¦é€šçŸ¥"""
        def send_email_async():
            try:
                # é…ç½®é‚®ä»¶å‘é€ï¼ˆå®é™…ä½¿ç”¨æ—¶éœ€è¦é…ç½®SMTPï¼‰
                msg = MimeText(f"Office Toolså‘Šè­¦:\n\n{message}")
                msg['Subject'] = 'åº”ç”¨å‘Šè­¦é€šçŸ¥'
                msg['From'] = 'alerts@python-office.com'
                msg['To'] = 'admin@python-office.com'
                
                # è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…éœ€è¦é…ç½®SMTPæœåŠ¡å™¨
                logger.info(f"å‘Šè­¦é€šçŸ¥: {message}")
                
            except Exception as e:
                logger.error(f"å‘é€å‘Šè­¦å¤±è´¥: {str(e)}")
        
        # å¼‚æ­¥å‘é€å‘Šè­¦
        alert_thread = Thread(target=send_email_async)
        alert_thread.daemon = True
        alert_thread.start()
    
    def get_performance_report(self):
        """ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š"""
        if not self.performance_data:
            return "æš‚æ— æ€§èƒ½æ•°æ®"
        
        successful_ops = [p for p in self.performance_data if p["status"] == "success"]
        avg_time = sum(p["execution_time"] for p in successful_ops) / len(successful_ops) if successful_ops else 0
        
        report = f"""
        ## ğŸ“Š åº”ç”¨æ€§èƒ½æŠ¥å‘Š
        
        - **æ€»æ“ä½œæ•°**: {len(self.performance_data)}
        - **æˆåŠŸæ¬¡æ•°**: {self.success_count}
        - **å¤±è´¥æ¬¡æ•°**: {self.error_count}
        - **æˆåŠŸç‡**: {self.success_count/len(self.performance_data)*100:.1f}%
        - **å¹³å‡å¤„ç†æ—¶é—´**: {avg_time:.2f}ç§’
        - **å½“å‰é”™è¯¯ç‡**: {self.error_count/len(self.performance_data)*100:.1f}%
        """
        
        return report

# åˆå§‹åŒ–ç›‘æ§ç³»ç»Ÿ
monitor = MonitoringSystem()

def monitored_pdf_conversion(input_path, output_path):
    """å¸¦ç›‘æ§çš„PDFè½¬æ¢"""
    start_time = time.time()
    
    try:
        result = safe_pdf_to_word_conversion(input_path, output_path)
        execution_time = time.time() - start_time
        
        if result["success"]:
            monitor.record_success("pdf_conversion", execution_time)
        else:
            monitor.record_error("pdf_conversion", result["error_message"])
        
        return result
        
    except Exception as e:
        execution_time = time.time() - start_time
        monitor.record_error("pdf_conversion", str(e))
        raise
```

## åœ¨Streamlitåº”ç”¨ä¸­é›†æˆæ‰€æœ‰ä¼˜åŒ–

```python
def main():
    """ä¸»å‡½æ•° - é›†æˆæ‰€æœ‰ä¼˜åŒ–åŠŸèƒ½"""
    
    st.set_page_config(
        page_title="ä¼˜åŒ–ç‰ˆAIåŠå…¬å·¥å…· - ç¨‹åºå‘˜æ™šæ«",
        page_icon="ğŸš€",
        layout="wide"
    )
    
    # å®‰å…¨éªŒè¯
    if not add_security_features():
        return
    
    st.title("ğŸš€ ä¼˜åŒ–ç‰ˆAIåŠå…¬å·¥å…·å¤§å…¨")
    st.markdown("""
    **ç‰¹è‰²åŠŸèƒ½ï¼š**
    - ğŸ”§ æ™ºèƒ½é”™è¯¯å¤„ç†å’Œæ¢å¤
    - âš¡ æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§
    - ğŸ›¡ï¸ å®‰å…¨ä¿æŠ¤å’Œè®¿é—®æ§åˆ¶
    - ğŸ“Š å®æ—¶æ€§èƒ½æŒ‡æ ‡æ˜¾ç¤º
    """)
    
    # å·¥å…·é€‰æ‹©
    tool_option = st.selectbox(
        "é€‰æ‹©å·¥å…·",
        ["PDFè½¬Wordä¼˜åŒ–ç‰ˆ", "æ€§èƒ½ç›‘æ§é¢æ¿", "ç³»ç»ŸçŠ¶æ€"]
    )
    
    if tool_option == "PDFè½¬Wordä¼˜åŒ–ç‰ˆ":
        optimized_pdf_tool()
    
    elif tool_option == "æ€§èƒ½ç›‘æ§é¢æ¿":
        st.header("ğŸ“ˆ ç³»ç»Ÿæ€§èƒ½ç›‘æ§")
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader("å®æ—¶èµ„æºä½¿ç”¨")
            # æ˜¾ç¤ºå½“å‰ç³»ç»ŸçŠ¶æ€
            cpu_usage = psutil.cpu_percent()
            memory_usage = psutil.virtual_memory().percent
            
            st.metric("CPUä½¿ç”¨ç‡", f"{cpu_usage}%")
            st.metric("å†…å­˜ä½¿ç”¨ç‡", f"{memory_usage}%")
            
            # è¿›åº¦æ¡æ˜¾ç¤º
            st.progress(cpu_usage / 100, text="CPUä½¿ç”¨æƒ…å†µ")
            st.progress(memory_usage / 100, text="å†…å­˜ä½¿ç”¨æƒ…å†µ")
        
        with col2:
            st.subheader("åº”ç”¨æ€§èƒ½ç»Ÿè®¡")
            st.markdown(monitor.get_performance_report())
            
            # æ¸…ç†ç¼“å­˜æŒ‰é’®
            if st.button("æ¸…ç†ç³»ç»Ÿç¼“å­˜"):
                cleanup = optimize_memory_usage()
                cleanup()
                st.success("ç¼“å­˜æ¸…ç†å®Œæˆï¼")
    
    elif tool_option == "ç³»ç»ŸçŠ¶æ€":
        st.header("ğŸ–¥ï¸ ç³»ç»ŸçŠ¶æ€ä¿¡æ¯")
        
        # æ˜¾ç¤ºè¯¦ç»†ç³»ç»Ÿä¿¡æ¯
        st.subheader("è¿è¡Œç¯å¢ƒ")
        st.code(f"""
        Pythonç‰ˆæœ¬: {sys.version}
        å·¥ä½œç›®å½•: {os.getcwd()}
        ä¸´æ—¶ç›®å½•: {tempfile.gettempdir()}
        å½“å‰ç”¨æˆ·: {os.getenv('USER', 'Unknown')}
        """)
        
        st.subheader("é”™è¯¯æ—¥å¿—é¢„è§ˆ")
        if Path('office_tools.log').exists():
            with open('office_tools.log', 'r', encoding='utf-8') as f:
                logs = f.readlines()[-20:]  # æ˜¾ç¤ºæœ€å20è¡Œ
                st.text_area("æœ€è¿‘æ—¥å¿—", ''.join(logs), height=200)
        else:
            st.info("æš‚æ— æ—¥å¿—æ–‡ä»¶")

if __name__ == "__main__":
    main()
```

## å®æˆ˜ä½œä¸šï¼šä¼˜åŒ–ä½ çš„AIåº”ç”¨

**ä»»åŠ¡ï¼š** ä¸ºä½ çš„AIåŠå…¬å·¥å…·æ·»åŠ å®Œæ•´çš„ä¼˜åŒ–åŠŸèƒ½

**è¦æ±‚ï¼š**
1. å®ç°å®Œæ•´çš„é”™è¯¯å¤„ç†ç³»ç»Ÿ
2. æ·»åŠ æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
3. é›†æˆåŸºæœ¬çš„å®‰å…¨ä¿æŠ¤
4. è®¾ç½®ä½¿ç”¨é™åˆ¶å’Œå‘Šè­¦

**ä¼˜åŒ–æ£€æŸ¥æ¸…å•ï¼š**
- [ ] æ‰€æœ‰æ–‡ä»¶æ“ä½œéƒ½æœ‰é”™è¯¯å¤„ç†
- [ ] æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è®°å½•
- [ ] å®ç°äº†æ€§èƒ½ç›‘æ§
- [ ] è®¾ç½®äº†åˆç†çš„ä½¿ç”¨é™åˆ¶
- [ ] æ·»åŠ äº†å®‰å…¨éªŒè¯
- [ ] ä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨
- [ ] è®¾ç½®äº†å‘Šè­¦æœºåˆ¶

**è¿›é˜¶æŒ‘æˆ˜ï¼š**
- é›†æˆåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRedisï¼‰
- å®ç°æ•°æ®åº“æŒä¹…åŒ–å­˜å‚¨
- æ·»åŠ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- å®ç°è‡ªåŠ¨æ‰©ç¼©å®¹

## ç¨‹åºå‘˜æ™šæ«çš„ä¼˜åŒ–å¿ƒå¾—

åœ¨ä¼˜åŒ–`python-office`åŠå…¶ç›¸å…³é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ€»ç»“äº†å‡ ä¸ªå…³é”®åŸåˆ™ï¼š

1. **é¢„é˜²ä¼˜äºä¿®å¤**ï¼šåœ¨ç¼–ç é˜¶æ®µå°±è€ƒè™‘é”™è¯¯å¤„ç†
2. **ç›‘æ§é©±åŠ¨ä¼˜åŒ–**ï¼šæ²¡æœ‰ç›‘æ§å°±æ— æ³•ä¼˜åŒ–
3. **å®‰å…¨ä¸æ˜¯åŠŸèƒ½**ï¼šå®‰å…¨åº”è¯¥è´¯ç©¿æ•´ä¸ªå¼€å‘è¿‡ç¨‹
4. **ç”¨æˆ·ä½“éªŒè‡³ä¸Š**ï¼šä¼˜åŒ–åº”è¯¥è®©ç”¨æˆ·æ„Ÿå—åˆ°æ”¹è¿›

è®°ä½ï¼š**ä¼˜ç§€çš„ä»£ç ä¸æ˜¯æ²¡æœ‰bugï¼Œè€Œæ˜¯èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†bugã€‚**

## ä¸‹ä¸€è®²é¢„å‘Š

åœ¨ç¬¬9è®²ä¸­ï¼Œæˆ‘ä»¬å°†è¿›è¡Œç›´æ’­ä»£ç è¯„å®¡ï¼Œæˆ‘ä¼šäº²è‡ªç‚¹è¯„å¤§å®¶çš„é¡¹ç›®ä»£ç ï¼Œè§£å†³å®é™…å¼€å‘ä¸­é‡åˆ°çš„ç–‘éš¾é—®é¢˜ï¼

---

**æœ¬èŠ‚è¯¾çš„æ”¶è·ï¼š**
- æŒæ¡äº†å®Œæ•´çš„é”™è¯¯å¤„ç†æŠ€æœ¯
- å­¦ä¼šäº†æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–æ–¹æ³•
- äº†è§£äº†ä»£ç å®‰å…¨ä¿æŠ¤ç­–ç•¥
- èƒ½å¤Ÿæ„å»ºç”Ÿäº§çº§çš„å¥å£®åº”ç”¨

**è¯¾åä»»åŠ¡ï¼š**
1. ä¸ºä½ çš„åº”ç”¨æ·»åŠ é”™è¯¯å¤„ç†ç³»ç»Ÿ
2. å®ç°æ€§èƒ½ç›‘æ§åŠŸèƒ½
3. æäº¤ä»£ç åˆ°GitHubç­‰å¾…è¯„å®¡
4. åœ¨è¯¾ç¨‹ç¾¤åˆ†äº«ä½ çš„ä¼˜åŒ–ç»éªŒ

æˆ‘æ˜¯ç¨‹åºå‘˜æ™šæ«ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼

---

*æœ¬æ–‡æ¶‰åŠçš„ä¼˜åŒ–æŠ€æœ¯å·²åœ¨`python-office`ç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡åº”ç”¨ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚é‡åˆ°ä¼˜åŒ–é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯¾ç¨‹ç¾¤ä¸­äº¤æµè®¨è®ºã€‚*




## å…³äºè¯¾ç¨‹

æˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ï¼ŒæŠŠAIç¼–ç¨‹çš„çŸ¥è¯†åˆ†äº«ç»™ä½ ã€‚

å› ä¸ºå¯¹äºæˆ‘æ¥è¯´ï¼Œ[ç»™å°ç™½çš„ã€Š30è®²Â Â·Â AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg)æ˜¯æˆ‘èƒ½åŠ›èŒƒå›´å†…ï¼Œæœ€æœ‰æœºä¼šæŠ“ä½AIè¶‹åŠ¿çš„ä¸€å¥—è¯¾ã€‚

æ‰€ä»¥è¿™å¥—è¯¾çš„å†…å®¹ï¼Œåªä¼šæ¯”æˆ‘æ‰¿è¯ºçš„æ›´å¤šï¼Œä¸ä¼šæ›´å°‘ï¼›åªä¼šæ¯”ä½ é¢„æœŸçš„æ›´ç”¨å¿ƒï¼Œä¸ä¼šå‰²éŸ­èœã€‚

> åŒæ—¶ï¼Œæˆ‘ä¹Ÿæ¬¢è¿å¤§å®¶æ‰¾æˆ‘æ²Ÿé€šï¼Œæˆ‘ä¼šå°½åŠ›è§£ç­”ä½ çš„é—®é¢˜ã€‚

- è¯¾ç¨‹è¯¦ç»†ä»‹ç»ï¼Œè§ï¼š[ç»™å°ç™½çš„AIç¼–ç¨‹è®­ç»ƒè¥](https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg)


<p align="center" id='AIç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://www.python-office.com/course-002/AICoding/version-001/all.html'>
    <img src="https://raw.gitcode.com/user-images/assets/5027920/1f021b1e-f401-4afa-bfa5-f1b289d351a7/599.jpg" />
    </a>   
</p>




#### è”ç³»ä½œè€…

- å…³äºç¨‹åºå‘˜æ™šæ«ï¼Œè§ğŸ‘‰[æˆ‘åšåšä¸»çš„6å¹´](http://www.python4office.cn/wechat-group/)

- æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è”ç³»æˆ‘çš„å¾®ä¿¡ğŸ‘‰[python-office](http://www.python4office.cn/wechat-qrcode/)


ç¨‹åºå‘˜æ™šæ«ä¸“æ³¨AIç¼–ç¨‹åŸ¹è®­ï¼Œå°ç™½çœ‹å®Œä»–çš„æ•™ç¨‹[ã€Š30è®² Â· AIç¼–ç¨‹è®­ç»ƒè¥ã€‹](https://mp.weixin.qq.com/s/j8C-AsOGGM43vA0hXoCawg)å°±èƒ½ä¸Šæ‰‹åšAIé¡¹ç›®ã€‚