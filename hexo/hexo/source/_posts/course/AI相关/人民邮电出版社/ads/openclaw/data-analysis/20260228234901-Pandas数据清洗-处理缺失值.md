---
title: Pandas数据清洗：我总结了5种处理缺失值的策略，数据质量提升90%
date: 2026-02-28 23:49:00
tags: [数据分析, Pandas, 数据清洗, 缺失值]
---

<p align="center" id='扫码查看 AI 编程训练营'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/学习-AI 编程-red" alt="AI 编程">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/加入-AI 交流群-brightgreen" alt="AI 交流群">
</a>

</p>

<!-- more -->

大家好，我是正在实战各种<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AI项目</a>的程序员晚枫。

今天学习**数据清洗中最重要的话题——缺失值处理**。

真实世界的数据往往不完整，如何处理缺失值直接影响分析结果的准确性。我将分享5种常用策略，帮你应对各种场景。

---

## 认识缺失值

### 创建示例数据
```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    '姓名': ['张三', '李四', '王五', '赵六', '钱七'],
    '年龄': [25, np.nan, 30, np.nan, 35],
    '薪资': [15000, 12000, np.nan, 10000, np.nan],
    '部门': ['技术', '销售', '技术', np.nan, '销售'],
    '入职日期': pd.to_datetime(['2020-03-15', '2019-07-20', 
                           '2018-11-08', '2021-01-10', np.nan])
})

print(df)
```

### 检测缺失值
```python
# 判断是否为缺失值
print(df.isnull())

# 每列缺失值数量
print(df.isnull().sum())

# 每行缺失值数量
print(df.isnull().sum(axis=1))

# 缺失值比例
print(df.isnull().mean() * 100)

# 有缺失值的行
print(df[df.isnull().any(axis=1)])

# 完全没缺失值的行
print(df.dropna())
```

---

## 策略1：删除缺失值

适用场景：缺失值很少（<5%），且随机分布。

```python
# 删除包含任何缺失值的行
df_clean = df.dropna()

# 删除整行都是缺失值的行（通常没用）
df_clean = df.dropna(how='all')

# 删除某列有缺失值的行
df_clean = df.dropna(subset=['薪资'])

# 删除缺失值超过2个的行
df_clean = df.dropna(thresh=3)  # 至少要有3个非缺失值

# 删除缺失值过多的列（比如超过50%）
threshold = len(df) * 0.5
df_clean = df.dropna(axis=1, thresh=threshold)
```

**注意**：删除会丢失信息，谨慎使用！

---

## 策略2：填充固定值

适用场景：知道缺失值代表什么含义。

```python
# 填充0
df['薪资'].fillna(0, inplace=True)

# 填充字符串
df['部门'].fillna('未知', inplace=True)

# 填充特定值
df['年龄'].fillna(18, inplace=True)

# 不同列填充不同值
values = {'年龄': df['年龄'].median(), 
          '薪资': 0, 
          '部门': '未知'}
df.fillna(value=values, inplace=True)
```

---

## 策略3：统计值填充（最常用）

适用场景：数值型数据，缺失是随机的。

```python
# 均值填充
df['薪资'].fillna(df['薪资'].mean(), inplace=True)

# 中位数填充（对异常值更稳健）
df['年龄'].fillna(df['年龄'].median(), inplace=True)

# 众数填充（适合类别数据）
mode_dept = df['部门'].mode()[0]
df['部门'].fillna(mode_dept, inplace=True)

# 按组分填充（更精确）
# 用同部门的平均薪资填充
df['薪资'] = df.groupby('部门')['薪资'].transform(
    lambda x: x.fillna(x.mean())
)
```

---

## 策略4：前后值填充

适用场景：时间序列数据。

```python
# 前向填充（用前一个有效值）
df['销量'].fillna(method='ffill', inplace=True)

# 后向填充（用后一个有效值）
df['销量'].fillna(method='bfill', inplace=True)

# 限制填充次数（避免连锁填充）
df['销量'].fillna(method='ffill', limit=1, inplace=True)

# 先向前再向后
df['销量'].fillna(method='ffill', inplace=True)
df['销量'].fillna(method='bfill', inplace=True)
```

---

## 策略5：插值法

适用场景：数值有规律变化的数据。

```python
# 线性插值
df['温度'].interpolate(method='linear', inplace=True)

# 多项式插值
df['温度'].interpolate(method='polynomial', order=2, inplace=True)

# 时间序列插值
df.set_index('日期', inplace=True)
df['销量'].interpolate(method='time', inplace=True)
```

---

## 实战：完整清洗流程

```python
import pandas as pd
import numpy as np

# 原始数据
df = pd.DataFrame({
    '姓名': ['张三', '李四', '王五', '赵六', '钱七', '孙八'],
    '年龄': [25, np.nan, 30, 28, np.nan, 35],
    '薪资': [15000, 12000, np.nan, 10000, np.nan, 18000],
    '部门': ['技术', '销售', '技术', np.nan, '销售', '技术'],
    '工作年限': [2, np.nan, 5, 3, np.nan, 6]
})

print("原始缺失情况:")
print(df.isnull().sum())

# 步骤1：删除缺失严重的行（缺失超过3个）
df = df[df.isnull().sum(axis=1) <= 2]

# 步骤2：年龄用中位数填充
df['年龄'].fillna(df['年龄'].median(), inplace=True)

# 步骤3：薪资按部门均值填充
df['薪资'] = df.groupby('部门')['薪资'].transform(
    lambda x: x.fillna(x.mean())
)

# 步骤4：部门用众数填充
df['部门'].fillna(df['部门'].mode()[0], inplace=True)

# 步骤5：工作年限根据年龄估算（假设22岁毕业）
df['工作年限'].fillna(df['年龄'] - 22, inplace=True)

print("\n清洗后缺失情况:")
print(df.isnull().sum())
print("\n清洗后的数据:")
print(df)
```

---

## 最佳实践建议

### ✅ 应该做的
1. **先分析缺失模式**：是随机的还是有规律的？
2. **记录清洗过程**：保留原始数据，新建清洗后的列
3. **可视化检查**：用图表看缺失值分布
4. **对比验证**：填充前后统计指标的变化

### ❌ 不应该做的
1. **无脑删除**：可能丢失重要信息
2. **全部填0**：会扭曲数据分布
3. **不记录操作**：无法复现和审计
4. **忽视业务逻辑**：要结合实际情况选择策略

---

## 下节预告

下一课我们将学习**处理重复值**，继续数据清洗的旅程。

👉 **[继续阅读：Pandas数据清洗-处理重复值](/course/AI相关/人民邮电出版社/ads/openclaw/data-analysis/20260228235001-Pandas数据清洗-处理重复值/)**

---

## 💬 加入学习交流群

扫码加入**Python学习交流群**，和数千名同学一起进步：

👉 **[点击加入交流群](http://www.python4office.cn/wechat-group/)**

群里不定期分享：
- 数据分析实战案例
- Python学习资料
- 求职面试经验
- 行业最新动态

---

## 推荐：AI Python数据分析实战营

🎁 **限时福利**：送《利用Python进行数据分析》实体书

👉 **[点击了解详情](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## 课程导航

**上一篇：** [Pandas数据筛选与查询](/course/AI相关/人民邮电出版社/ads/openclaw/data-analysis/20260228234801-Pandas数据筛选与查询/)

**下一篇：** [Pandas数据清洗-处理重复值](/course/AI相关/人民邮电出版社/ads/openclaw/data-analysis/20260228235001-Pandas数据清洗-处理重复值/)

---

*PS：数据清洗占数据分析工作的70%。耐心处理好缺失值，后续分析才能准确。*
