---
title: Pandasåˆ†ç»„èšåˆï¼šæˆ‘ç”¨groupbyæŠŠ100ä¸‡è¡Œæ•°æ®ç§’å˜ç»Ÿè®¡æŠ¥è¡¨
date: 2026-03-01 00:01:00
tags: [æ•°æ®åˆ†æ, Pandas, groupby, èšåˆ, é€è§†è¡¨]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©å­¦ä¹ **Pandasæœ€å¼ºå¤§çš„åŠŸèƒ½â€”â€”groupbyåˆ†ç»„èšåˆ**ã€‚

æ— è®ºæ˜¯åšé”€å”®æŠ¥è¡¨ã€ç”¨æˆ·åˆ†æè¿˜æ˜¯è¿è¥ç»Ÿè®¡ï¼Œgroupbyéƒ½æ˜¯å¿…ä¸å¯å°‘çš„å·¥å…·ã€‚æŒæ¡å®ƒï¼Œä½ å°±èƒ½åƒå†™SQLä¸€æ ·çµæ´»åœ°åˆ†ææ•°æ®ã€‚

---

## åŸºç¡€è¯­æ³•

```python
import pandas as pd
import numpy as np

# ç¤ºä¾‹æ•°æ®
df = pd.DataFrame({
    'éƒ¨é—¨': ['æŠ€æœ¯', 'é”€å”®', 'æŠ€æœ¯', 'é”€å”®', 'äººäº‹', 'æŠ€æœ¯'],
    'å§“å': ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ', 'å­™å…«'],
    'é”€å”®é¢': [150000, 120000, 180000, 200000, 80000, 160000],
    'è®¢å•æ•°': [30, 25, 35, 40, 15, 32]
})

# åŸºç¡€åˆ†ç»„èšåˆ
dept_sales = df.groupby('éƒ¨é—¨')['é”€å”®é¢'].sum()
print(dept_sales)
```

---

## å¸¸ç”¨èšåˆå‡½æ•°

### å•å‡½æ•°èšåˆ
```python
# æ±‚å’Œ
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].sum()

# å¹³å‡å€¼
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].mean()

# è®¡æ•°
df.groupby('éƒ¨é—¨').size()  # åŒ…æ‹¬NaN
df.groupby('éƒ¨é—¨')['å§“å'].count()  # ä¸åŒ…æ‹¬NaN

# æœ€å€¼
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].max()
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].min()

# æ ‡å‡†å·®ã€æ–¹å·®
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].std()
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].var()
```

### å¤šå‡½æ•°agg
```python
# å¯¹å•åˆ—åº”ç”¨å¤šä¸ªå‡½æ•°
df.groupby('éƒ¨é—¨')['é”€å”®é¢'].agg(['sum', 'mean', 'count', 'max'])

# å¯¹ä¸åŒåˆ—åº”ç”¨ä¸åŒå‡½æ•°
df.groupby('éƒ¨é—¨').agg({
    'é”€å”®é¢': ['sum', 'mean'],
    'è®¢å•æ•°': ['sum', 'count']
})

# è‡ªå®šä¹‰åˆ—å
df.groupby('éƒ¨é—¨').agg(
    æ€»é”€å”®é¢=('é”€å”®é¢', 'sum'),
    å¹³å‡é”€å”®é¢=('é”€å”®é¢', 'mean'),
    æ€»è®¢å•=('è®¢å•æ•°', 'sum')
)
```

---

## å¤šåˆ—åˆ†ç»„

```python
# æŒ‰éƒ¨é—¨å’Œå¹´ä»½åˆ†ç»„ï¼ˆå‡è®¾æœ‰å¹´ä»½åˆ—ï¼‰
df.groupby(['éƒ¨é—¨', 'å¹´ä»½'])['é”€å”®é¢'].sum()

# å¤šçº§ç´¢å¼•ç»“æœ
result = df.groupby(['éƒ¨é—¨', 'å¹´ä»½']).agg({
    'é”€å”®é¢': 'sum',
    'è®¢å•æ•°': 'sum'
})

# é‡ç½®ç´¢å¼•å˜æˆæ™®é€šDataFrame
result = result.reset_index()
```

---

## transformï¼šä¿æŒåŸæ•°æ®ç»“æ„

```python
# è®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡è–ªèµ„
df['éƒ¨é—¨å¹³å‡'] = df.groupby('éƒ¨é—¨')['é”€å”®é¢'].transform('mean')

# è®¡ç®—ä¸ªäººä¸šç»©å éƒ¨é—¨æ¯”ä¾‹
df['å æ¯”'] = df['é”€å”®é¢'] / df['éƒ¨é—¨å¹³å‡']

# æ’åï¼ˆç»„å†…ï¼‰
df['éƒ¨é—¨æ’å'] = df.groupby('éƒ¨é—¨')['é”€å”®é¢'].rank(ascending=False)
```

---

## applyï¼šè‡ªå®šä¹‰å¤æ‚é€»è¾‘

```python
# å®šä¹‰è‡ªå®šä¹‰å‡½æ•°
def top_n(group, n=2):
    """è¿”å›æ¯ç»„å‰Nå"""
    return group.nlargest(n, 'é”€å”®é¢')

# åº”ç”¨
top_performers = df.groupby('éƒ¨é—¨').apply(top_n, n=2)

# lambdaç®€åŒ–
df.groupby('éƒ¨é—¨').apply(lambda x: x['é”€å”®é¢'].sum() / x['è®¢å•æ•°'].sum())
```

---

## è¿‡æ»¤ç­›é€‰

```python
# filterï¼šç­›é€‰æ»¡è¶³æ¡ä»¶çš„ç»„
# åªä¿ç•™æ€»é”€å”®é¢è¶…è¿‡30ä¸‡çš„éƒ¨é—¨
big_depts = df.groupby('éƒ¨é—¨').filter(
    lambda x: x['é”€å”®é¢'].sum() > 300000
)

# åªä¿ç•™äººæ•°å¤§äº2çš„éƒ¨é—¨
df.groupby('éƒ¨é—¨').filter(lambda x: len(x) > 2)
```

---

## æ•°æ®é€è§†è¡¨pivot_table

```python
# åˆ›å»ºæ›´å¤æ‚çš„ç¤ºä¾‹æ•°æ®
df = pd.DataFrame({
    'æ—¥æœŸ': ['2024-01', '2024-01', '2024-02', '2024-02'] * 3,
    'åœ°åŒº': ['åŒ—', 'å—', 'åŒ—', 'å—'] * 3,
    'äº§å“': ['A']*4 + ['B']*4 + ['C']*4,
    'é”€å”®é¢': [100, 150, 120, 180, 80, 120, 90, 140, 60, 90, 70, 110]
})

# ç®€å•é€è§†è¡¨
pivot = df.pivot_table(
    values='é”€å”®é¢',
    index='æ—¥æœŸ',
    columns='äº§å“',
    aggfunc='sum'
)

# å¤æ‚é€è§†è¡¨
pivot = df.pivot_table(
    values='é”€å”®é¢',
    index=['æ—¥æœŸ', 'åœ°åŒº'],
    columns='äº§å“',
    aggfunc={'é”€å”®é¢': ['sum', 'mean']},
    fill_value=0,
    margins=True,  # æ·»åŠ æ€»è®¡
    margins_name='åˆè®¡'
)
```

---

## å®æˆ˜ï¼šé”€å”®æ•°æ®åˆ†ææŠ¥è¡¨

```python
import pandas as pd

# æ¨¡æ‹Ÿé”€å”®æ•°æ®
sales = pd.DataFrame({
    'è®¢å•ID': range(1, 101),
    'æ—¥æœŸ': pd.date_range('2024-01-01', periods=100, freq='D'),
    'é”€å”®å‘˜': np.random.choice(['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­'], 100),
    'åœ°åŒº': np.random.choice(['ååŒ—', 'åä¸œ', 'åå—'], 100),
    'äº§å“': np.random.choice(['æ‰‹æœº', 'ç”µè„‘', 'å¹³æ¿'], 100),
    'æ•°é‡': np.random.randint(1, 10, 100),
    'å•ä»·': np.random.choice([2999, 5999, 3999], 100)
})

sales['é‡‘é¢'] = sales['æ•°é‡'] * sales['å•ä»·']

# ç”Ÿæˆå¤šç»´åº¦æŠ¥è¡¨
print("=== é”€å”®åˆ†ææŠ¥è¡¨ ===\n")

# 1. æŒ‰é”€å”®å‘˜ç»Ÿè®¡
print("ã€é”€å”®å‘˜ä¸šç»©TOP5ã€‘")
salesman_stats = sales.groupby('é”€å”®å‘˜').agg({
    'é‡‘é¢': 'sum',
    'è®¢å•ID': 'count'
}).rename(columns={'è®¢å•ID': 'è®¢å•æ•°'}).sort_values('é‡‘é¢', ascending=False)
print(salesman_stats)

# 2. æŒ‰åœ°åŒºç»Ÿè®¡
print("\nã€åœ°åŒºé”€å”®å¯¹æ¯”ã€‘")
region_stats = sales.groupby('åœ°åŒº')['é‡‘é¢'].agg(['sum', 'mean', 'count'])
region_stats['å æ¯”'] = region_stats['sum'] / region_stats['sum'].sum()
print(region_stats)

# 3. æŒ‰æœˆè¶‹åŠ¿
print("\nã€æœˆåº¦é”€å”®è¶‹åŠ¿ã€‘")
sales['æœˆä»½'] = sales['æ—¥æœŸ'].dt.to_period('M')
monthly = sales.groupby('æœˆä»½')['é‡‘é¢'].sum()
print(monthly)

# 4. äº§å“äº¤å‰åˆ†æ
print("\nã€åœ°åŒº-äº§å“äº¤å‰åˆ†æã€‘")
cross = pd.pivot_table(sales, values='é‡‘é¢', index='åœ°åŒº', 
                       columns='äº§å“', aggfunc='sum')
print(cross)
```

---

## æ€§èƒ½ä¼˜åŒ–æŠ€å·§

```python
# 1. åˆ†ç±»ç±»å‹åŠ é€Ÿ
df['éƒ¨é—¨'] = df['éƒ¨é—¨'].astype('category')

# 2. åªé€‰æ‹©éœ€è¦çš„åˆ—
df[['éƒ¨é—¨', 'é”€å”®é¢']].groupby('éƒ¨é—¨').sum()

# 3. ä½¿ç”¨numbaåŠ é€Ÿï¼ˆå¤æ‚è®¡ç®—ï¼‰
# import numba

# 4. åˆ†å—å¤„ç†å¤§æ•°æ®
for chunk in pd.read_csv('big.csv', chunksize=10000):
    result = chunk.groupby('key').sum()
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **æ—¶é—´åºåˆ—å¤„ç†**ï¼ŒæŒæ¡æ—¥æœŸæ—¶é—´æ•°æ®çš„åˆ†ææ–¹æ³•ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000201-Pandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-åˆå¹¶ä¸è¿æ¥](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235301-Pandasæ•°æ®å˜æ¢-åˆå¹¶ä¸è¿æ¥/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000201-Pandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†/)

---

*PSï¼šgroupbyæ˜¯Pandasçš„çµé­‚ã€‚ç†Ÿç»ƒæŒæ¡å®ƒï¼Œä½ å°±èƒ½åº”å¯¹90%çš„æ•°æ®ç»Ÿè®¡éœ€æ±‚ã€‚*
