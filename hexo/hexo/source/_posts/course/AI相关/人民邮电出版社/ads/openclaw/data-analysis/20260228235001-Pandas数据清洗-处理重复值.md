---
title: Pandasæ•°æ®æ¸…æ´—ï¼šæˆ‘ç”¨è¿™3ç§æ–¹æ³•ï¼Œ5ç§’æ‰¾å‡ºå¹¶æ¸…ç†æ‰€æœ‰é‡å¤æ•°æ®
date: 2026-02-28 23:50:00
tags: [æ•°æ®åˆ†æ, Pandas, æ•°æ®æ¸…æ´—, é‡å¤å€¼]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©ç»§ç»­æ•°æ®æ¸…æ´—çš„è¯é¢˜â€”â€”**å¤„ç†é‡å¤å€¼**ã€‚

é‡å¤æ•°æ®ä¼šå¯¼è‡´ç»Ÿè®¡ç»“æœå¤±çœŸï¼Œåœ¨åˆ†æå‰å¿…é¡»å¤„ç†ã€‚Pandasæä¾›äº†å¼ºå¤§çš„å·¥å…·ï¼Œè®©ä½ è½»æ¾æ‰¾å‡ºå¹¶æ¸…ç†é‡å¤é¡¹ã€‚

---

## åˆ›å»ºç¤ºä¾‹æ•°æ®

```python
import pandas as pd

df = pd.DataFrame({
    'å§“å': ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'å¼ ä¸‰', 'æå››', 'èµµå…­'],
    'å¹´é¾„': [25, 30, 35, 25, 30, 28],
    'åŸå¸‚': ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'åŒ—äº¬', 'ä¸Šæµ·', 'æ·±åœ³'],
    'è–ªèµ„': [15000, 20000, 18000, 15000, 22000, 16000]
})

print(df)
```

---

## æ£€æµ‹é‡å¤å€¼

### å®Œå…¨é‡å¤çš„è¡Œ
```python
# æ ‡è®°é‡å¤è¡Œï¼ˆä¿ç•™ç¬¬ä¸€ä¸ªï¼‰
print(df.duplicated())

# ç»Ÿè®¡é‡å¤è¡Œæ•°é‡
print(df.duplicated().sum())

# æŸ¥çœ‹é‡å¤çš„è¡Œ
duplicates = df[df.duplicated()]
print(duplicates)

# åŒ…æ‹¬æ‰€æœ‰é‡å¤ï¼ˆä¸åªæ˜¯åé¢çš„ï¼‰
all_duplicates = df[df.duplicated(keep=False)]
print(all_duplicates)
```

### åŸºäºç‰¹å®šåˆ—åˆ¤æ–­é‡å¤
```python
# åªçœ‹å§“åæ˜¯å¦é‡å¤
print(df.duplicated(subset=['å§“å']))

# çœ‹å§“å+å¹´é¾„ç»„åˆæ˜¯å¦é‡å¤
print(df.duplicated(subset=['å§“å', 'å¹´é¾„']))

# ç»Ÿè®¡æ¯ä¸ªå§“åçš„å‡ºç°æ¬¡æ•°
print(df['å§“å'].value_counts())
```

---

## åˆ é™¤é‡å¤å€¼

### æ–¹æ³•1ï¼šä¿ç•™ç¬¬ä¸€ä¸ªï¼ˆé»˜è®¤ï¼‰
```python
# åˆ é™¤å®Œå…¨é‡å¤çš„è¡Œï¼Œä¿ç•™ç¬¬ä¸€æ¬¡å‡ºç°çš„
df_clean = df.drop_duplicates()

# ç­‰ä»·äº
df_clean = df.drop_duplicates(keep='first')
```

### æ–¹æ³•2ï¼šä¿ç•™æœ€åä¸€ä¸ª
```python
# ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„ï¼Œåˆ é™¤å‰é¢çš„
df_clean = df.drop_duplicates(keep='last')
```

### æ–¹æ³•3ï¼šå…¨éƒ¨åˆ é™¤
```python
# åªè¦æœ‰é‡å¤å°±å…¨éƒ¨åˆ é™¤ï¼ˆä¸€ä¸ªä¸ç•™ï¼‰
df_clean = df.drop_duplicates(keep=False)
```

### åŸºäºç‰¹å®šåˆ—å»é‡
```python
# æŒ‰å§“åå»é‡ï¼ˆåªçœ‹å§“åï¼Œå…¶ä»–åˆ—ä¸ç®¡ï¼‰
df_clean = df.drop_duplicates(subset=['å§“å'])

# æŒ‰å¤šåˆ—ç»„åˆå»é‡
df_clean = df.drop_duplicates(subset=['å§“å', 'åŸå¸‚'])
```

---

## å®æˆ˜åœºæ™¯

### åœºæ™¯1ï¼šç”¨æˆ·æ³¨å†Œæ•°æ®å»é‡
```python
users = pd.DataFrame({
    'user_id': [1, 2, 3, 1, 4, 2],
    'username': ['alice', 'bob', 'charlie', 'alice', 'david', 'bob_new'],
    'email': ['alice@example.com', 'bob@example.com', 
              'charlie@example.com', 'alice@example.com',
              'david@example.com', 'bob2@example.com'],
    'register_time': ['2024-01-01', '2024-01-02', '2024-01-03',
                      '2024-01-05', '2024-01-06', '2024-01-07']
})

# æŒ‰user_idå»é‡ï¼Œä¿ç•™æœ€æ–°çš„è®°å½•
users['register_time'] = pd.to_datetime(users['register_time'])
users = users.sort_values('register_time')  # å…ˆæ’åº
users_clean = users.drop_duplicates(subset=['user_id'], keep='last')

print("å»é‡å:")
print(users_clean)
```

### åœºæ™¯2ï¼šè®¢å•æ•°æ®åˆå¹¶é‡å¤
```python
orders = pd.DataFrame({
    'order_id': ['A001', 'A002', 'A001', 'A003', 'A002'],
    'product': ['iPhone', 'iPad', 'iPhone', 'MacBook', 'iPad'],
    'quantity': [1, 2, 1, 1, 3],  # æ³¨æ„ï¼šA002çš„æ•°é‡ä¸åŒ
    'price': [6999, 4999, 6999, 9999, 4999]
})

# ç­–ç•¥1ï¼šç®€å•å»é‡ï¼ˆå¯èƒ½ä¸¢å¤±ä¿¡æ¯ï¼‰
orders_simple = orders.drop_duplicates(subset=['order_id'])

# ç­–ç•¥2ï¼šåˆå¹¶é‡å¤ï¼ˆç´¯åŠ æ•°é‡ï¼‰
orders_merged = orders.groupby(['order_id', 'product', 'price'])['quantity'].sum().reset_index()

print("åŸå§‹æ•°æ®:")
print(orders)
print("\nåˆå¹¶å:")
print(orders_merged)
```

---

## é«˜çº§æŠ€å·§

### æ ‡è®°é‡å¤ä½†ä¸åˆ é™¤
```python
# æ·»åŠ ä¸€åˆ—æ ‡è®°æ˜¯å¦é‡å¤
df['is_duplicate'] = df.duplicated(subset=['å§“å', 'å¹´é¾„'], keep=False)

# æŸ¥çœ‹é‡å¤ç»„çš„å¤§å°
df['dup_count'] = df.groupby(['å§“å', 'å¹´é¾„'])['å§“å'].transform('count')
```

### æŸ¥æ‰¾æœ€å®Œæ•´çš„è®°å½•
```python
# æœ‰æ—¶é‡å¤è¡Œçš„æŸäº›å­—æ®µæœ‰ç¼ºå¤±ï¼Œæƒ³ä¿ç•™æœ€å®Œæ•´çš„

# è®¡ç®—æ¯è¡Œéç©ºå€¼æ•°é‡
df['non_null_count'] = df.notnull().sum(axis=1)

# æŒ‰å§“ååˆ†ç»„ï¼Œä¿ç•™éç©ºå€¼æœ€å¤šçš„è¡Œ
df_clean = (df.sort_values('non_null_count', ascending=False)
              .drop_duplicates(subset=['å§“å'], keep='first'))
```

### æ¨¡ç³ŠåŒ¹é…å»é‡
```python
# å§“åå¯èƒ½æœ‰ç»†å¾®å·®åˆ«ï¼ˆå¦‚ç©ºæ ¼ã€å¤§å°å†™ï¼‰
df['å§“å_clean'] = df['å§“å'].str.strip().str.lower()
df_clean = df.drop_duplicates(subset=['å§“å_clean'])
```

---

## å®Œæ•´æ¸…æ´—æµç¨‹

```python
def clean_duplicates(df, subset=None, strategy='first'):
    """
    æ¸…æ´—é‡å¤å€¼çš„å®Œæ•´å‡½æ•°
    
    Parameters:
        df: DataFrame
        subset: ç”¨äºåˆ¤æ–­é‡å¤çš„åˆ—åˆ—è¡¨
        strategy: 'first', 'last', False(å…¨éƒ¨åˆ é™¤)
    
    Returns:
        æ¸…æ´—åçš„DataFrameå’ŒæŠ¥å‘Š
    """
    original_count = len(df)
    
    # æ£€æµ‹é‡å¤
    if subset:
        dup_mask = df.duplicated(subset=subset, keep=False)
    else:
        dup_mask = df.duplicated(keep=False)
    
    dup_count = dup_mask.sum()
    
    # åˆ é™¤é‡å¤
    df_clean = df.drop_duplicates(subset=subset, keep=strategy)
    
    # ç”ŸæˆæŠ¥å‘Š
    report = {
        'åŸå§‹è¡Œæ•°': original_count,
        'é‡å¤è¡Œæ•°': dup_count,
        'åˆ é™¤è¡Œæ•°': original_count - len(df_clean),
        'å‰©ä½™è¡Œæ•°': len(df_clean)
    }
    
    return df_clean, report

# ä½¿ç”¨
df_clean, report = clean_duplicates(df, subset=['å§“å', 'å¹´é¾„'], strategy='first')
print("æ¸…æ´—æŠ¥å‘Š:", report)
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **æ•°æ®ç±»å‹è½¬æ¢**ï¼ŒæŒæ¡å¦‚ä½•æ­£ç¡®å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandasæ•°æ®æ¸…æ´—-ç±»å‹è½¬æ¢ä¸å¼‚å¸¸å€¼å¤„ç†](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235101-Pandasæ•°æ®æ¸…æ´—-ç±»å‹è½¬æ¢ä¸å¼‚å¸¸å€¼å¤„ç†/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®æ¸…æ´—-å¤„ç†ç¼ºå¤±å€¼](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228234901-Pandasæ•°æ®æ¸…æ´—-å¤„ç†ç¼ºå¤±å€¼/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandasæ•°æ®æ¸…æ´—-ç±»å‹è½¬æ¢ä¸å¼‚å¸¸å€¼å¤„ç†](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235101-Pandasæ•°æ®æ¸…æ´—-ç±»å‹è½¬æ¢ä¸å¼‚å¸¸å€¼å¤„ç†/)

---

*PSï¼šé‡å¤å€¼å¤„ç†çœ‹ä¼¼ç®€å•ï¼Œä½†è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„ç­–ç•¥ã€‚å»ºè®®æ€»æ˜¯å…ˆå¤‡ä»½æ•°æ®å†æ“ä½œã€‚*
