---
title: Pandasæ•°æ®è¯»å–ä¸ä¿å­˜ï¼šæˆ‘æå®šäº†Excelã€CSVã€æ•°æ®åº“çš„æ‰€æœ‰æ“ä½œ
date: 2026-02-28 23:21:00
tags: [æ•°æ®åˆ†æ, Pandas, æ•°æ®å¯¼å…¥å¯¼å‡º, Excel]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©å­¦ä¹ **Pandasçš„æ•°æ®è¯»å†™åŠŸèƒ½**ã€‚

åœ¨å®é™…å·¥ä½œä¸­ï¼Œæ•°æ®å¯èƒ½æ¥è‡ªå„ç§åœ°æ–¹ï¼šExcelè¡¨æ ¼ã€CSVæ–‡ä»¶ã€æ•°æ®åº“ã€APIæ¥å£ã€‚æŒæ¡æ•°æ®çš„å¯¼å…¥å¯¼å‡ºï¼Œæ˜¯æ•°æ®åˆ†æçš„ç¬¬ä¸€æ­¥ã€‚

---

## è¯»å–CSVæ–‡ä»¶

CSVæ˜¯æœ€å¸¸è§çš„æ•°æ®æ ¼å¼ï¼Œçº¯æ–‡æœ¬ï¼Œå…¼å®¹æ€§å¥½ã€‚

### åŸºç¡€è¯»å–
```python
import pandas as pd

# è¯»å–CSV
df = pd.read_csv('data.csv')

# æŸ¥çœ‹å‰å‡ è¡Œ
print(df.head())
```

### å¸¸ç”¨å‚æ•°
```python
df = pd.read_csv('data.csv',
    encoding='utf-8',      # ç¼–ç æ ¼å¼
    sep=',',               # åˆ†éš”ç¬¦ï¼ˆé»˜è®¤é€—å·ï¼‰
    header=0,              # ç¬¬å‡ è¡Œä½œä¸ºåˆ—å
    index_col=0,           # å“ªåˆ—ä½œä¸ºç´¢å¼•
    usecols=['A', 'B', 'C'],  # åªè¯»å–æŒ‡å®šåˆ—
    nrows=1000,            # åªè¯»å‰1000è¡Œ
    skiprows=2,            # è·³è¿‡å‰2è¡Œ
    na_values=['NA', 'NULL', '-']  # è¯†åˆ«ä¸ºç¼ºå¤±å€¼çš„å­—ç¬¦ä¸²
)
```

### ä¸­æ–‡ç¼–ç é—®é¢˜
```python
# å¦‚æœä¸­æ–‡ä¹±ç ï¼Œå°è¯•ä¸åŒç¼–ç 
df = pd.read_csv('data.csv', encoding='gbk')      # å›½æ ‡ç¼–ç 
df = pd.read_csv('data.csv', encoding='utf-8-sig') # å¸¦BOMçš„UTF-8
df = pd.read_csv('data.csv', encoding='latin1')    # è¥¿æ¬§ç¼–ç 
```

---

## è¯»å–Excelæ–‡ä»¶

### å®‰è£…ä¾èµ–
```bash
pip install openpyxl xlrd
```

### åŸºç¡€è¯»å–
```python
# è¯»å–ç¬¬ä¸€ä¸ªsheet
df = pd.read_excel('data.xlsx')

# è¯»å–æŒ‡å®šsheet
df = pd.read_excel('data.xlsx', sheet_name='Sheet1')
df = pd.read_excel('data.xlsx', sheet_name=0)  # æŒ‰ç´¢å¼•

# è¯»å–å¤šä¸ªsheet
all_sheets = pd.read_excel('data.xlsx', sheet_name=None)
# è¿”å›å­—å…¸ï¼š{'Sheet1': df1, 'Sheet2': df2}
```

### å¸¸ç”¨å‚æ•°
```python
df = pd.read_excel('data.xlsx',
    sheet_name='é”€å”®æ•°æ®',
    header=0,              # åˆ—åæ‰€åœ¨è¡Œ
    skiprows=1,            # è·³è¿‡å¼€å¤´å‡ è¡Œ
    nrows=100,             # è¯»å–è¡Œæ•°
    usecols='A:C',         # è¯»å–Aåˆ°Cåˆ—
    usecols=[0, 1, 2],     # æŒ‰ç´¢å¼•é€‰åˆ—
    dtype={'åˆ—å': str}    # æŒ‡å®šåˆ—çš„æ•°æ®ç±»å‹
)
```

---

## ä¿å­˜æ•°æ®

### ä¿å­˜ä¸ºCSV
```python
# åŸºç¡€ä¿å­˜
df.to_csv('output.csv', index=False)  # index=Falseä¸ä¿å­˜è¡Œç´¢å¼•

# å®Œæ•´å‚æ•°
df.to_csv('output.csv',
    index=False,           # ä¸ä¿å­˜ç´¢å¼•
    encoding='utf-8-sig',  # å¸¦BOMï¼ŒExcelæ‰“å¼€ä¸ä¹±ç 
    sep=',',               # åˆ†éš”ç¬¦
    float_format='%.2f',   # æµ®ç‚¹æ•°æ ¼å¼
    columns=['A', 'B'],    # åªä¿å­˜æŒ‡å®šåˆ—
    mode='w'               # å†™å…¥æ¨¡å¼ï¼ˆ'a'è¿½åŠ ï¼‰
)
```

### ä¿å­˜ä¸ºExcel
```python
# åŸºç¡€ä¿å­˜
df.to_excel('output.xlsx', index=False)

# ä¿å­˜å¤šä¸ªsheet
with pd.ExcelWriter('output.xlsx') as writer:
    df1.to_excel(writer, sheet_name='Sheet1', index=False)
    df2.to_excel(writer, sheet_name='Sheet2', index=False)
    df3.to_excel(writer, sheet_name='Sheet3', index=False)
```

---

## è¯»å–å…¶ä»–æ ¼å¼

### JSON
```python
# è¯»å–JSON
df = pd.read_json('data.json')

# ä»å­—ç¬¦ä¸²è¯»å–
import json
with open('data.json', 'r') as f:
    data = json.load(f)
df = pd.json_normalize(data)  # å±•å¹³åµŒå¥—JSON
```

### SQLæ•°æ®åº“
```python
from sqlalchemy import create_engine

# åˆ›å»ºè¿æ¥
engine = create_engine('mysql+pymysql://user:password@host:port/database')

# è¯»å–SQL
df = pd.read_sql('SELECT * FROM table_name', engine)
df = pd.read_sql_table('table_name', engine)
df = pd.read_sql_query('SELECT * FROM table WHERE age > 18', engine)

# å†™å…¥SQL
df.to_sql('new_table', engine, if_exists='replace', index=False)
# if_exists: 'fail'(é»˜è®¤), 'replace', 'append'
```

### å¤§æ•°æ®åˆ†å—è¯»å–
```python
# å½“æ–‡ä»¶å¤ªå¤§ï¼Œå†…å­˜ä¸å¤Ÿæ—¶
chunks = pd.read_csv('big_file.csv', chunksize=10000)

for chunk in chunks:
    # å¤„ç†æ¯ä¸ªchunk
    process(chunk)
```

---

## å®æˆ˜ï¼šæ‰¹é‡å¤„ç†ExcelæŠ¥è¡¨

```python
import pandas as pd
import glob

# åˆå¹¶å¤šä¸ªExcelæ–‡ä»¶
all_files = glob.glob("sales/*.xlsx")

all_data = []
for file in all_files:
    # è¯»å–æ¯ä¸ªæ–‡ä»¶
    df = pd.read_excel(file)
    # æ·»åŠ æ–‡ä»¶åä½œä¸ºæ¥æºæ ‡è¯†
    df['æ¥æºæ–‡ä»¶'] = file
    all_data.append(df)

# åˆå¹¶æ‰€æœ‰æ•°æ®
combined = pd.concat(all_data, ignore_index=True)

# ç»Ÿè®¡æ¯æœˆé”€å”®é¢
monthly_sales = combined.groupby('æœˆä»½')['é”€å”®é¢'].sum()

# ä¿å­˜ç»“æœ
with pd.ExcelWriter('æ±‡æ€»æŠ¥å‘Š.xlsx') as writer:
    combined.to_excel(writer, sheet_name='åŸå§‹æ•°æ®', index=False)
    monthly_sales.to_excel(writer, sheet_name='æœˆåº¦æ±‡æ€»')

print(f"å¤„ç†äº†{len(all_files)}ä¸ªæ–‡ä»¶ï¼Œå…±{len(combined)}æ¡è®°å½•")
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **æ•°æ®ç­›é€‰ä¸æŸ¥è¯¢**ï¼Œè¿™æ˜¯æ•°æ®åˆ†æçš„æ ¸å¿ƒæŠ€èƒ½ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šæ•°æ®ç­›é€‰ä¸æŸ¥è¯¢](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228232201-æ•°æ®ç­›é€‰ä¸æŸ¥è¯¢/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandaså…¥é—¨-Serieså’ŒDataFrame](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228232001-Pandaså…¥é—¨-Serieså’ŒDataFrame/)

**ä¸‹ä¸€ç¯‡ï¼š** [æ•°æ®ç­›é€‰ä¸æŸ¥è¯¢](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228232201-æ•°æ®ç­›é€‰ä¸æŸ¥è¯¢/)

---

*PSï¼šæ•°æ®çš„å¯¼å…¥å¯¼å‡ºæ˜¯åˆ†æçš„ç¬¬ä¸€æ­¥ã€‚ç†Ÿç»ƒæŒæ¡è¿™äº›æ“ä½œï¼Œèƒ½å¸®ä½ èŠ‚çœå¤§é‡æ—¶é—´ã€‚*
