---
title: Pythonå®æˆ˜é¡¹ç›®ï¼šæˆ‘åšäº†ä¸ªå¤©æ°”æŸ¥è¯¢æœºå™¨äººï¼Œæ¯å¤©è‡ªåŠ¨æ¨é€å¤©æ°”æé†’
date: 2026-02-28 21:11:00
tags: [Pythonå®æˆ˜, API, å¤©æ°”, è‡ªåŠ¨åŒ–]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§AIé¡¹ç›®çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©ç¬¬ä¸‰ä¸ªå®æˆ˜é¡¹ç›®ï¼š**å¤©æ°”æŸ¥è¯¢æœºå™¨äºº**ã€‚

è¿™ä¸ªé¡¹ç›®ä¼šæ•™ä½ ï¼š
- å¦‚ä½•è°ƒç”¨ç¬¬ä¸‰æ–¹API
- å¦‚ä½•å¤„ç†JSONæ•°æ®
- å¦‚ä½•æ ¹æ®å¤©æ°”ç»™å‡ºå»ºè®®

---

## é¡¹ç›®åŠŸèƒ½

- æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”
- è·å–æœªæ¥3å¤©é¢„æŠ¥
- æ ¹æ®å¤©æ°”ç»™å‡ºç©¿è¡£ã€å‡ºè¡Œå»ºè®®
- å¯é›†æˆåˆ°å¾®ä¿¡/é’‰é’‰æœºå™¨äºº

---

## å‡†å¤‡å·¥ä½œ

éœ€è¦ä¸€ä¸ªå¤©æ°”APIã€‚æ¨èä½¿ç”¨ï¼š
- OpenWeatherMapï¼ˆå›½é™…ï¼‰
- å’Œé£å¤©æ°”ï¼ˆå›½å†…ï¼‰
- å¿ƒçŸ¥å¤©æ°”ï¼ˆå›½å†…ï¼‰

è¿™é‡Œä»¥OpenWeatherMapä¸ºä¾‹ï¼Œæ³¨å†Œåè·å–å…è´¹API Keyã€‚

---

## å®Œæ•´ä»£ç 

```python
import requests
import json
from datetime import datetime

class WeatherBot:
    def __init__(self, api_key):
        self.api_key = api_key
        self.base_url = "https://api.openweathermap.org/data/2.5"
    
    def get_weather(self, city):
        """è·å–å½“å‰å¤©æ°”"""
        url = f"{self.base_url}/weather"
        params = {
            'q': city,
            'appid': self.api_key,
            'units': 'metric',  # ä½¿ç”¨æ‘„æ°åº¦
            'lang': 'zh_cn'
        }
        
        try:
            response = requests.get(url, params=params)
            data = response.json()
            
            if response.status_code == 200:
                return self._parse_current_weather(data)
            else:
                return f"è·å–å¤©æ°”å¤±è´¥: {data.get('message', 'æœªçŸ¥é”™è¯¯')}"
                
        except Exception as e:
            return f"è¯·æ±‚å‡ºé”™: {e}"
    
    def get_forecast(self, city, days=3):
        """è·å–å¤©æ°”é¢„æŠ¥"""
        url = f"{self.base_url}/forecast"
        params = {
            'q': city,
            'appid': self.api_key,
            'units': 'metric',
            'lang': 'zh_cn'
        }
        
        try:
            response = requests.get(url, params=params)
            data = response.json()
            
            if response.status_code == 200:
                return self._parse_forecast(data, days)
            else:
                return f"è·å–é¢„æŠ¥å¤±è´¥: {data.get('message', 'æœªçŸ¥é”™è¯¯')}"
                
        except Exception as e:
            return f"è¯·æ±‚å‡ºé”™: {e}"
    
    def _parse_current_weather(self, data):
        """è§£æå½“å‰å¤©æ°”æ•°æ®"""
        city = data['name']
        temp = data['main']['temp']
        feels_like = data['main']['feels_like']
        humidity = data['main']['humidity']
        weather = data['weather'][0]['description']
        wind_speed = data['wind']['speed']
        
        report = f"""
ğŸŒ {city}å½“å‰å¤©æ°”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ¡ï¸ æ¸©åº¦: {temp}Â°C (ä½“æ„Ÿ{feels_like}Â°C)
â˜ï¸ å¤©æ°”: {weather}
ğŸ’§ æ¹¿åº¦: {humidity}%
ğŸ’¨ é£é€Ÿ: {wind_speed}m/s

ğŸ’¡ {self._get_advice(temp, weather)}
"""
        return report
    
    def _parse_forecast(self, data, days):
        """è§£æé¢„æŠ¥æ•°æ®"""
        city = data['city']['name']
        forecasts = []
        
        # æ¯8ä¸ªæ•°æ®ç‚¹ä»£è¡¨ä¸€å¤©ï¼ˆ3å°æ—¶é—´éš”ï¼‰
        for i in range(0, min(days * 8, len(data['list'])), 8):
            day_data = data['list'][i]
            date = datetime.fromtimestamp(day_data['dt']).strftime('%mæœˆ%dæ—¥')
            temp_max = day_data['main']['temp_max']
            temp_min = day_data['main']['temp_min']
            weather = day_data['weather'][0]['description']
            
            forecasts.append(f"ğŸ“… {date}: {temp_min}Â°C~{temp_max}Â°C, {weather}")
        
        return f"\nğŸŒ {city}æœªæ¥{days}å¤©é¢„æŠ¥\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n" + "\n".join(forecasts)
    
    def _get_advice(self, temp, weather):
        """æ ¹æ®å¤©æ°”ç»™å‡ºå»ºè®®"""
        advice = []
        
        # æ¸©åº¦å»ºè®®
        if temp < 5:
            advice.append("å¤©æ°”å¯’å†·ï¼Œè¯·ç©¿ç¾½ç»’æœ")
        elif temp < 15:
            advice.append("å¤©æ°”è¾ƒå‡‰ï¼Œå»ºè®®ç©¿å¤–å¥—")
        elif temp < 25:
            advice.append("æ¸©åº¦é€‚å®œï¼Œå¯ä»¥ç©¿é•¿è¢–")
        else:
            advice.append("å¤©æ°”ç‚çƒ­ï¼Œæ³¨æ„é˜²æš‘")
        
        # å¤©æ°”çŠ¶å†µå»ºè®®
        if 'é›¨' in weather or 'rain' in weather.lower():
            advice.append("æœ‰é›¨ï¼Œè®°å¾—å¸¦ä¼")
        if 'é›ª' in weather or 'snow' in weather.lower():
            advice.append("æœ‰é›ªï¼Œæ³¨æ„é˜²æ»‘")
        if 'æ™´' in weather or 'clear' in weather.lower():
            advice.append("å¤©æ°”æ™´æœ—ï¼Œé€‚åˆæˆ·å¤–æ´»åŠ¨")
        
        return " | ".join(advice) if advice else "å¤©æ°”ä¸é”™ï¼Œç¥ä½ æ„‰å¿«ï¼"

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # æ›¿æ¢ä¸ºä½ çš„API Key
    API_KEY = "your_api_key_here"
    
    bot = WeatherBot(API_KEY)
    
    # æŸ¥è¯¢å½“å‰å¤©æ°”
    print(bot.get_weather("Beijing"))
    
    print("\n" + "="*50 + "\n")
    
    # æŸ¥è¯¢é¢„æŠ¥
    print(bot.get_forecast("Beijing", days=3))
```

---

## ä»£ç è§£æ

### 1. requestsåº“
ç”¨äºå‘é€HTTPè¯·æ±‚ï¼Œæ˜¯Pythonæœ€æµè¡Œçš„HTTPåº“ã€‚

```bash
pip install requests
```

### 2. APIè°ƒç”¨æµç¨‹
1. æ„é€ URLå’Œå‚æ•°
2. å‘é€GETè¯·æ±‚
3. æ£€æŸ¥å“åº”çŠ¶æ€
4. è§£æJSONæ•°æ®
5. æ ¼å¼åŒ–è¾“å‡º

### 3. é”™è¯¯å¤„ç†
- ç½‘ç»œå¼‚å¸¸
- APIé™åˆ¶
- åŸå¸‚ä¸å­˜åœ¨

---

## è¿›é˜¶ï¼šé›†æˆåˆ°å¾®ä¿¡æœºå™¨äºº

```python
# å‡è®¾ä½ æœ‰ä¸€ä¸ªå¾®ä¿¡æœºå™¨äººæ¡†æ¶
def on_message(msg):
    if msg.startswith("å¤©æ°”"):
        city = msg.replace("å¤©æ°”", "").strip()
        if city:
            weather = bot.get_weather(city)
            send_reply(msg.sender, weather)
        else:
            send_reply(msg.sender, "è¯·è¾“å…¥åŸå¸‚åï¼Œå¦‚ï¼šå¤©æ°”åŒ—äº¬")
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€ç¯‡æ˜¯è¯¾ç¨‹æ€»ç»“å’Œå­¦ä¹ è·¯çº¿å›¾ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPythonå­¦ä¹ è·¯çº¿å›¾-ä»å…¥é—¨åˆ°ç²¾é€šçš„å®Œæ•´æŒ‡å—](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228211201-Pythonå­¦ä¹ è·¯çº¿å›¾-ä»å…¥é—¨åˆ°ç²¾é€šçš„å®Œæ•´æŒ‡å—/)**

---

## æ¨èï¼šAI Pythoné›¶åŸºç¡€å®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€ŠPythonç¼–ç¨‹ä»å…¥é—¨åˆ°å®è·µã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pythonå®æˆ˜é¡¹ç›®-è‡ªåŠ¨å‘é€é‚®ä»¶æŠ¥å‘Š](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228211001-Pythonå®æˆ˜é¡¹ç›®-è‡ªåŠ¨å‘é€é‚®ä»¶æŠ¥å‘Š/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pythonå­¦ä¹ è·¯çº¿å›¾-ä»å…¥é—¨åˆ°ç²¾é€šçš„å®Œæ•´æŒ‡å—](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228211201-Pythonå­¦ä¹ è·¯çº¿å›¾-ä»å…¥é—¨åˆ°ç²¾é€šçš„å®Œæ•´æŒ‡å—/)

---

*PSï¼šAPIè°ƒç”¨æ˜¯ç¼–ç¨‹çš„æ ¸å¿ƒæŠ€èƒ½ä¹‹ä¸€ã€‚æŒæ¡è¿™ä¸ªå¥—è·¯ï¼Œä½ å¯ä»¥æ¥å…¥ä»»ä½•ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚*
