---
title: Pandasæ•°æ®å˜æ¢ï¼šæˆ‘æ€»ç»“äº†mergeçš„5ç§ç”¨æ³•ï¼Œè½»æ¾æ•´åˆå¤šä¸ªæ•°æ®æº
date: 2026-02-28 23:53:00
tags: [æ•°æ®åˆ†æ, Pandas, merge, join, æ•°æ®åˆå¹¶]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©å­¦ä¹ **æ•°æ®åˆå¹¶ä¸è¿æ¥**ï¼Œè¿™æ˜¯æ•´åˆå¤šä¸ªæ•°æ®æºçš„æ ¸å¿ƒæŠ€èƒ½ã€‚

æ— è®ºæ˜¯å…³è”è®¢å•å’Œå®¢æˆ·ä¿¡æ¯ï¼Œè¿˜æ˜¯æ‹¼æ¥å¤šä¸ªæœˆä»½çš„æ•°æ®ï¼ŒæŒæ¡è¿™äº›æŠ€å·§éƒ½èƒ½è½»æ¾æå®šã€‚

---

## å‡†å¤‡ç¤ºä¾‹æ•°æ®

```python
import pandas as pd

# å‘˜å·¥è¡¨
employees = pd.DataFrame({
    'å‘˜å·¥ID': [1, 2, 3, 4, 5],
    'å§“å': ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ'],
    'éƒ¨é—¨ID': [101, 102, 101, 103, 102]
})

# éƒ¨é—¨è¡¨
departments = pd.DataFrame({
    'éƒ¨é—¨ID': [101, 102, 103, 104],
    'éƒ¨é—¨å': ['æŠ€æœ¯éƒ¨', 'é”€å”®éƒ¨', 'äººäº‹éƒ¨', 'è´¢åŠ¡éƒ¨'],
    'ç»ç†': ['å¼ ç»ç†', 'æç»ç†', 'ç‹ç»ç†', 'èµµç»ç†']
})

# å·¥èµ„è¡¨ï¼ˆéƒ¨åˆ†å‘˜å·¥ï¼‰
salaries = pd.DataFrame({
    'å‘˜å·¥ID': [1, 2, 3, 6],
    'åŸºæœ¬å·¥èµ„': [15000, 12000, 18000, 10000],
    'å¥–é‡‘': [3000, 2000, 4000, 1500]
})
```

---

## mergeï¼šæ•°æ®åº“é£æ ¼çš„è¿æ¥

### å†…è¿æ¥ï¼ˆInner Joinï¼‰
åªä¿ç•™ä¸¤ä¸ªè¡¨éƒ½æœ‰çš„é”®
```python
# å‘˜å·¥+éƒ¨é—¨ï¼ˆå†…è¿æ¥ï¼‰
result = pd.merge(employees, departments, on='éƒ¨é—¨ID', how='inner')
print(result)
# åªæœ‰éƒ¨é—¨IDåœ¨ä¸¤å¼ è¡¨ä¸­éƒ½å­˜åœ¨çš„è®°å½•
```

### å·¦è¿æ¥ï¼ˆLeft Joinï¼‰
ä¿ç•™å·¦è¡¨æ‰€æœ‰è®°å½•ï¼Œå³è¡¨æ²¡æœ‰åŒ¹é…çš„å¡«NaN
```python
# å‘˜å·¥+å·¥èµ„ï¼ˆå·¦è¿æ¥ï¼‰
result = pd.merge(employees, salaries, on='å‘˜å·¥ID', how='left')
print(result)
# æ‰€æœ‰å‘˜å·¥éƒ½æœ‰ï¼Œæ²¡å·¥èµ„ä¿¡æ¯çš„æ˜¾ç¤ºNaN
```

### å³è¿æ¥ï¼ˆRight Joinï¼‰
ä¿ç•™å³è¡¨æ‰€æœ‰è®°å½•
```python
result = pd.merge(employees, salaries, on='å‘˜å·¥ID', how='right')
# ä»¥å·¥èµ„è¡¨ä¸ºä¸»ï¼Œå‘˜å·¥è¡¨æ²¡æœ‰çš„æ˜¾ç¤ºNaN
```

### å¤–è¿æ¥ï¼ˆOuter Joinï¼‰
ä¿ç•™ä¸¤è¾¹æ‰€æœ‰è®°å½•
```python
result = pd.merge(employees, salaries, on='å‘˜å·¥ID', how='outer')
# æ‰€æœ‰å‘˜å·¥å’Œæ‰€æœ‰å·¥èµ„è®°å½•éƒ½ä¿ç•™
```

### è¿æ¥æ–¹å¼å¯¹æ¯”

| howå‚æ•° | ç»“æœè¯´æ˜ |
|---------|---------|
| inner | äº¤é›†ï¼Œåªä¿ç•™åŒ¹é…çš„è®°å½• |
| left | ä»¥å·¦è¡¨ä¸ºä¸»ï¼Œå³è¡¨è¡¥å…… |
| right | ä»¥å³è¡¨ä¸ºä¸»ï¼Œå·¦è¡¨è¡¥å…… |
| outer | å¹¶é›†ï¼Œä¿ç•™æ‰€æœ‰è®°å½• |

---

## å¤šé”®è¿æ¥

```python
# å½“è¿æ¥é”®åˆ—åä¸åŒæ—¶
left_df = pd.DataFrame({'A': [1, 2], 'B': ['a', 'b']})
right_df = pd.DataFrame({'C': [1, 2], 'D': ['x', 'y']})

result = pd.merge(left_df, right_df, left_on='A', right_on='C')

# å¤šåˆ—è¿æ¥
orders = pd.DataFrame({
    'å®¢æˆ·ID': [1, 1, 2],
    'æ—¥æœŸ': ['2024-01', '2024-02', '2024-01'],
    'é‡‘é¢': [100, 200, 150]
})

customers = pd.DataFrame({
    'å®¢æˆ·ID': [1, 2],
    'æ—¥æœŸ': ['2024-01', '2024-01'],
    'ç­‰çº§': ['VIP', 'æ™®é€š']
})

result = pd.merge(orders, customers, on=['å®¢æˆ·ID', 'æ—¥æœŸ'], how='left')
```

---

## concatï¼šè½´å‘è¿æ¥

### çºµå‘æ‹¼æ¥ï¼ˆå¢åŠ è¡Œï¼‰
```python
# å¤šä¸ªæœˆä»½çš„æ•°æ®æ‹¼æ¥
df_jan = pd.DataFrame({'äº§å“': ['A', 'B'], 'é”€é‡': [100, 200]})
df_feb = pd.DataFrame({'äº§å“': ['A', 'B'], 'é”€é‡': [120, 220]})
df_mar = pd.DataFrame({'äº§å“': ['A', 'B'], 'é”€é‡': [130, 210]})

# çºµå‘æ‹¼æ¥
quarter_data = pd.concat([df_jan, df_feb, df_mar], ignore_index=True)

# ä¿ç•™æ¥æºä¿¡æ¯
quarter_data = pd.concat([df_jan, df_feb, df_mar], 
                         keys=['1æœˆ', '2æœˆ', '3æœˆ'])
```

### æ¨ªå‘æ‹¼æ¥ï¼ˆå¢åŠ åˆ—ï¼‰
```python
df_info = pd.DataFrame({'ID': [1, 2], 'å§“å': ['å¼ ä¸‰', 'æå››']})
df_score = pd.DataFrame({'æ•°å­¦': [90, 85], 'è‹±è¯­': [88, 92]})

# æ¨ªå‘æ‹¼æ¥
df_full = pd.concat([df_info, df_score], axis=1)
```

---

## joinï¼šåŸºäºç´¢å¼•çš„è¿æ¥

```python
# è®¾ç½®ç´¢å¼•åä½¿ç”¨join
employees_idx = employees.set_index('å‘˜å·¥ID')
salaries_idx = salaries.set_index('å‘˜å·¥ID')

# å·¦è¿æ¥
result = employees_idx.join(salaries_idx, how='left')

# è¿æ¥å¤šä¸ªè¡¨
result = employees_idx.join([salaries_idx, other_table_idx])
```

---

## å®æˆ˜ï¼šå®Œæ•´çš„æ•°æ®æ•´åˆæµç¨‹

```python
# åœºæ™¯ï¼šæ•´åˆåˆ†æ•£åœ¨å¤šä¸ªè¡¨çš„é”€å”®æ•°æ®

# 1. è¯»å–å„è¡¨
orders = pd.read_csv('orders.csv')      # è®¢å•è¡¨
products = pd.read_csv('products.csv')  # äº§å“è¡¨
customers = pd.read_csv('customers.csv') # å®¢æˆ·è¡¨
regions = pd.read_csv('regions.csv')     # åœ°åŒºè¡¨

# 2. é€æ­¥åˆå¹¶
# è®¢å• + äº§å“ä¿¡æ¯
sales = pd.merge(orders, products, on='äº§å“ID', how='left')

# + å®¢æˆ·ä¿¡æ¯
sales = pd.merge(sales, customers, on='å®¢æˆ·ID', how='left')

# + åœ°åŒºä¿¡æ¯
sales = pd.merge(sales, regions, on='åœ°åŒºID', how='left')

# 3. è®¡ç®—å­—æ®µ
sales['æ€»é‡‘é¢'] = sales['å•ä»·'] * sales['æ•°é‡']
sales['åˆ©æ¶¦'] = sales['æ€»é‡‘é¢'] - sales['æˆæœ¬']

# 4. ä¿å­˜ç»“æœ
sales.to_csv('sales_report.csv', index=False)

print("æ•°æ®æ•´åˆå®Œæˆï¼")
print(f"æ€»è®°å½•æ•°: {len(sales)}")
print(f"æ€»é”€å”®é¢: {sales['æ€»é‡‘é¢'].sum():,.2f}")
```

---

## å¸¸è§é—®é¢˜ä¸è§£å†³

### é—®é¢˜1ï¼šé‡å¤åˆ—å
```python
# è‡ªåŠ¨æ·»åŠ åç¼€
result = pd.merge(df1, df2, on='key', suffixes=('_å·¦', '_å³'))
```

### é—®é¢˜2ï¼šæ•°æ®ç±»å‹ä¸åŒ¹é…
```python
# ç»Ÿä¸€ç±»å‹åå†åˆå¹¶
df1['ID'] = df1['ID'].astype(str)
df2['ID'] = df2['ID'].astype(str)
```

### é—®é¢˜3ï¼šå†…å­˜ä¸è¶³
```python
# åˆ†å—å¤„ç†
chunks = []
for chunk in pd.read_csv('large_file.csv', chunksize=10000):
    merged = pd.merge(chunk, lookup_table, on='key')
    chunks.append(merged)

result = pd.concat(chunks, ignore_index=True)
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **åˆ†ç»„èšåˆgroupby**ï¼Œè¿™æ˜¯æ•°æ®åˆ†ææœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235401-Pandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235201-Pandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235401-Pandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby/)

---

*PSï¼šæ•°æ®åˆå¹¶æ˜¯æ—¥å¸¸å·¥ä½œä¸­æœ€å¸¸è§çš„æ“ä½œã€‚ç†è§£ä¸åŒè¿æ¥æ–¹å¼çš„å·®å¼‚ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚*
