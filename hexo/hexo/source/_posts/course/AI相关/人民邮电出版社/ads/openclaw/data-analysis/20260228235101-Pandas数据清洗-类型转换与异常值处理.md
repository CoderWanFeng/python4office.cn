---
title: Pandasæ•°æ®æ¸…æ´—ï¼šæˆ‘æ€»ç»“äº†ç±»å‹è½¬æ¢çš„5ä¸ªå‘ï¼Œå¸®ä½ é¿å¼€90%çš„é”™è¯¯
date: 2026-02-28 23:51:00
tags: [æ•°æ®åˆ†æ, Pandas, æ•°æ®æ¸…æ´—, ç±»å‹è½¬æ¢]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©ç»§ç»­æ•°æ®æ¸…æ´—â€”â€”**ç±»å‹è½¬æ¢ä¸å¼‚å¸¸å€¼å¤„ç†**ã€‚

æ•°æ®ç±»å‹ä¸å¯¹ä¼šå¯¼è‡´è®¡ç®—é”™è¯¯ï¼Œå¼‚å¸¸å€¼ä¼šå½±å“ç»Ÿè®¡ç»“æœã€‚æŒæ¡è¿™äº›æŠ€å·§ï¼Œè®©ä½ çš„æ•°æ®è´¨é‡æ›´ä¸Šä¸€å±‚æ¥¼ã€‚

---

## å¸¸è§æ•°æ®ç±»å‹é—®é¢˜

```python
import pandas as pd

df = pd.DataFrame({
    'è®¢å•å·': ['A001', 'A002', 'A003'],
    'é‡‘é¢': ['1500.50', '2300', 'invalid'],  # å­—ç¬¦ä¸²è€Œéæ•°å€¼
    'æ—¥æœŸ': ['2024-01-15', '2024/02/20', 'æ— æ•ˆæ—¥æœŸ'],
    'æ•°é‡': [10, -5, 1000],  # æœ‰è´Ÿæ•°ï¼ˆå¼‚å¸¸ï¼‰
    'ç±»åˆ«': ['A', 'B', 'A']
})

print(df.dtypes)
```

---

## æ•°å€¼ç±»å‹è½¬æ¢

### å­—ç¬¦ä¸²è½¬æ•°å€¼
```python
# åŸºç¡€è½¬æ¢
df['é‡‘é¢_num'] = pd.to_numeric(df['é‡‘é¢'], errors='coerce')
# errors='coerce'ä¼šæŠŠæ— æ³•è½¬æ¢çš„å˜æˆNaN

# å¤„ç†åƒåˆ†ä½é€—å·
df['é‡‘é¢_clean'] = df['é‡‘é¢'].str.replace(',', '').astype(float)

# å¤„ç†è´§å¸ç¬¦å·
df['ä»·æ ¼'] = df['ä»·æ ¼'].str.replace('$', '').str.replace(',', '').astype(float)

# æ‰¹é‡è½¬æ¢å¤šåˆ—
numeric_cols = ['é‡‘é¢', 'æ•°é‡', 'å•ä»·']
for col in numeric_cols:
    df[col] = pd.to_numeric(df[col], errors='coerce')
```

### æ•´æ•° vs æµ®ç‚¹æ•°
```python
# floatè½¬intï¼ˆä¼šæˆªæ–­å°æ•°ï¼‰
df['é‡‘é¢_int'] = df['é‡‘é¢'].astype(int)  # 1500.50 â†’ 1500

# å››èˆäº”å…¥åè½¬int
df['é‡‘é¢_round'] = df['é‡‘é¢'].round().astype(int)

# ä½¿ç”¨Int64ï¼ˆæ”¯æŒç¼ºå¤±å€¼çš„æ•´æ•°ï¼‰
df['é‡‘é¢_Int64'] = df['é‡‘é¢'].astype('Int64')
```

---

## æ—¥æœŸæ—¶é—´è½¬æ¢

### åŸºç¡€è½¬æ¢
```python
# è‡ªåŠ¨è¯†åˆ«æ ¼å¼
df['æ—¥æœŸ_dt'] = pd.to_datetime(df['æ—¥æœŸ'], errors='coerce')

# æŒ‡å®šæ ¼å¼ï¼ˆæ›´å¿«ï¼‰
df['æ—¥æœŸ_dt'] = pd.to_datetime(df['æ—¥æœŸ'], format='%Y-%m-%d', errors='coerce')

# ä»å¤šä¸ªåˆ—ç»„åˆ
df['å®Œæ•´æ—¶é—´'] = pd.to_datetime(df[['å¹´', 'æœˆ', 'æ—¥']])
```

### æ—¶é—´æˆ³è½¬æ¢
```python
# Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰
df['æ—¥æœŸ'] = pd.to_datetime(df['timestamp'], unit='s')

# Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
df['æ—¥æœŸ'] = pd.to_datetime(df['timestamp'], unit='ms')
```

### æå–æ—¥æœŸç»„ä»¶
```python
df['å¹´'] = df['æ—¥æœŸ'].dt.year
df['æœˆ'] = df['æ—¥æœŸ'].dt.month
df['æ—¥'] = df['æ—¥æœŸ'].dt.day
df['æ˜ŸæœŸ'] = df['æ—¥æœŸ'].dt.dayofweek  # 0=å‘¨ä¸€
df['å­£åº¦'] = df['æ—¥æœŸ'].dt.quarter
df['æ˜¯å¦å‘¨æœ«'] = df['æ—¥æœŸ'].dt.dayofweek >= 5
```

---

## ç±»åˆ«å‹æ•°æ®ï¼ˆCategoryï¼‰

### ä¸ºä»€ä¹ˆç”¨Categoryï¼Ÿ
```python
# èŠ‚çœå†…å­˜
print(df['ç±»åˆ«'].memory_usage())  # æ™®é€šobject
df['ç±»åˆ«_cat'] = df['ç±»åˆ«'].astype('category')
print(df['ç±»åˆ«_cat'].memory_usage())  # å¤§å¹…å‡å°‘

# æé«˜æ€§èƒ½ï¼ˆåˆ†ç»„ã€ç­›é€‰æ›´å¿«ï¼‰
```

### æœ‰åºç±»åˆ«
```python
from pandas.api.types import CategoricalDtype

# å®šä¹‰ç­‰çº§é¡ºåº
grade_type = CategoricalDtype(
    categories=['C', 'B', 'A', 'S'], 
    ordered=True
)
df['ç­‰çº§'] = df['ç­‰çº§'].astype(grade_type)

# ç°åœ¨å¯ä»¥æ¯”è¾ƒå¤§å°
df[df['ç­‰çº§'] > 'B']  # é€‰å‡ºAå’ŒSçº§
```

---

## å¼‚å¸¸å€¼æ£€æµ‹ä¸å¤„ç†

### ç»Ÿè®¡æ–¹æ³•
```python
# Z-scoreæ–¹æ³•
from scipy import stats
import numpy as np

z_scores = np.abs(stats.zscore(df['é‡‘é¢']))
outliers = df[z_scores > 3]  # Z-scoreè¶…è¿‡3è®¤ä¸ºæ˜¯å¼‚å¸¸

# IQRæ–¹æ³•ï¼ˆå››åˆ†ä½è·ï¼‰
Q1 = df['é‡‘é¢'].quantile(0.25)
Q3 = df['é‡‘é¢'].quantile(0.75)
IQR = Q3 - Q1
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

outliers = df[(df['é‡‘é¢'] < lower_bound) | (df['é‡‘é¢'] > upper_bound)]
normal = df[(df['é‡‘é¢'] >= lower_bound) & (df['é‡‘é¢'] <= upper_bound)]
```

### ä¸šåŠ¡è§„åˆ™æ–¹æ³•
```python
# æ ¹æ®ä¸šåŠ¡çŸ¥è¯†åˆ¤æ–­
# å¹´é¾„åº”è¯¥åœ¨0-120ä¹‹é—´
df.loc[df['å¹´é¾„'] < 0, 'å¹´é¾„'] = np.nan
df.loc[df['å¹´é¾„'] > 120, 'å¹´é¾„'] = np.nan

# æŠ˜æ‰£ç‡åº”è¯¥åœ¨0-1ä¹‹é—´
df.loc[~df['æŠ˜æ‰£ç‡'].between(0, 1), 'æŠ˜æ‰£ç‡'] = np.nan

# æ ‡è®°å¼‚å¸¸
df['æ˜¯å¦å¼‚å¸¸'] = (
    (df['å¹´é¾„'] < 18) | 
    (df['æ¶ˆè´¹é‡‘é¢'] < 0) |
    (df['è®¢å•æ—¥æœŸ'] > pd.Timestamp.now())
)
```

### å¼‚å¸¸å€¼å¤„ç†ç­–ç•¥
```python
# ç­–ç•¥1ï¼šåˆ é™¤
df_clean = df[~df['æ˜¯å¦å¼‚å¸¸']]

# ç­–ç•¥2ï¼šæ›¿æ¢ä¸ºè¾¹ç•Œå€¼
df['é‡‘é¢'] = df['é‡‘é¢'].clip(lower=0, upper=100000)

# ç­–ç•¥3ï¼šç”¨ä¸­ä½æ•°å¡«å……
df.loc[df['æ˜¯å¦å¼‚å¸¸'], 'é‡‘é¢'] = df['é‡‘é¢'].median()

# ç­–ç•¥4ï¼šå•ç‹¬åˆ†æ
outliers_df = df[df['æ˜¯å¦å¼‚å¸¸']].copy()
print("å¼‚å¸¸è®¢å•éœ€è¦äººå·¥å®¡æ ¸:")
print(outliers_df)
```

---

## æ–‡æœ¬æ•°æ®å¤„ç†

### æ¸…ç†ç©ºç™½å­—ç¬¦
```python
df['å§“å'] = df['å§“å'].str.strip()  # å»é™¤é¦–å°¾ç©ºæ ¼
df['å§“å'] = df['å§“å'].str.replace('\s+', ' ', regex=True)  # å¤šä¸ªç©ºæ ¼å˜ä¸€ä¸ª
```

### ç»Ÿä¸€å¤§å°å†™
```python
df['é‚®ç®±'] = df['é‚®ç®±'].str.lower()  # é‚®ç®±ç»Ÿä¸€å°å†™
df['åŸå¸‚'] = df['åŸå¸‚'].str.title()   # é¦–å­—æ¯å¤§å†™
```

### æå–ä¿¡æ¯
```python
# æå–æ‰‹æœºå·å‰3ä½ï¼ˆè¿è¥å•†ï¼‰
df['è¿è¥å•†'] = df['æ‰‹æœºå·'].str[:3]

# æå–é‚®ç®±åŸŸå
df['é‚®ç®±åŸŸå'] = df['é‚®ç®±'].str.split('@').str[1]

# æå–å¹´ä»½
df['å…¥èŒå¹´ä»½'] = df['å…¥èŒæ—¥æœŸ'].str[:4]
```

---

## å®Œæ•´æ¸…æ´—æµç¨‹ç¤ºä¾‹

```python
def clean_dataframe(df):
    """å®Œæ•´çš„æ•°æ®æ¸…æ´—æµç¨‹"""
    
    # 1. å¤åˆ¶æ•°æ®é¿å…ä¿®æ”¹åŸæ•°æ®
    df = df.copy()
    
    # 2. å»é™¤å®Œå…¨é‡å¤è¡Œ
    df = df.drop_duplicates()
    
    # 3. å¤„ç†ç¼ºå¤±å€¼
    df = df.dropna(how='all')  # åˆ é™¤å…¨ç©ºè¡Œ
    
    # 4. ç±»å‹è½¬æ¢
    # æ•°å€¼åˆ—
    numeric_cols = ['é‡‘é¢', 'æ•°é‡', 'å•ä»·']
    for col in numeric_cols:
        if col in df.columns:
            df[col] = pd.to_numeric(df[col], errors='coerce')
    
    # æ—¥æœŸåˆ—
    if 'æ—¥æœŸ' in df.columns:
        df['æ—¥æœŸ'] = pd.to_datetime(df['æ—¥æœŸ'], errors='coerce')
    
    # ç±»åˆ«åˆ—
    if 'ç±»åˆ«' in df.columns:
        df['ç±»åˆ«'] = df['ç±»åˆ«'].astype('category')
    
    # 5. å¤„ç†å¼‚å¸¸å€¼
    # é‡‘é¢ä¸èƒ½ä¸ºè´Ÿ
    if 'é‡‘é¢' in df.columns:
        df.loc[df['é‡‘é¢'] < 0, 'é‡‘é¢'] = np.nan
    
    # 6. æ–‡æœ¬æ¸…ç†
    text_cols = df.select_dtypes(include=['object']).columns
    for col in text_cols:
        df[col] = df[col].str.strip()
    
    return df

# ä½¿ç”¨
df_clean = clean_dataframe(df)
print("æ¸…æ´—å®Œæˆï¼")
print(df_clean.info())
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **æ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ**ï¼ŒæŒæ¡å¦‚ä½•é‡å¡‘æ•°æ®ç»“æ„ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235201-Pandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®æ¸…æ´—-å¤„ç†é‡å¤å€¼](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235001-Pandasæ•°æ®æ¸…æ´—-å¤„ç†é‡å¤å€¼/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260228235201-Pandasæ•°æ®å˜æ¢-è¡Œåˆ—æ“ä½œ/)

---

*PSï¼šç±»å‹è½¬æ¢æ˜¯æ•°æ®æ¸…æ´—çš„å…³é”®æ­¥éª¤ã€‚è®°ä½ï¼šå…ˆæ£€æŸ¥å†è½¬æ¢ï¼Œerrors='coerce'æ˜¯å¥½å¸®æ‰‹ã€‚*
