---
title: Pandaså­—ç¬¦ä¸²å¤„ç†ï¼šæˆ‘ç”¨è¿™10ä¸ªæ–¹æ³•ï¼Œ5åˆ†é’Ÿæ¸…æ´—å®Œ messy çš„æ–‡æœ¬æ•°æ®
date: 2026-03-01 00:03:00
tags: [æ•°æ®åˆ†æ, Pandas, å­—ç¬¦ä¸²å¤„ç†, æ­£åˆ™è¡¨è¾¾å¼]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©å­¦ä¹ **Pandasä¸­çš„å­—ç¬¦ä¸²å¤„ç†**ï¼Œè¿™æ˜¯æ¸…æ´—æ–‡æœ¬æ•°æ®çš„å¿…å¤‡æŠ€èƒ½ã€‚

æ— è®ºæ˜¯å¤„ç†ç”¨æˆ·è¾“å…¥ã€è§£ææ—¥å¿—æ–‡ä»¶ï¼Œè¿˜æ˜¯æå–å…³é”®ä¿¡æ¯ï¼ŒæŒæ¡è¿™äº›æŠ€å·§éƒ½èƒ½è®©ä½ äº‹åŠåŠŸå€ã€‚

---

## .strè®¿é—®å™¨

Pandasä¸ºSeriesæä¾›äº†`.str`è®¿é—®å™¨ï¼Œå¯ä»¥åƒæ“ä½œPythonå­—ç¬¦ä¸²ä¸€æ ·å¤„ç†æ•´åˆ—æ•°æ®ã€‚

```python
import pandas as pd

df = pd.DataFrame({
    'å§“å': [' å¼ ä¸‰ ', 'æå››', 'ç‹äº”'],
    'é‚®ç®±': ['zhangsan@example.com', 'LiSi@test.COM', 'wangwu@company.cn'],
    'ç”µè¯': ['138-0013-8000', '13900138001', '137 0013 7000'],
    'åœ°å€': ['åŒ—äº¬å¸‚æœé˜³åŒº', 'ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº', 'å¹¿å·å¸‚å¤©æ²³åŒº']
})
```

---

## 1. å¤§å°å†™è½¬æ¢

```python
# è½¬å°å†™
df['é‚®ç®±_å°å†™'] = df['é‚®ç®±'].str.lower()

# è½¬å¤§å†™
df['é‚®ç®±_å¤§å†™'] = df['é‚®ç®±'].str.upper()

# é¦–å­—æ¯å¤§å†™
df['å§“å_è§„èŒƒ'] = df['å§“å'].str.title()
```

---

## 2. å»é™¤ç©ºç™½å­—ç¬¦

```python
# å»é™¤é¦–å°¾ç©ºæ ¼
df['å§“å_å»ç©ºæ ¼'] = df['å§“å'].str.strip()

# å»é™¤å·¦ä¾§ç©ºæ ¼
df['å§“å'] = df['å§“å'].str.lstrip()

# å»é™¤å³ä¾§ç©ºæ ¼
df['å§“å'] = df['å§“å'].str.rstrip()

# å»é™¤æ‰€æœ‰ç©ºæ ¼ï¼ˆåŒ…æ‹¬ä¸­é—´ï¼‰
df['ç”µè¯_çº¯æ•°å­—'] = df['ç”µè¯'].str.replace(' ', '').str.replace('-', '')
```

---

## 3. å­—ç¬¦ä¸²æ›¿æ¢

```python
# ç®€å•æ›¿æ¢
df['ç”µè¯_æ ‡å‡†'] = df['ç”µè¯'].str.replace('-', ' ')

# æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ï¼ˆåˆ é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦ï¼‰
df['ç”µè¯_æ•°å­—'] = df['ç”µè¯'].str.replace(r'\D', '', regex=True)

# å¤šå­—ç¬¦æ›¿æ¢
df['åœ°å€_ç®€å†™'] = df['åœ°å€'].str.replace('å¸‚', '').str.replace('åŒº', '')
```

---

## 4. åˆ†å‰²ä¸æå–

```python
# æŒ‰å­—ç¬¦åˆ†å‰²
df[['åŸå¸‚', 'åŒºå¿']] = df['åœ°å€'].str.split('å¸‚', expand=True)

# é™åˆ¶åˆ†å‰²æ¬¡æ•°
df['é‚®ç®±åŸŸå'] = df['é‚®ç®±'].str.split('@').str[1]

# æå–å­ä¸²ï¼ˆä½ç½®ï¼‰
df['åŒºå·'] = df['ç”µè¯_æ•°å­—'].str[:3]  # å‰3ä½

# æå–å­ä¸²ï¼ˆæ­£åˆ™ï¼‰
df['è¿è¥å•†'] = df['ç”µè¯_æ•°å­—'].str.extract(r'(1[38]\d)')
```

---

## 5. åŒ…å«ä¸åŒ¹é…

```python
# æ˜¯å¦åŒ…å«å­ä¸²
df['æ˜¯ç§»åŠ¨'] = df['ç”µè¯'].str.contains('138|139')

# ä»¥æŸå­—ç¬¦ä¸²å¼€å¤´
df['æ˜¯åŒ—äº¬'] = df['åœ°å€'].str.startswith('åŒ—äº¬')

# ä»¥æŸå­—ç¬¦ä¸²ç»“å°¾
df['æ˜¯comé‚®ç®±'] = df['é‚®ç®±'].str.endswith('.com')

# æ­£åˆ™åŒ¹é…
df['æœ‰æ•ˆé‚®ç®±'] = df['é‚®ç®±'].str.match(r'^[\w\.-]+@[\w\.-]+\.\w+$')
```

---

## 6. æŸ¥æ‰¾ä¸è®¡æ•°

```python
# æŸ¥æ‰¾ä½ç½®
df['@ä½ç½®'] = df['é‚®ç®±'].str.find('@')

# ç»Ÿè®¡å‡ºç°æ¬¡æ•°
df['eçš„æ•°é‡'] = df['é‚®ç®±'].str.count('e')

# è·å–é•¿åº¦
df['é‚®ç®±é•¿åº¦'] = df['é‚®ç®±'].str.len()
```

---

## 7. å¡«å……å¯¹é½

```python
# å·¦å¡«å……ï¼ˆè¡¥é½ä½æ•°ï¼‰
df['è®¢å•å·'] = df['è®¢å•å·'].str.zfill(8)  # 00001234

# å±…ä¸­
df['å§“å_å±…ä¸­'] = df['å§“å'].str.center(10, '*')

# å·¦å³å¡«å……
df['å§“å_å·¦å¯¹é½'] = df['å§“å'].str.ljust(10)
df['å§“å_å³å¯¹é½'] = df['å§“å'].str.rjust(10)
```

---

## 8. æ¡ä»¶ç­›é€‰

```python
# ç­›é€‰åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„è¡Œ
gmail_users = df[df['é‚®ç®±'].str.contains('gmail', na=False)]

# å¤šæ¡ä»¶ç­›é€‰
beijing_mobile = df[
    (df['åœ°å€'].str.contains('åŒ—äº¬')) & 
    (df['ç”µè¯'].str.contains('138'))
]
```

---

## 9. é«˜çº§æå–

```python
# æå–æ‰€æœ‰åŒ¹é…é¡¹
texts = pd.Series(['è®¢å•A123é‡‘é¢Â¥500', 'è®¢å•B456é‡‘é¢Â¥800'])
orders = texts.str.extractall(r'è®¢å•(\w+)é‡‘é¢Â¥(\d+)')

# å‘½åæ•è·ç»„
df[['ç”¨æˆ·å', 'åŸŸå']] = df['é‚®ç®±'].str.extract(r'(?P<user>[\w\.]+)@(?P<domain>[\w\.]+)')
```

---

## 10. å®æˆ˜ï¼š messy æ•°æ®æ¸…æ´—

```python
import pandas as pd
import re

# åŸå§‹ messy æ•°æ®
messy_data = pd.DataFrame({
    'å®¢æˆ·ä¿¡æ¯': [
        ' å¼ ä¸‰ | zhangsan@EXAMPLE.com | 138-0013-8000 | åŒ—äº¬ æœé˜³ ',
        'æå››,lisi@test.COM,13900138001,ä¸Šæµ·æµ¦ä¸œ',
        'ç‹äº” | wangwu@Company.cn | 137 0013 7000 | å¹¿å·-å¤©æ²³'
    ]
})

print("åŸå§‹æ•°æ®:")
print(messy_data)

def clean_customer_info(info):
    """æ¸…æ´—å®¢æˆ·ä¿¡æ¯"""
    # ç»Ÿä¸€åˆ†éš”ç¬¦ä¸ºç©ºæ ¼
    info = re.sub(r'[,|]', ' ', info)
    
    # åˆ†å‰²æˆåˆ—è¡¨
    parts = info.split()
    
    # æ¸…ç†æ¯ä¸ªéƒ¨åˆ†
    cleaned = []
    for part in parts:
        part = part.strip()
        if '@' in part:  # é‚®ç®±
            part = part.lower()
        elif part.replace('-', '').replace(' ', '').isdigit():  # ç”µè¯
            part = re.sub(r'\D', '', part)
        cleaned.append(part)
    
    return cleaned

# åº”ç”¨æ¸…æ´—
expanded = messy_data['å®¢æˆ·ä¿¡æ¯'].apply(clean_customer_info)
messy_data[['å§“å', 'é‚®ç®±', 'ç”µè¯', 'åœ°å€']] = pd.DataFrame(expanded.tolist())

print("\næ¸…æ´—å:")
print(messy_data[['å§“å', 'é‚®ç®±', 'ç”µè¯', 'åœ°å€']])
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **é«˜æ•ˆæ•°æ®å¤„ç†æŠ€å·§**ï¼ŒæŒæ¡ä¼˜åŒ–Pandasæ€§èƒ½çš„æ–¹æ³•ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandasé«˜æ•ˆæ•°æ®å¤„ç†æŠ€å·§](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000401-Pandasé«˜æ•ˆæ•°æ®å¤„ç†æŠ€å·§/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000201-Pandasæ•°æ®å˜æ¢-æ—¶é—´åºåˆ—å¤„ç†/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandasé«˜æ•ˆæ•°æ®å¤„ç†æŠ€å·§](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000401-Pandasé«˜æ•ˆæ•°æ®å¤„ç†æŠ€å·§/)

---

*PSï¼šæ–‡æœ¬æ•°æ®æ¸…æ´—å æ•°æ®åˆ†æå·¥ä½œçš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ç†Ÿç»ƒæŒæ¡.strè®¿é—®å™¨ï¼Œæ•ˆç‡æå‡10å€ã€‚*
