---
title: Pythonå®æˆ˜é¡¹ç›®ï¼šæˆ‘åšäº†ä¸ªè‡ªåŠ¨é‚®ä»¶ç³»ç»Ÿï¼Œæ¯å¤©å®šæ—¶å‘é€æ•°æ®æŠ¥å‘Š
date: 2026-02-28 21:10:00
tags: [Pythonå®æˆ˜, è‡ªåŠ¨åŒ–, é‚®ä»¶]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§AIé¡¹ç›®çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©ç¬¬äºŒä¸ªå®æˆ˜é¡¹ç›®ï¼š**è‡ªåŠ¨å‘é€é‚®ä»¶æŠ¥å‘Š**ã€‚

å¾ˆå¤šå·¥ä½œåœºæ™¯éœ€è¦å®šæœŸå‘é€æŠ¥å‘Šï¼šæ—¥æŠ¥ã€å‘¨æŠ¥ã€é”€å”®æ•°æ®ã€ç³»ç»ŸçŠ¶æ€ç­‰ã€‚ç”¨Pythonè‡ªåŠ¨åŒ–ï¼Œçœæ—¶çœåŠ›ã€‚

---

## é¡¹ç›®åŠŸèƒ½

- ç”Ÿæˆæ•°æ®æŠ¥å‘Šï¼ˆæ¨¡æ‹Ÿé”€å”®æ•°æ®ï¼‰
- åˆ›å»ºHTMLæ ¼å¼çš„é‚®ä»¶æ­£æ–‡
- æ·»åŠ é™„ä»¶ï¼ˆCSVæ–‡ä»¶ï¼‰
- æ”¯æŒå¤šä¸ªæ”¶ä»¶äºº
- å¯è®¾ç½®å®šæ—¶å‘é€

---

## å®Œæ•´ä»£ç 

```python
import smtplib
import csv
import io
from datetime import datetime, timedelta
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email import encoders

def generate_sales_data():
    """ç”Ÿæˆæ¨¡æ‹Ÿé”€å”®æ•°æ®"""
    data = []
    products = ['äº§å“A', 'äº§å“B', 'äº§å“C', 'äº§å“D']
    
    for i, product in enumerate(products):
        sales = {
            'product': product,
            'quantity': 100 + i * 50,
            'revenue': 5000 + i * 2500,
            'date': datetime.now().strftime('%Y-%m-%d')
        }
        data.append(sales)
    
    return data

def create_csv_attachment(data):
    """å°†æ•°æ®è½¬æ¢ä¸ºCSVæ ¼å¼"""
    output = io.StringIO()
    writer = csv.DictWriter(output, fieldnames=['product', 'quantity', 'revenue', 'date'])
    writer.writeheader()
    writer.writerows(data)
    return output.getvalue()

def create_email_content(data):
    """åˆ›å»ºHTMLé‚®ä»¶å†…å®¹"""
    total_revenue = sum(item['revenue'] for item in data)
    total_quantity = sum(item['quantity'] for item in data)
    
    html = f"""
    <html>
    <head>
        <style>
            body {{ font-family: Arial, sans-serif; }}
            table {{ border-collapse: collapse; width: 100%; }}
            th, td {{ border: 1px solid #ddd; padding: 8px; text-align: left; }}
            th {{ background-color: #4CAF50; color: white; }}
            .summary {{ background-color: #f2f2f2; padding: 15px; margin: 20px 0; }}
        </style>
    </head>
    <body>
        <h2>æ¯æ—¥é”€å”®æŠ¥å‘Š</h2>
        <p>æ—¥æœŸ: {datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥')}</p>
        
        <div class="summary">
            <h3>æ±‡æ€»æ•°æ®</h3>
            <p><strong>æ€»é”€å”®é¢:</strong> Â¥{total_revenue:,}</p>
            <p><strong>æ€»é”€é‡:</strong> {total_quantity}ä»¶</p>
        </div>
        
        <h3>è¯¦ç»†æ•°æ®</h3>
        <table>
            <tr>
                <th>äº§å“</th>
                <th>é”€é‡</th>
                <th>é”€å”®é¢</th>
            </tr>
    """
    
    for item in data:
        html += f"""
            <tr>
                <td>{item['product']}</td>
                <td>{item['quantity']}</td>
                <td>Â¥{item['revenue']:,}</td>
            </tr>
        """
    
    html += """
        </table>
        <p style="color: #666; margin-top: 30px;">
            æ­¤é‚®ä»¶ç”±ç³»ç»Ÿè‡ªåŠ¨å‘é€ï¼Œè¯·å‹¿å›å¤ã€‚
        </p>
    </body>
    </html>
    """
    
    return html

def send_report(sender_email, sender_password, recipient_emails):
    """å‘é€é‚®ä»¶æŠ¥å‘Š"""
    
    # ç”Ÿæˆæ•°æ®
    data = generate_sales_data()
    
    # åˆ›å»ºé‚®ä»¶
    msg = MIMEMultipart()
    msg['From'] = sender_email
    msg['To'] = ', '.join(recipient_emails)
    msg['Subject'] = f'é”€å”®æ—¥æŠ¥ - {datetime.now().strftime("%Y-%m-%d")}'
    
    # æ·»åŠ HTMLå†…å®¹
    html_content = create_email_content(data)
    msg.attach(MIMEText(html_content, 'html', 'utf-8'))
    
    # æ·»åŠ CSVé™„ä»¶
    csv_data = create_csv_attachment(data)
    attachment = MIMEBase('application', 'octet-stream')
    attachment.set_payload(csv_data.encode('utf-8'))
    encoders.encode_base64(attachment)
    attachment.add_header(
        'Content-Disposition',
        f'attachment; filename="sales_report_{datetime.now().strftime("%Y%m%d")}.csv"'
    )
    msg.attach(attachment)
    
    # å‘é€é‚®ä»¶
    try:
        server = smtplib.SMTP('smtp.gmail.com', 587)
        server.starttls()
        server.login(sender_email, sender_password)
        server.send_message(msg)
        server.quit()
        print("é‚®ä»¶å‘é€æˆåŠŸï¼")
    except Exception as e:
        print(f"å‘é€å¤±è´¥: {e}")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # é…ç½®ä½ çš„é‚®ç®±ä¿¡æ¯
    SENDER_EMAIL = "your_email@gmail.com"
    SENDER_PASSWORD = "your_app_password"  # ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 
    RECIPIENTS = ["boss@company.com", "manager@company.com"]
    
    send_report(SENDER_EMAIL, SENDER_PASSWORD, RECIPIENTS)
```

---

## ä»£ç è§£æ

### 1. é‚®ä»¶åè®®
- **SMTP**ï¼šç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼Œç”¨äºå‘é€é‚®ä»¶
- **MIME**ï¼šå¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ï¼Œæ”¯æŒHTMLå’Œé™„ä»¶

### 2. å¸¸ç”¨é‚®ç®±SMTPè®¾ç½®

| é‚®ç®± | SMTPæœåŠ¡å™¨ | ç«¯å£ |
|-----|-----------|------|
| Gmail | smtp.gmail.com | 587 |
| QQé‚®ç®± | smtp.qq.com | 587 |
| 163é‚®ç®± | smtp.163.com | 25 |
| Outlook | smtp.office365.com | 587 |

### 3. å®‰å…¨æ³¨æ„äº‹é¡¹
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 
- ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶
- å¼€å¯ä¸¤æ­¥éªŒè¯åä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 

---

## è¿›é˜¶ï¼šå®šæ—¶å‘é€

```python
import schedule
import time

def job():
    send_report(SENDER_EMAIL, SENDER_PASSWORD, RECIPIENTS)

# æ¯å¤©æ—©ä¸Š9ç‚¹å‘é€
schedule.every().day.at("09:00").do(job)

while True:
    schedule.run_pending()
    time.sleep(60)
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€ç¯‡æ˜¯ç¬¬ä¸‰ä¸ªå®æˆ˜é¡¹ç›®ï¼š**å¤©æ°”æŸ¥è¯¢æœºå™¨äºº**ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPythonå®æˆ˜é¡¹ç›®-å¤©æ°”æŸ¥è¯¢æœºå™¨äºº](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228211101-Pythonå®æˆ˜é¡¹ç›®-å¤©æ°”æŸ¥è¯¢æœºå™¨äºº/)**

---

## æ¨èï¼šAI Pythoné›¶åŸºç¡€å®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€ŠPythonç¼–ç¨‹ä»å…¥é—¨åˆ°å®è·µã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pythonå®æˆ˜é¡¹ç›®-è‡ªåŠ¨æ•´ç†ä¸‹è½½æ–‡ä»¶å¤¹](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228210901-Pythonå®æˆ˜é¡¹ç›®-è‡ªåŠ¨æ•´ç†ä¸‹è½½æ–‡ä»¶å¤¹/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pythonå®æˆ˜é¡¹ç›®-å¤©æ°”æŸ¥è¯¢æœºå™¨äºº](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/python/20260228211101-Pythonå®æˆ˜é¡¹ç›®-å¤©æ°”æŸ¥è¯¢æœºå™¨äºº/)

---

*PSï¼šé‚®ä»¶è‡ªåŠ¨åŒ–æ˜¯åŠå…¬ææ•ˆçš„åˆ©å™¨ã€‚æŒæ¡è¿™ä¸ªæŠ€èƒ½ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–å¾ˆå¤šé‡å¤æ€§é€šçŸ¥å·¥ä½œã€‚*
