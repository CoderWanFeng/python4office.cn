---
title: Pandasæ—¶é—´åºåˆ—ï¼šæˆ‘æ€»ç»“äº†8ä¸ªæ—¶é—´å¤„ç†æŠ€å·§ï¼Œè½»æ¾æå®šæ—¥æœŸæ•°æ®åˆ†æ
date: 2026-03-01 00:02:00
tags: [æ•°æ®åˆ†æ, Pandas, æ—¶é—´åºåˆ—, æ—¥æœŸå¤„ç†]
---

<p align="center" id='æ‰«ç æŸ¥çœ‹ AI ç¼–ç¨‹è®­ç»ƒè¥'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/å­¦ä¹ -AI ç¼–ç¨‹-red" alt="AI ç¼–ç¨‹">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/åŠ å…¥-AI äº¤æµç¾¤-brightgreen" alt="AI äº¤æµç¾¤">
</a>

</p>

<!-- more -->

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ­£åœ¨å®æˆ˜å„ç§<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ" target="_blank">AIé¡¹ç›®</a>çš„ç¨‹åºå‘˜æ™šæ«ã€‚

ä»Šå¤©å­¦ä¹ **æ—¶é—´åºåˆ—æ•°æ®å¤„ç†**ï¼Œè¿™æ˜¯é‡‘èã€é”€å”®ã€è¿è¥ç­‰é¢†åŸŸå¿…å¤‡çš„æŠ€èƒ½ã€‚

æ— è®ºæ˜¯åˆ†ææ—¥æ´»è¶‹åŠ¿ã€è®¡ç®—åŒæ¯”ç¯æ¯”ï¼Œè¿˜æ˜¯é¢„æµ‹æœªæ¥é”€é‡ï¼Œéƒ½éœ€è¦æŒæ¡æ—¶é—´åºåˆ—çš„å¤„ç†æ–¹æ³•ã€‚

---

## DatetimeIndexï¼šæ—¶é—´ç´¢å¼•

### åˆ›å»ºæ—¶é—´åºåˆ—
```python
import pandas as pd
import numpy as np

# æ–¹å¼1ï¼šä»å­—ç¬¦ä¸²è½¬æ¢
dates = pd.to_datetime(['2024-01-01', '2024-01-02', '2024-01-03'])

# æ–¹å¼2ï¼šç”Ÿæˆæ—¥æœŸèŒƒå›´
dates = pd.date_range(start='2024-01-01', periods=10, freq='D')  # æ¯æ—¥
dates = pd.date_range(start='2024-01-01', end='2024-12-31', freq='M')  # æ¯æœˆ
dates = pd.date_range(start='2024-01-01', periods=12, freq='MS')  # æ¯æœˆåˆ

# å¸¸è§é¢‘ç‡
# D: æ—¥å†æ—¥, B: å·¥ä½œæ—¥
# W: å‘¨, M: æœˆæœ«, MS: æœˆåˆ
# Q: å­£æœ«, A: å¹´æœ«
# H: å°æ—¶, T/min: åˆ†é’Ÿ, S: ç§’
```

### åˆ›å»ºæ—¶é—´åºåˆ—DataFrame
```python
# æ¨¡æ‹Ÿé”€å”®æ•°æ®
df = pd.DataFrame({
    'æ—¥æœŸ': pd.date_range('2024-01-01', periods=365, freq='D'),
    'é”€å”®é¢': np.random.randint(1000, 5000, 365)
})

# è®¾ç½®ä¸ºç´¢å¼•
df.set_index('æ—¥æœŸ', inplace=True)
print(df.head())
```

---

## æ—¶é—´ç´¢å¼•åˆ‡ç‰‡

```python
# æŒ‰æ—¥æœŸåˆ‡ç‰‡ï¼ˆè¶…çº§æ–¹ä¾¿ï¼ï¼‰
df['2024-01']        # 2024å¹´1æœˆæ‰€æœ‰æ•°æ®
df['2024-01':'2024-03']  # 1æœˆåˆ°3æœˆ
df['2024-01-15':'2024-01-20']  # å…·ä½“æ—¥æœŸèŒƒå›´

# æŒ‰å¹´ä»½
df.loc['2024']       # 2024å¹´å…¨å¹´

# æŒ‰æœˆä»½
df.loc['2024-02']    # 2024å¹´2æœˆ
```

---

## æå–æ—¶é—´ç»„ä»¶

```python
df['å¹´'] = df.index.year
df['æœˆ'] = df.index.month
df['æ—¥'] = df.index.day
df['æ˜ŸæœŸ'] = df.index.dayofweek  # 0=å‘¨ä¸€, 6=å‘¨æ—¥
df['å­£åº¦'] = df.index.quarter
df['æ˜¯å¦å‘¨æœ«'] = df.index.dayofweek >= 5

# è·å–æœˆåˆæœˆæœ«
df['æœˆåˆ'] = df.index.to_period('M').to_timestamp()
df['æœˆæœ«'] = df.index.to_period('M').to_timestamp(how='end')
```

---

## é‡é‡‡æ ·Resample

```python
# æ—¥æ•°æ®è½¬ä¸ºæœˆæ•°æ®
monthly = df.resample('M').sum()      # æ¯æœˆæ€»å’Œ
monthly = df.resample('M').mean()     # æ¯æœˆå¹³å‡

# å‘¨ç»Ÿè®¡
weekly = df.resample('W').sum()       # æ¯å‘¨æ€»å’Œï¼ˆå‘¨æ—¥ç»“æŸï¼‰
weekly = df.resample('W-MON').sum()   # æ¯å‘¨ä¸€ç»“æŸ

# å­£åº¦ç»Ÿè®¡
quarterly = df.resample('Q').sum()

# å¸¸ç”¨èšåˆ
stats = df.resample('M').agg({
    'é”€å”®é¢': ['sum', 'mean', 'max', 'min']
})
```

---

## ç§»åŠ¨çª—å£è®¡ç®—

```python
# 7å¤©ç§»åŠ¨å¹³å‡
df['MA7'] = df['é”€å”®é¢'].rolling(window=7).mean()

# 30å¤©ç§»åŠ¨å¹³å‡
df['MA30'] = df['é”€å”®é¢'].rolling(window=30).mean()

# æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡ï¼ˆæ›´é‡è§†è¿‘æœŸæ•°æ®ï¼‰
df['EMA'] = df['é”€å”®é¢'].ewm(span=7).mean()

# å…¶ä»–çª—å£å‡½æ•°
df['7å¤©æ€»å’Œ'] = df['é”€å”®é¢'].rolling(window=7).sum()
df['7å¤©æ ‡å‡†å·®'] = df['é”€å”®é¢'].rolling(window=7).std()
```

---

## æ»åä¸å·®åˆ†

```python
# æ»å1æœŸï¼ˆå‰ä¸€å¤©çš„æ•°æ®ï¼‰
df['æ˜¨æ—¥é”€å”®'] = df['é”€å”®é¢'].shift(1)

# æ»å7æœŸï¼ˆä¸Šå‘¨åŒä¸€å¤©ï¼‰
df['ä¸Šå‘¨åŒæ—¥'] = df['é”€å”®é¢'].shift(7)

# æ—¥ç¯æ¯”
df['æ—¥ç¯æ¯”'] = (df['é”€å”®é¢'] - df['æ˜¨æ—¥é”€å”®']) / df['æ˜¨æ—¥é”€å”®'] * 100

# å‘¨åŒæ¯”
df['å‘¨åŒæ¯”'] = (df['é”€å”®é¢'] - df['ä¸Šå‘¨åŒæ—¥']) / df['ä¸Šå‘¨åŒæ—¥'] * 100

# å·®åˆ†ï¼ˆç›¸é‚»æ•°æ®çš„å·®ï¼‰
df['æ—¥å¢é‡'] = df['é”€å”®é¢'].diff()
```

---

## å®æˆ˜ï¼šå®Œæ•´çš„é”€å”®æ—¶é—´åˆ†æ

```python
import pandas as pd
import numpy as np

# ç”Ÿæˆä¸€å¹´çš„é”€å”®æ•°æ®
np.random.seed(42)
dates = pd.date_range('2024-01-01', '2024-12-31', freq='D')
base_sales = 3000
trend = np.linspace(0, 1000, len(dates))  # å¢é•¿è¶‹åŠ¿
seasonal = 500 * np.sin(2 * np.pi * np.arange(len(dates)) / 365.25)  # å­£èŠ‚æ€§
noise = np.random.normal(0, 200, len(dates))  # éšæœºæ³¢åŠ¨

sales = base_sales + trend + seasonal + noise
sales = np.maximum(sales, 1000)  # æœ€å°å€¼1000

df = pd.DataFrame({'é”€å”®é¢': sales}, index=dates)

print("=== æ—¶é—´åºåˆ—åˆ†ææŠ¥å‘Š ===\n")

# 1. åŸºç¡€ç»Ÿè®¡
print("ã€å¹´åº¦æ¦‚è§ˆã€‘")
print(f"æ€»é”€å”®é¢: Â¥{df['é”€å”®é¢'].sum():,.0f}")
print(f"æ—¥å‡é”€å”®: Â¥{df['é”€å”®é¢'].mean():,.0f}")
print(f"æœ€é«˜å•æ—¥: Â¥{df['é”€å”®é¢'].max():,.0f} ({df['é”€å”®é¢'].idxmax().date()})")
print(f"æœ€ä½å•æ—¥: Â¥{df['é”€å”®é¢'].min():,.0f} ({df['é”€å”®é¢'].idxmin().date()})")

# 2. æœˆåº¦è¶‹åŠ¿
print("\nã€æœˆåº¦é”€å”®ã€‘")
monthly = df.resample('M')['é”€å”®é¢'].sum()
print(monthly)

# 3. æ˜ŸæœŸæ¨¡å¼
print("\nã€æ˜ŸæœŸé”€å”®æ¨¡å¼ã€‘")
df['æ˜ŸæœŸ'] = df.index.day_name()
weekly_pattern = df.groupby('æ˜ŸæœŸ')['é”€å”®é¢'].mean()
print(weekly_pattern)

# 4. ç§»åŠ¨å¹³å‡è¶‹åŠ¿
print("\nã€7æ—¥ç§»åŠ¨å¹³å‡ï¼ˆæœ€è¿‘10å¤©ï¼‰ã€‘")
df['MA7'] = df['é”€å”®é¢'].rolling(7).mean()
print(df[['é”€å”®é¢', 'MA7']].tail(10))

# 5. åŒæ¯”å¢é•¿ï¼ˆå‡è®¾æœ‰å»å¹´æ•°æ®ï¼‰
# df['å»å¹´ä»Šæ—¥'] = ...
# df['åŒæ¯”å¢é•¿'] = (df['é”€å”®é¢'] - df['å»å¹´ä»Šæ—¥']) / df['å»å¹´ä»Šæ—¥']
```

---

## ä¸‹èŠ‚é¢„å‘Š

ä¸‹ä¸€è¯¾æˆ‘ä»¬å°†å­¦ä¹ **å­—ç¬¦ä¸²å¤„ç†æŠ€å·§**ï¼ŒæŒæ¡æ–‡æœ¬æ•°æ®çš„åˆ†ææ–¹æ³•ã€‚

ğŸ‘‰ **[ç»§ç»­é˜…è¯»ï¼šPandaså­—ç¬¦ä¸²å¤„ç†æŠ€å·§](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000301-Pandaså­—ç¬¦ä¸²å¤„ç†æŠ€å·§/)**

---

## ğŸ’¬ åŠ å…¥å­¦ä¹ äº¤æµç¾¤

æ‰«ç åŠ å…¥**Pythonå­¦ä¹ äº¤æµç¾¤**ï¼Œå’Œæ•°åƒååŒå­¦ä¸€èµ·è¿›æ­¥ï¼š

ğŸ‘‰ **[ç‚¹å‡»åŠ å…¥äº¤æµç¾¤](http://www.python4office.cn/wechat-group/)**

ç¾¤é‡Œä¸å®šæœŸåˆ†äº«ï¼š
- æ•°æ®åˆ†æå®æˆ˜æ¡ˆä¾‹
- Pythonå­¦ä¹ èµ„æ–™
- æ±‚èŒé¢è¯•ç»éªŒ
- è¡Œä¸šæœ€æ–°åŠ¨æ€

---

## æ¨èï¼šAI Pythonæ•°æ®åˆ†æå®æˆ˜è¥

ğŸ **é™æ—¶ç¦åˆ©**ï¼šé€ã€Šåˆ©ç”¨Pythonè¿›è¡Œæ•°æ®åˆ†æã€‹å®ä½“ä¹¦

ğŸ‘‰ **[ç‚¹å‡»äº†è§£è¯¦æƒ…](https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ)**

---

## è¯¾ç¨‹å¯¼èˆª

**ä¸Šä¸€ç¯‡ï¼š** [Pandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000101-Pandasæ•°æ®å˜æ¢-åˆ†ç»„èšåˆgroupby/)

**ä¸‹ä¸€ç¯‡ï¼š** [Pandaså­—ç¬¦ä¸²å¤„ç†æŠ€å·§](/course/AIç›¸å…³/äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾/ads/openclaw/data-analysis/20260301000301-Pandaså­—ç¬¦ä¸²å¤„ç†æŠ€å·§/)

---

*PSï¼šæ—¶é—´åºåˆ—æ˜¯æ•°æ®åˆ†æçš„é‡è¦é¢†åŸŸã€‚æŒæ¡è¿™äº›æŠ€å·§ï¼Œä½ å°±èƒ½åˆ†æä»»ä½•å¸¦æ—¶é—´æˆ³çš„æ•°æ®ã€‚*
