---
title: Python实战项目：我写了50行代码，自动整理乱糟糟的下载文件夹
date: 2026-02-28 21:09:00
tags: [Python实战, 自动化, 文件整理]
---

<p align="center" id='扫码查看 AI 编程训练营'>
    <a target="_blank" href='https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ'>
    <img src="https://raw.atomgit.com/user-images/assets/5027920/9209df5a-99d2-40dc-af34-b10b43be9026/12-ai.jpg" />
    </a>   
</p>

<p align="center" name="atomgit">
    <a target="_blank" href='https://github.com/CoderWanFeng/python-office'>
    <img src="https://img.shields.io/github/stars/CoderWanFeng/python-office.svg?style=social" alt="github star"/>
    </a>
    	<a target="_blank" href='https://gitee.com/CoderWanFeng//python-office/'>
		<img src='https://gitee.com/CoderWanFeng//python-office/badge/star.svg?theme=dark' alt='gitee star'/>
	</a>
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
		<img src='https://atomgit.com/CoderWanFeng1/python-office/star/2025top.svg?theme=dark' alt='atomgit star'/>
	</a>	
	<a target="_blank" href='https://atomgit.com/CoderWanFeng1/python-office'>
<img src="https://static.pepy.tech/badge/python-office" alt="PyPI Downloads">
</a>
<a href="https://mp.weixin.qq.com/s/uxCILtn9cfIsJR8PqOxlGQ">
  <img src="https://img.shields.io/badge/学习-AI 编程-red" alt="AI 编程">
</a>
    	<a href="http://www.python4office.cn/wechat-group/">
  <img src="https://img.shields.io/badge/加入-AI 交流群-brightgreen" alt="AI 交流群">
</a>

</p>

<!-- more -->

大家好，我是正在实战各种AI项目的程序员晚枫。

前面我们学习了Python的基础知识。今天开始**实战项目**，把学到的知识用起来。

第一个项目：**自动整理下载文件夹**。只需要50行代码，就能让你的Downloads文件夹井井有条。

---

## 项目需求分析

### 问题
下载文件夹通常很乱：文档、图片、视频混在一起，找文件很困难。

### 解决方案
按文件类型自动分类：
- 图片 → Images/
- 文档 → Documents/
- 视频 → Videos/
- 压缩包 → Archives/
- 其他 → Others/

---

## 完整代码

```python
import os
import shutil
from pathlib import Path

def organize_downloads(download_path=None):
    """自动整理下载文件夹"""
    
    # 如果没有指定路径，使用默认下载文件夹
    if download_path is None:
        download_path = Path.home() / "Downloads"
    else:
        download_path = Path(download_path)
    
    # 文件类型映射
    file_types = {
        'Images': ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.svg', '.webp'],
        'Documents': ['.pdf', '.doc', '.docx', '.txt', '.xls', '.xlsx', '.ppt', '.pptx'],
        'Videos': ['.mp4', '.avi', '.mkv', '.mov', '.wmv', '.flv'],
        'Audio': ['.mp3', '.wav', '.flac', '.aac', '.ogg'],
        'Archives': ['.zip', '.rar', '.7z', '.tar', '.gz'],
        'Code': ['.py', '.js', '.html', '.css', '.java', '.cpp', '.c']
    }
    
    # 创建分类文件夹
    for folder in file_types.keys():
        folder_path = download_path / folder
        folder_path.mkdir(exist_ok=True)
    
    # 统计信息
    stats = {key: 0 for key in file_types.keys()}
    stats['Others'] = 0
    
    # 遍历文件
    for item in download_path.iterdir():
        # 跳过文件夹和本脚本
        if not item.is_file() or item.name == os.path.basename(__file__):
            continue
        
        # 获取文件扩展名
        ext = item.suffix.lower()
        
        # 确定目标文件夹
        moved = False
        for folder, extensions in file_types.items():
            if ext in extensions:
                target = download_path / folder / item.name
                
                # 如果文件已存在，添加序号
                counter = 1
                original_target = target
                while target.exists():
                    stem = original_target.stem
                    suffix = original_target.suffix
                    target = original_target.with_name(f"{stem}_{counter}{suffix}")
                    counter += 1
                
                shutil.move(str(item), str(target))
                stats[folder] += 1
                moved = True
                print(f"移动: {item.name} -> {folder}/")
                break
        
        if not moved:
            stats['Others'] += 1
    
    # 打印统计
    print("\n整理完成！统计信息：")
    for category, count in stats.items():
        if count > 0:
            print(f"  {category}: {count}个文件")

# 运行
if __name__ == "__main__":
    organize_downloads()
```

---

## 代码解析

### 1. 导入模块
```python
import os          # 操作系统接口
import shutil      # 高级文件操作（移动、复制）
from pathlib import Path  # 面向对象的路径处理
```

### 2. 文件类型映射
用字典定义每种文件类型对应的扩展名，方便扩展和维护。

### 3. 自动创建文件夹
```python
folder_path.mkdir(exist_ok=True)  # exist_ok=True表示如果存在就不报错
```

### 4. 处理重名文件
如果目标位置已有同名文件，自动添加序号：
```python
file.txt → file_1.txt → file_2.txt
```

### 5. 主程序入口
```python
if __name__ == "__main__":
    organize_downloads()
```
这是Python的惯用法，确保直接运行脚本时才执行。

---

## 进阶功能

### 添加更多文件类型
```python
file_types['Ebooks'] = ['.epub', '.mobi', '.azw3']
file_types['Data'] = ['.csv', '.json', '.xml', '.sql']
```

### 按日期分类
```python
from datetime import datetime

# 获取文件修改时间
mtime = datetime.fromtimestamp(item.stat().st_mtime)
date_folder = mtime.strftime('%Y-%m')
target = download_path / date_folder / folder / item.name
```

### 定时自动运行（Windows）
创建一个批处理文件 `organize.bat`：
```batch
@echo off
python C:\path\to\organize_downloads.py
```

然后用任务计划程序设置每天运行。

---

## 运行效果

```