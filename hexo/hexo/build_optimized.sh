#!/bin/bash
# Hexo 优化构建脚本
# 用于生成压缩优化后的静态文件

echo "============================================"
echo "  Hexo 静态文件优化构建脚本"
echo "============================================"

# 进入hexo目录
cd "$(dirname "$0")"

# 1. 清理旧的生成文件
echo ""
echo "[1/4] 清理旧的构建文件..."
hexo clean

# 2. 生成静态文件（插件会自动压缩）
echo ""
echo "[2/4] 生成静态文件..."
hexo generate

# 3. 显示压缩后的文件大小
echo ""
echo "[3/4] 检查生成的文件大小..."
if [ -d "public" ]; then
    echo "public 目录总大小:"
    du -sh public
    echo ""
    echo "各子目录大小 (前10个最大的):"
    du -sh public/*/ 2>/dev/null | sort -hr | head -10
fi

# 4. 可选：进一步使用gzip压缩（如果服务器支持）
echo ""
echo "[4/4] 构建完成!"
echo ""
echo "============================================"
echo "优化建议:"
echo "1. 确保服务器开启 gzip 压缩"
echo "2. 使用 CDN 加速静态资源"
echo "3. 考虑将大图片上传到图床"
echo "============================================"
